# React æŠ€æœ¯å®Œæ•´æŒ‡å—

## ç›®å½•
- [React æŠ€æœ¯å®Œæ•´æŒ‡å—](#react-æŠ€æœ¯å®Œæ•´æŒ‡å—)
  - [ç›®å½•](#ç›®å½•)
  - [1. React æ¦‚è¿°ä¸æ ¸å¿ƒæ¦‚å¿µ](#1-react-æ¦‚è¿°ä¸æ ¸å¿ƒæ¦‚å¿µ)
    - [1.1 React ç®€ä»‹](#11-react-ç®€ä»‹)
      - [1.1.1 React ç‰¹ç‚¹ä¸ä¼˜åŠ¿](#111-react-ç‰¹ç‚¹ä¸ä¼˜åŠ¿)
      - [1.1.2 React ç”Ÿæ€ç³»ç»Ÿ](#112-react-ç”Ÿæ€ç³»ç»Ÿ)
    - [1.2 æ ¸å¿ƒæ¦‚å¿µ](#12-æ ¸å¿ƒæ¦‚å¿µ)
      - [1.2.1 è™šæ‹ŸDOMåŸç†](#121-è™šæ‹ŸdomåŸç†)
      - [1.2.2 ç»„ä»¶åŒ–æ€æƒ³](#122-ç»„ä»¶åŒ–æ€æƒ³)
      - [1.2.3 å•å‘æ•°æ®æµ](#123-å•å‘æ•°æ®æµ)
    - [1.3 React æ¶æ„æ¼”è¿›](#13-react-æ¶æ„æ¼”è¿›)
      - [1.3.1 ä»ç±»ç»„ä»¶åˆ°å‡½æ•°ç»„ä»¶](#131-ä»ç±»ç»„ä»¶åˆ°å‡½æ•°ç»„ä»¶)
      - [1.3.2 Fiber æ¶æ„åŸç†](#132-fiber-æ¶æ„åŸç†)
  - [2. ç»„ä»¶åŸºç¡€ä¸ç”Ÿå‘½å‘¨æœŸ](#2-ç»„ä»¶åŸºç¡€ä¸ç”Ÿå‘½å‘¨æœŸ)
    - [2.1 ç»„ä»¶å®šä¹‰ä¸ä½¿ç”¨](#21-ç»„ä»¶å®šä¹‰ä¸ä½¿ç”¨)
      - [2.1.1 å‡½æ•°ç»„ä»¶](#211-å‡½æ•°ç»„ä»¶)
      - [2.1.2 ç±»ç»„ä»¶](#212-ç±»ç»„ä»¶)
      - [2.1.3 ç»„ä»¶é€šä¿¡](#213-ç»„ä»¶é€šä¿¡)
    - [2.2 ç”Ÿå‘½å‘¨æœŸè¯¦è§£](#22-ç”Ÿå‘½å‘¨æœŸè¯¦è§£)
      - [2.2.1 æŒ‚è½½é˜¶æ®µ](#221-æŒ‚è½½é˜¶æ®µ)
      - [2.2.2 æ›´æ–°é˜¶æ®µ](#222-æ›´æ–°é˜¶æ®µ)
      - [2.2.3 å¸è½½é˜¶æ®µ](#223-å¸è½½é˜¶æ®µ)
    - [2.3 äº‹ä»¶å¤„ç†æœºåˆ¶](#23-äº‹ä»¶å¤„ç†æœºåˆ¶)
      - [2.3.1 åˆæˆäº‹ä»¶ç³»ç»Ÿ](#231-åˆæˆäº‹ä»¶ç³»ç»Ÿ)
      - [2.3.2 äº‹ä»¶å§”æ‰˜æœºåˆ¶](#232-äº‹ä»¶å§”æ‰˜æœºåˆ¶)
  - [3. React Hooks æ·±åº¦è§£æ](#3-react-hooks-æ·±åº¦è§£æ)
    - [3.1 åŸºç¡€Hooks](#31-åŸºç¡€hooks)
      - [3.1.1 useState](#311-usestate)
      - [3.1.2 useEffect](#312-useeffect)
      - [3.1.3 useContext](#313-usecontext)
    - [3.2 é«˜çº§Hooks](#32-é«˜çº§hooks)
      - [3.2.1 useReducer](#321-usereducer)
      - [3.2.2 useMemo å’Œ useCallback](#322-usememo-å’Œ-usecallback)
      - [3.2.3 useRef å’Œ useImperativeHandle](#323-useref-å’Œ-useimperativehandle)
    - [3.3 è‡ªå®šä¹‰Hooks](#33-è‡ªå®šä¹‰hooks)
      - [3.3.1 è®¾è®¡åŸåˆ™](#331-è®¾è®¡åŸåˆ™)
      - [3.3.2 å¸¸ç”¨è‡ªå®šä¹‰Hooks](#332-å¸¸ç”¨è‡ªå®šä¹‰hooks)
  - [10. React é¢è¯•é¢˜è¯¦è§£](#10-react-é¢è¯•é¢˜è¯¦è§£)
    - [10.1 åŸºç¡€æ¦‚å¿µç±»](#101-åŸºç¡€æ¦‚å¿µç±»)
      - [Q1: ä»€ä¹ˆæ˜¯Reactï¼ŸReactæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ](#q1-ä»€ä¹ˆæ˜¯reactreactæœ‰å“ªäº›ç‰¹ç‚¹)
      - [Q2: ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Ÿè™šæ‹ŸDOMçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ](#q2-ä»€ä¹ˆæ˜¯è™šæ‹Ÿdomè™šæ‹Ÿdomçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ)
      - [Q3: è§£é‡ŠReactçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•](#q3-è§£é‡Šreactçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•)
      - [Q4: ä»€ä¹ˆæ˜¯JSXï¼ŸJSXçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ](#q4-ä»€ä¹ˆæ˜¯jsxjsxçš„åŸç†æ˜¯ä»€ä¹ˆ)
      - [Q5: Reactä¸­çš„keyå±æ€§æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ](#q5-reactä¸­çš„keyå±æ€§æœ‰ä»€ä¹ˆä½œç”¨)
    - [10.2 ç»„ä»¶ä¸ç”Ÿå‘½å‘¨æœŸç±»](#102-ç»„ä»¶ä¸ç”Ÿå‘½å‘¨æœŸç±»)
      - [Q6: ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ](#q6-ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«)
      - [Q7: ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶(HOC)ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ](#q7-ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶hocå¦‚ä½•å®ç°)
      - [Q8: ä»€ä¹ˆæ˜¯Render Propsæ¨¡å¼ï¼Ÿ](#q8-ä»€ä¹ˆæ˜¯render-propsæ¨¡å¼)
    - [10.3 Hooks æ·±åº¦ç†è§£ç±»](#103-hooks-æ·±åº¦ç†è§£ç±»)
      - [Q9: useEffectçš„ä¾èµ–æ•°ç»„æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ](#q9-useeffectçš„ä¾èµ–æ•°ç»„æ˜¯å¦‚ä½•å·¥ä½œçš„)
      - [Q10: ä¸ºä»€ä¹ˆuseStateçš„æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Ÿ](#q10-ä¸ºä»€ä¹ˆusestateçš„æ›´æ–°æ˜¯å¼‚æ­¥çš„)
    - [10.4 æ€§èƒ½ä¼˜åŒ–ç±»](#104-æ€§èƒ½ä¼˜åŒ–ç±»)
      - [Q11: Reactä¸­æœ‰å“ªäº›æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ï¼Ÿ](#q11-reactä¸­æœ‰å“ªäº›æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯)
      - [Q12: ä»€ä¹ˆæ˜¯React Fiberï¼Ÿå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ](#q12-ä»€ä¹ˆæ˜¯react-fiberå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜)
    - [10.5 å®æˆ˜åº”ç”¨ç±»](#105-å®æˆ˜åº”ç”¨ç±»)
      - [Q13: å¦‚ä½•åœ¨Reactä¸­å®ç°çŠ¶æ€ç®¡ç†ï¼Ÿ](#q13-å¦‚ä½•åœ¨reactä¸­å®ç°çŠ¶æ€ç®¡ç†)
      - [Q14: å¦‚ä½•å¤„ç†Reactä¸­çš„é”™è¯¯è¾¹ç•Œï¼Ÿ](#q14-å¦‚ä½•å¤„ç†reactä¸­çš„é”™è¯¯è¾¹ç•Œ)
      - [Q15: Reactä¸­å¦‚ä½•å®ç°æ¡ä»¶æ¸²æŸ“ï¼Ÿ](#q15-reactä¸­å¦‚ä½•å®ç°æ¡ä»¶æ¸²æŸ“)
  - [ğŸ“š æ€»ç»“](#-æ€»ç»“)
    - [ğŸ¯ æ ¸å¿ƒå†…å®¹](#-æ ¸å¿ƒå†…å®¹)
    - [âœ… æŠ€æœ¯ç‰¹è‰²](#-æŠ€æœ¯ç‰¹è‰²)

## 1. React æ¦‚è¿°ä¸æ ¸å¿ƒæ¦‚å¿µ

### 1.1 React ç®€ä»‹

#### 1.1.1 React ç‰¹ç‚¹ä¸ä¼˜åŠ¿

**React**æ˜¯ç”±Facebookå¼€å‘çš„ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„JavaScriptåº“ï¼Œäº2013å¹´å¼€æºã€‚å®ƒé‡‡ç”¨ç»„ä»¶åŒ–å¼€å‘æ¨¡å¼ï¼Œé€šè¿‡è™šæ‹ŸDOMæå‡æ€§èƒ½ï¼Œæ˜¯ç°ä»£å‰ç«¯å¼€å‘çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ã€‚

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š

| ç‰¹ç‚¹ | æè¿° | ä¼˜åŠ¿ |
|------|------|------|
| **å£°æ˜å¼ç¼–ç¨‹** | æè¿°UIåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ | ä»£ç å¯è¯»æ€§å¼ºï¼Œæ˜“äºç†è§£ |
| **ç»„ä»¶åŒ–** | å°†UIåˆ†è§£ä¸ºç‹¬ç«‹çš„ç»„ä»¶ | ä»£ç å¤ç”¨æ€§é«˜ï¼Œç»´æŠ¤æ€§å¥½ |
| **è™šæ‹ŸDOM** | åœ¨å†…å­˜ä¸­æ“ä½œDOMå‰¯æœ¬ | æ€§èƒ½ä¼˜åŒ–ï¼Œå‡å°‘çœŸå®DOMæ“ä½œ |
| **å•å‘æ•°æ®æµ** | æ•°æ®ä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ | æ•°æ®æµå‘æ¸…æ™°ï¼Œä¾¿äºè°ƒè¯• |
| **Learn Once, Write Anywhere** | ä¸€æ¬¡å­¦ä¹ ï¼Œéšå¤„ç¼–å†™ | æ”¯æŒWebã€ç§»åŠ¨ç«¯ã€æœåŠ¡ç«¯ |

**React æŠ€æœ¯æ ˆç”Ÿæ€**ï¼š

```mermaid
graph TB
    subgraph "React ç”Ÿæ€ç³»ç»Ÿ"
        subgraph "æ ¸å¿ƒåº“"
            REACT["React<br/>ç»„ä»¶åŒ–UIåº“"]
            REACTDOM["ReactDOM<br/>DOMæ¸²æŸ“å™¨"]
            JSX["JSX<br/>è¯­æ³•æ‰©å±•"]
        end
        
        subgraph "çŠ¶æ€ç®¡ç†"
            REDUX["Redux<br/>å¯é¢„æµ‹çŠ¶æ€å®¹å™¨"]
            MOBX["MobX<br/>å“åº”å¼çŠ¶æ€ç®¡ç†"]
            ZUSTAND["Zustand<br/>è½»é‡çŠ¶æ€ç®¡ç†"]
            CONTEXT["Context API<br/>å†…ç½®çŠ¶æ€å…±äº«"]
        end
        
        subgraph "è·¯ç”±å¯¼èˆª"
            ROUTER["React Router<br/>å®¢æˆ·ç«¯è·¯ç”±"]
            REACH["Reach Router<br/>å·²åˆå¹¶åˆ°React Router"]
        end
        
        subgraph "å¼€å‘å·¥å…·"
            CRA["Create React App<br/>é›¶é…ç½®è„šæ‰‹æ¶"]
            NEXT["Next.js<br/>å…¨æ ˆæ¡†æ¶"]
            VITE["Vite<br/>å¿«é€Ÿæ„å»ºå·¥å…·"]
        end
        
        subgraph "UIç»„ä»¶åº“"
            ANTD["Ant Design<br/>ä¼ä¸šçº§UI"]
            MUI["Material-UI<br/>Material Design"]
            CHAKRA["Chakra UI<br/>ç®€å•æ¨¡å—åŒ–"]
        end
    end
    
    REACT --> REACTDOM
    REACT --> JSX
    REACT --> REDUX
    REACT --> ROUTER
    CRA --> REACT
    NEXT --> REACT
```

#### 1.1.2 React ç”Ÿæ€ç³»ç»Ÿ

**æŠ€æœ¯æ ˆå¯¹æ¯”**ï¼š

| æŠ€æœ¯åˆ†ç±» | ä¸»æµé€‰æ‹© | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|----------|----------|------|----------|
| **çŠ¶æ€ç®¡ç†** | Redux, Zustand, Jotai | å„æœ‰ä¼˜åŠ¿ | å¤æ‚åº”ç”¨vsç®€å•çŠ¶æ€ |
| **è·¯ç”±ç®¡ç†** | React Router v6 | å£°æ˜å¼è·¯ç”± | SPAåº”ç”¨å¯¼èˆª |
| **æ ·å¼æ–¹æ¡ˆ** | CSS Modules, Styled-components, Tailwind | ç»„ä»¶åŒ–æ ·å¼ | æ ·å¼éš”ç¦»ä¸å¤ç”¨ |
| **æ„å»ºå·¥å…·** | Vite, Webpack, Parcel | å¿«é€Ÿå¼€å‘ | å¼€å‘ä½“éªŒä¼˜åŒ– |
| **æµ‹è¯•æ¡†æ¶** | Jest, React Testing Library | æµ‹è¯•å‹å¥½ | ä¿è¯ä»£ç è´¨é‡ |

### 1.2 æ ¸å¿ƒæ¦‚å¿µ

#### 1.2.1 è™šæ‹ŸDOMåŸç†

**è™šæ‹ŸDOM**æ˜¯Reactçš„æ ¸å¿ƒåˆ›æ–°ä¹‹ä¸€ï¼Œå®ƒæ˜¯çœŸå®DOMçš„JavaScriptè¡¨ç¤ºã€‚

**è™šæ‹ŸDOMå·¥ä½œæµç¨‹**ï¼š

```mermaid
graph TB
    subgraph "è™šæ‹ŸDOMå·¥ä½œåŸç†"
        STATE["çŠ¶æ€å˜åŒ–<br/>State Change"]
        
        subgraph "è™šæ‹ŸDOMå¤„ç†"
            VDOM_NEW["åˆ›å»ºæ–°è™šæ‹ŸDOM<br/>New Virtual DOM Tree"]
            VDOM_OLD["æ—§è™šæ‹ŸDOM<br/>Previous Virtual DOM Tree"]
            DIFF["Diffç®—æ³•<br/>æ‰¾å‡ºå·®å¼‚"]
        end
        
        subgraph "DOMæ›´æ–°"
            PATCH["Patchè¿‡ç¨‹<br/>åº”ç”¨å˜æ›´"]
            REAL_DOM["çœŸå®DOM<br/>Real DOM"]
        end
        
        RENDER["é‡æ–°æ¸²æŸ“<br/>Re-render"]
    end
    
    STATE --> VDOM_NEW
    VDOM_NEW --> DIFF
    VDOM_OLD --> DIFF
    DIFF --> PATCH
    PATCH --> REAL_DOM
    REAL_DOM --> RENDER
```

**è™šæ‹ŸDOMä¼˜åŠ¿**ï¼š

1. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - æ‰¹é‡æ›´æ–°ï¼Œå‡å°‘DOMæ“ä½œ
   - Diffç®—æ³•ä¼˜åŒ–æ›´æ–°èŒƒå›´
   - å¼‚æ­¥æ›´æ–°ï¼Œä¸é˜»å¡ç”¨æˆ·äº¤äº’

2. **å¼€å‘ä½“éªŒ**ï¼š
   - å£°æ˜å¼ç¼–ç¨‹æ¨¡å¼
   - è·¨å¹³å°æŠ½è±¡å±‚
   - æ›´å¥½çš„é”™è¯¯è¾¹ç•Œå¤„ç†

**ç®€åŒ–çš„è™šæ‹ŸDOMå®ç°**ï¼š

```javascript
// è™šæ‹ŸDOMèŠ‚ç‚¹ç»“æ„
const VNode = {
  type: 'div',           // å…ƒç´ ç±»å‹
  props: {               // å±æ€§
    className: 'container',
    children: [
      {
        type: 'span',
        props: {
          children: 'Hello World'
        }
      }
    ]
  }
};

// ç®€åŒ–çš„Diffç®—æ³•
function diff(oldVNode, newVNode) {
  // èŠ‚ç‚¹ç±»å‹ä¸åŒï¼Œç›´æ¥æ›¿æ¢
  if (oldVNode.type !== newVNode.type) {
    return { type: 'REPLACE', newVNode };
  }
  
  // æ¯”è¾ƒå±æ€§
  const propsPatches = diffProps(oldVNode.props, newVNode.props);
  
  // æ¯”è¾ƒå­èŠ‚ç‚¹
  const childrenPatches = diffChildren(
    oldVNode.props.children, 
    newVNode.props.children
  );
  
  return {
    type: 'UPDATE',
    propsPatches,
    childrenPatches
  };
}

// åº”ç”¨è¡¥ä¸åˆ°çœŸå®DOM
function patch(domNode, patches) {
  switch (patches.type) {
    case 'REPLACE':
      domNode.parentNode.replaceChild(
        createElement(patches.newVNode), 
        domNode
      );
      break;
    case 'UPDATE':
      updateProps(domNode, patches.propsPatches);
      patches.childrenPatches.forEach((patch, index) => {
        patch(domNode.childNodes[index], patch);
      });
      break;
  }
}
```

#### 1.2.2 ç»„ä»¶åŒ–æ€æƒ³

**ç»„ä»¶åŒ–**æ˜¯Reactçš„æ ¸å¿ƒè®¾è®¡ç†å¿µï¼Œå°†UIæ‹†åˆ†ä¸ºç‹¬ç«‹ã€å¯å¤ç”¨çš„ç»„ä»¶ã€‚

**ç»„ä»¶åŒ–æ¶æ„ä¼˜åŠ¿**ï¼š

```mermaid
graph TB
    subgraph "ç»„ä»¶åŒ–å¼€å‘æ¨¡å¼"
        subgraph "ä¼ ç»Ÿå¼€å‘"
            HTML["HTMLç»“æ„"]
            CSS["CSSæ ·å¼"]
            JS["JavaScripté€»è¾‘"]
        end
        
        subgraph "ç»„ä»¶åŒ–å¼€å‘"
            COMPONENT["ç»„ä»¶<br/>Component"]
            subgraph "ç»„ä»¶å†…éƒ¨"
                TEMPLATE["æ¨¡æ¿<br/>JSX"]
                STYLE["æ ·å¼<br/>CSS-in-JS"]
                LOGIC["é€»è¾‘<br/>Hooks/Methods"]
                STATE["çŠ¶æ€<br/>State"]
            end
        end
        
        subgraph "ç»„ä»¶ç‰¹æ€§"
            REUSE["å¯å¤ç”¨<br/>Reusable"]
            MAINTAIN["æ˜“ç»´æŠ¤<br/>Maintainable"]
            TEST["å¯æµ‹è¯•<br/>Testable"]
            COMPOSE["å¯ç»„åˆ<br/>Composable"]
        end
    end
    
    HTML --> COMPONENT
    CSS --> COMPONENT
    JS --> COMPONENT
    
    COMPONENT --> TEMPLATE
    COMPONENT --> STYLE
    COMPONENT --> LOGIC
    COMPONENT --> STATE
    
    COMPONENT --> REUSE
    COMPONENT --> MAINTAIN
    COMPONENT --> TEST
    COMPONENT --> COMPOSE
```

**ç»„ä»¶è®¾è®¡åŸåˆ™**ï¼š

1. **å•ä¸€èŒè´£åŸåˆ™**ï¼š
   ```javascript
   // âœ… å¥½çš„è®¾è®¡ï¼šèŒè´£å•ä¸€
   const UserAvatar = ({ user }) => (
     <img src={user.avatar} alt={user.name} className="avatar" />
   );
   
   const UserInfo = ({ user }) => (
     <div className="user-info">
       <UserAvatar user={user} />
       <span>{user.name}</span>
     </div>
   );
   
   // âŒ ä¸å¥½çš„è®¾è®¡ï¼šèŒè´£æ··æ‚
   const UserComponent = ({ user, posts, comments }) => (
     <div>
       <img src={user.avatar} alt={user.name} />
       <span>{user.name}</span>
       <div>{posts.map(post => <PostItem post={post} />)}</div>
       <div>{comments.map(comment => <Comment comment={comment} />)}</div>
     </div>
   );
   ```

2. **ç»„ä»¶ç»„åˆ**ï¼š
   ```javascript
   // é«˜é˜¶ç»„ä»¶æ¨¡å¼
   const withLoading = (WrappedComponent) => {
     return ({ isLoading, ...props }) => {
       if (isLoading) {
         return <div>Loading...</div>;
       }
       return <WrappedComponent {...props} />;
     };
   };
   
   // ç»„åˆä½¿ç”¨
   const UserList = withLoading(({ users }) => (
     <div>
       {users.map(user => <UserInfo key={user.id} user={user} />)}
     </div>
   ));
   ```

#### 1.2.3 å•å‘æ•°æ®æµ

**å•å‘æ•°æ®æµ**ç¡®ä¿æ•°æ®æµå‘çš„å¯é¢„æµ‹æ€§ï¼Œæ˜¯Reactæ¶æ„çš„é‡è¦ç‰¹å¾ã€‚

**æ•°æ®æµå‘ç¤ºæ„**ï¼š

```mermaid
graph TB
    subgraph "Reactå•å‘æ•°æ®æµ"
        subgraph "çˆ¶ç»„ä»¶"
            PARENT_STATE["çˆ¶ç»„ä»¶çŠ¶æ€<br/>Parent State"]
            PARENT_PROPS["å‘ä¸‹ä¼ é€’Props<br/>Pass Props Down"]
        end
        
        subgraph "å­ç»„ä»¶"
            CHILD_PROPS["æ¥æ”¶Props<br/>Receive Props"]
            CHILD_EVENT["è§¦å‘äº‹ä»¶<br/>Trigger Events"]
        end
        
        subgraph "æ•°æ®æ›´æ–°"
            CALLBACK["å›è°ƒå‡½æ•°<br/>Callback Functions"]
            STATE_UPDATE["çŠ¶æ€æ›´æ–°<br/>State Update"]
        end
    end
    
    PARENT_STATE --> PARENT_PROPS
    PARENT_PROPS --> CHILD_PROPS
    CHILD_PROPS --> CHILD_EVENT
    CHILD_EVENT --> CALLBACK
    CALLBACK --> STATE_UPDATE
    STATE_UPDATE --> PARENT_STATE
```

**å•å‘æ•°æ®æµç¤ºä¾‹**ï¼š

```javascript
// çˆ¶ç»„ä»¶ï¼šç®¡ç†çŠ¶æ€
const TodoApp = () => {
  const [todos, setTodos] = useState([]);
  const [filter, setFilter] = useState('all');
  
  const addTodo = (text) => {
    setTodos([...todos, { id: Date.now(), text, completed: false }]);
  };
  
  const toggleTodo = (id) => {
    setTodos(todos.map(todo => 
      todo.id === id ? { ...todo, completed: !todo.completed } : todo
    ));
  };
  
  const filteredTodos = todos.filter(todo => {
    if (filter === 'active') return !todo.completed;
    if (filter === 'completed') return todo.completed;
    return true;
  });
  
  return (
    <div>
      <TodoInput onAddTodo={addTodo} />
      <TodoList todos={filteredTodos} onToggleTodo={toggleTodo} />
      <TodoFilter filter={filter} onFilterChange={setFilter} />
    </div>
  );
};

// å­ç»„ä»¶ï¼šæ¥æ”¶propsï¼Œè§¦å‘å›è°ƒ
const TodoInput = ({ onAddTodo }) => {
  const [text, setText] = useState('');
  
  const handleSubmit = (e) => {
    e.preventDefault();
    if (text.trim()) {
      onAddTodo(text.trim());  // å‘ä¸Šé€šä¿¡
      setText('');
    }
  };
  
  return (
    <form onSubmit={handleSubmit}>
      <input 
        value={text}
        onChange={(e) => setText(e.target.value)}
        placeholder="What needs to be done?"
      />
      <button type="submit">Add</button>
    </form>
  );
};

const TodoList = ({ todos, onToggleTodo }) => (
  <ul>
    {todos.map(todo => (
      <TodoItem 
        key={todo.id} 
        todo={todo} 
        onToggle={() => onToggleTodo(todo.id)}
      />
    ))}
  </ul>
);

const TodoItem = ({ todo, onToggle }) => (
  <li 
    onClick={onToggle}
    style={{ 
      textDecoration: todo.completed ? 'line-through' : 'none' 
    }}
  >
    {todo.text}
  </li>
);
```

### 1.3 React æ¶æ„æ¼”è¿›

#### 1.3.1 ä»ç±»ç»„ä»¶åˆ°å‡½æ•°ç»„ä»¶

**ç»„ä»¶å‘å±•å†ç¨‹**ï¼š

```mermaid
graph LR
    subgraph "Reactç»„ä»¶æ¼”è¿›"
        subgraph "React 15.x"
            CLASS_OLD["ç±»ç»„ä»¶<br/>Class Components"]
            MIXIN["Mixins<br/>å·²åºŸå¼ƒ"]
        end
        
        subgraph "React 16.x"
            CLASS_NEW["ç±»ç»„ä»¶<br/>ç”Ÿå‘½å‘¨æœŸä¼˜åŒ–"]
            FUNCTION_BASIC["å‡½æ•°ç»„ä»¶<br/>æ— çŠ¶æ€ç»„ä»¶"]
            HOC["é«˜é˜¶ç»„ä»¶<br/>HOC"]
            RENDER_PROPS["Render Props<br/>æ¸²æŸ“å±æ€§"]
        end
        
        subgraph "React 16.8+"
            HOOKS["Hooks<br/>çŠ¶æ€é€»è¾‘å¤ç”¨"]
            FUNCTION_FULL["å‡½æ•°ç»„ä»¶<br/>å®Œæ•´åŠŸèƒ½"]
            CUSTOM_HOOKS["è‡ªå®šä¹‰Hooks<br/>é€»è¾‘æŠ½è±¡"]
        end
    end
    
    CLASS_OLD --> CLASS_NEW
    MIXIN --> HOC
    CLASS_NEW --> HOOKS
    FUNCTION_BASIC --> FUNCTION_FULL
    HOC --> CUSTOM_HOOKS
    RENDER_PROPS --> CUSTOM_HOOKS
```

**ç±»ç»„ä»¶ vs å‡½æ•°ç»„ä»¶å¯¹æ¯”**ï¼š

| æ–¹é¢ | ç±»ç»„ä»¶ | å‡½æ•°ç»„ä»¶ + Hooks |
|------|--------|------------------|
| **è¯­æ³•** | classè¯­æ³•ï¼Œthisç»‘å®š | å‡½æ•°è¯­æ³•ï¼Œæ›´ç®€æ´ |
| **çŠ¶æ€ç®¡ç†** | this.state | useState Hook |
| **ç”Ÿå‘½å‘¨æœŸ** | ç”Ÿå‘½å‘¨æœŸæ–¹æ³• | useEffect Hook |
| **æ€§èƒ½** | shouldComponentUpdate | React.memo |
| **é€»è¾‘å¤ç”¨** | HOC, Render Props | è‡ªå®šä¹‰Hooks |
| **ä»£ç é‡** | ç›¸å¯¹è¾ƒå¤š | æ›´ç®€æ´ |
| **å­¦ä¹ æˆæœ¬** | thisç»‘å®šå¤æ‚ | æ›´ç›´è§‚ |

**è¿ç§»ç¤ºä¾‹**ï¼š

```javascript
// ç±»ç»„ä»¶å†™æ³•
class UserProfile extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      user: null,
      loading: true,
      error: null
    };
  }
  
  async componentDidMount() {
    try {
      const user = await fetchUser(this.props.userId);
      this.setState({ user, loading: false });
    } catch (error) {
      this.setState({ error, loading: false });
    }
  }
  
  async componentDidUpdate(prevProps) {
    if (prevProps.userId !== this.props.userId) {
      this.setState({ loading: true });
      try {
        const user = await fetchUser(this.props.userId);
        this.setState({ user, loading: false });
      } catch (error) {
        this.setState({ error, loading: false });
      }
    }
  }
  
  render() {
    const { user, loading, error } = this.state;
    
    if (loading) return <div>Loading...</div>;
    if (error) return <div>Error: {error.message}</div>;
    if (!user) return <div>No user found</div>;
    
    return (
      <div>
        <h1>{user.name}</h1>
        <p>{user.email}</p>
      </div>
    );
  }
}

// å‡½æ•°ç»„ä»¶ + Hookså†™æ³•
const UserProfile = ({ userId }) => {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    const loadUser = async () => {
      setLoading(true);
      setError(null);
      
      try {
        const userData = await fetchUser(userId);
        setUser(userData);
      } catch (err) {
        setError(err);
      } finally {
        setLoading(false);
      }
    };
    
    loadUser();
  }, [userId]);
  
  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error.message}</div>;
  if (!user) return <div>No user found</div>;
  
  return (
    <div>
      <h1>{user.name}</h1>
      <p>{user.email}</p>
    </div>
  );
};

// è¿›ä¸€æ­¥ä¼˜åŒ–ï¼šè‡ªå®šä¹‰Hook
const useUser = (userId) => {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    const loadUser = async () => {
      setLoading(true);
      setError(null);
      
      try {
        const userData = await fetchUser(userId);
        setUser(userData);
      } catch (err) {
        setError(err);
      } finally {
        setLoading(false);
      }
    };
    
    loadUser();
  }, [userId]);
  
  return { user, loading, error };
};

// ä½¿ç”¨è‡ªå®šä¹‰Hook
const UserProfile = ({ userId }) => {
  const { user, loading, error } = useUser(userId);
  
  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error.message}</div>;
  if (!user) return <div>No user found</div>;
  
  return (
    <div>
      <h1>{user.name}</h1>
      <p>{user.email}</p>
    </div>
  );
};
```

#### 1.3.2 Fiber æ¶æ„åŸç†

**Fiberæ¶æ„**æ˜¯React 16å¼•å…¥çš„æ–°è°ƒå’Œå¼•æ“ï¼Œè§£å†³äº†åŸæœ‰æ¶æ„çš„æ€§èƒ½é—®é¢˜ã€‚

**Fiberæ¶æ„ä¼˜åŠ¿**ï¼š

```mermaid
graph TB
    subgraph "Fiberæ¶æ„æ ¸å¿ƒç‰¹æ€§"
        subgraph "æ—¶é—´åˆ‡ç‰‡"
            TIME_SLICE["æ—¶é—´åˆ‡ç‰‡<br/>Time Slicing"]
            INTERRUPT["å¯ä¸­æ–­æ¸²æŸ“<br/>Interruptible Rendering"]
            PRIORITY["ä¼˜å…ˆçº§è°ƒåº¦<br/>Priority Scheduling"]
        end
        
        subgraph "å¹¶å‘ç‰¹æ€§"
            CONCURRENT["å¹¶å‘æ¨¡å¼<br/>Concurrent Mode"]
            SUSPENSE["Suspense<br/>å¼‚æ­¥æ¸²æŸ“"]
            BATCH["æ‰¹é‡æ›´æ–°<br/>Batched Updates"]
        end
        
        subgraph "æ€§èƒ½ä¼˜åŒ–"
            INCREMENTAL["å¢é‡æ¸²æŸ“<br/>Incremental Rendering"]
            YIELDING["ä¸»åŠ¨è®©æ­¥<br/>Cooperative Yielding"]
            SMOOTH["æµç•…ä½“éªŒ<br/>Smooth UX"]
        end
    end
    
    TIME_SLICE --> CONCURRENT
    INTERRUPT --> SUSPENSE
    PRIORITY --> BATCH
    
    CONCURRENT --> INCREMENTAL
    SUSPENSE --> YIELDING
    BATCH --> SMOOTH
```

**FiberèŠ‚ç‚¹ç»“æ„**ï¼š

```javascript
// FiberèŠ‚ç‚¹çš„ç®€åŒ–ç»“æ„
const FiberNode = {
  // èŠ‚ç‚¹ä¿¡æ¯
  type: 'div',                    // ç»„ä»¶ç±»å‹
  key: 'unique-key',              // React key
  elementType: 'div',             // å…ƒç´ ç±»å‹
  
  // çŠ¶æ€ä¿¡æ¯
  pendingProps: {},               // æ–°çš„props
  memoizedProps: {},              // ä¸Šæ¬¡æ¸²æŸ“çš„props
  memoizedState: null,            // ä¸Šæ¬¡æ¸²æŸ“çš„state
  updateQueue: null,              // æ›´æ–°é˜Ÿåˆ—
  
  // å‰¯ä½œç”¨
  effectTag: 0,                   // å‰¯ä½œç”¨æ ‡è®°
  nextEffect: null,               // ä¸‹ä¸€ä¸ªæœ‰å‰¯ä½œç”¨çš„èŠ‚ç‚¹
  firstEffect: null,              // ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹å‰¯ä½œç”¨
  lastEffect: null,               // æœ€åä¸€ä¸ªå­èŠ‚ç‚¹å‰¯ä½œç”¨
  
  // ä¼˜å…ˆçº§
  lanes: 0,                       // ä¼˜å…ˆçº§è½¦é“
  childLanes: 0,                  // å­èŠ‚ç‚¹ä¼˜å…ˆçº§
  
  // èŠ‚ç‚¹å…³ç³»
  return: null,                   // çˆ¶èŠ‚ç‚¹
  child: null,                    // ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹
  sibling: null,                  // å…„å¼ŸèŠ‚ç‚¹
  index: 0,                       // ç´¢å¼•
  
  // å…¶ä»–
  ref: null,                      // refå¼•ç”¨
  alternate: null,                // åŒç¼“å­˜æœºåˆ¶çš„å¦ä¸€ä¸ªfiber
};

// Fiberå·¥ä½œå¾ªç¯
function workLoopConcurrent() {
  // å¦‚æœè¿˜æœ‰å·¥ä½œè¦åšä¸”æ²¡æœ‰è¢«ä¸­æ–­
  while (workInProgress !== null && !shouldYield()) {
    workInProgress = performUnitOfWork(workInProgress);
  }
}

function performUnitOfWork(unitOfWork) {
  const current = unitOfWork.alternate;
  
  // å¼€å§‹å·¥ä½œ
  let next = beginWork(current, unitOfWork, renderLanes);
  
  unitOfWork.memoizedProps = unitOfWork.pendingProps;
  
  if (next === null) {
    // å¦‚æœæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œå®Œæˆå·¥ä½œ
    completeUnitOfWork(unitOfWork);
  } else {
    workInProgress = next;
  }
  
  return next;
}
```

**ä¼˜å…ˆçº§è°ƒåº¦ç³»ç»Ÿ**ï¼š

```javascript
// Reactä¼˜å…ˆçº§ç­‰çº§
const ImmediatePriority = 1;      // ç«‹å³æ‰§è¡Œï¼ˆç”¨æˆ·è¾“å…¥ï¼‰
const UserBlockingPriority = 2;   // ç”¨æˆ·é˜»å¡ï¼ˆhoverã€æ»šåŠ¨ï¼‰
const NormalPriority = 3;         // æ­£å¸¸ä¼˜å…ˆçº§ï¼ˆæ•°æ®è·å–ï¼‰
const LowPriority = 4;            // ä½ä¼˜å…ˆçº§ï¼ˆåˆ†æï¼‰
const IdlePriority = 5;           // ç©ºé—²ä¼˜å…ˆçº§ï¼ˆç¦»å±å†…å®¹ï¼‰

// è°ƒåº¦å™¨å¦‚ä½•å·¥ä½œ
function scheduleWork(fiber, expirationTime) {
  const root = markUpdateTimeFromFiberToRoot(fiber, expirationTime);
  
  if (root === null) return;
  
  // æ£€æŸ¥æ˜¯å¦æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„å·¥ä½œ
  if (expirationTime === Sync) {
    // åŒæ­¥æ›´æ–°
    performSyncWorkOnRoot(root);
  } else {
    // å¼‚æ­¥æ›´æ–°
    ensureRootIsScheduled(root, getCurrentTime());
  }
}

// æ—¶é—´åˆ‡ç‰‡æœºåˆ¶
function shouldYield() {
  const currentTime = getCurrentTime();
  return currentTime >= deadline;
}
```

## 2. ç»„ä»¶åŸºç¡€ä¸ç”Ÿå‘½å‘¨æœŸ

### 2.1 ç»„ä»¶å®šä¹‰ä¸ä½¿ç”¨

#### 2.1.1 å‡½æ•°ç»„ä»¶

**å‡½æ•°ç»„ä»¶**æ˜¯Reactçš„æ¨èç»„ä»¶å†™æ³•ï¼Œè¯­æ³•ç®€æ´ï¼Œé…åˆHooksä½¿ç”¨åŠŸèƒ½å¼ºå¤§ã€‚

**åŸºç¡€å‡½æ•°ç»„ä»¶**ï¼š

```javascript
// åŸºç¡€å‡½æ•°ç»„ä»¶
const Welcome = (props) => {
  return <h1>Hello, {props.name}!</h1>;
};

// ç®­å¤´å‡½æ•°ç®€å†™
const Welcome = ({ name }) => <h1>Hello, {name}!</h1>;

// ä¼ ç»Ÿå‡½æ•°å£°æ˜
function Welcome(props) {
  return <h1>Hello, {props.name}!</h1>;
}

// å¸¦é»˜è®¤props
const Welcome = ({ name = 'World' }) => <h1>Hello, {name}!</h1>;

// ä½¿ç”¨ç»„ä»¶
const App = () => (
  <div>
    <Welcome name="Alice" />
    <Welcome name="Bob" />
    <Welcome />
  </div>
);
```

**å‡½æ•°ç»„ä»¶é«˜çº§æ¨¡å¼**ï¼š

```javascript
// 1. ç»„ä»¶ä½œä¸ºprops
const Layout = ({ header, content, footer }) => (
  <div className="layout">
    <header>{header}</header>
    <main>{content}</main>
    <footer>{footer}</footer>
  </div>
);

// ä½¿ç”¨
<Layout
  header={<Header />}
  content={<MainContent />}
  footer={<Footer />}
/>

// 2. childrenæ¨¡å¼
const Card = ({ title, children }) => (
  <div className="card">
    <h2>{title}</h2>
    <div className="card-body">
      {children}
    </div>
  </div>
);

// ä½¿ç”¨
<Card title="ç”¨æˆ·ä¿¡æ¯">
  <p>å§“åï¼šå¼ ä¸‰</p>
  <p>é‚®ç®±ï¼šzhangsan@example.com</p>
</Card>

// 3. render propsæ¨¡å¼
const DataProvider = ({ children, url }) => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    fetch(url)
      .then(response => response.json())
      .then(data => {
        setData(data);
        setLoading(false);
      });
  }, [url]);
  
  return children({ data, loading });
};

// ä½¿ç”¨
<DataProvider url="/api/users">
  {({ data, loading }) => 
    loading ? <div>Loading...</div> : <UserList users={data} />
  }
</DataProvider>
```

#### 2.1.2 ç±»ç»„ä»¶

**ç±»ç»„ä»¶**æ˜¯Reactçš„ä¼ ç»Ÿç»„ä»¶å†™æ³•ï¼Œè™½ç„¶å‡½æ•°ç»„ä»¶æ˜¯è¶‹åŠ¿ï¼Œä½†ç†è§£ç±»ç»„ä»¶ä»ç„¶é‡è¦ã€‚

```javascript
// åŸºç¡€ç±»ç»„ä»¶
class Welcome extends React.Component {
  render() {
    return <h1>Hello, {this.props.name}!</h1>;
  }
}

// å¸¦çŠ¶æ€çš„ç±»ç»„ä»¶
class Counter extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      count: 0
    };
    
    // ç»‘å®šthis
    this.handleClick = this.handleClick.bind(this);
  }
  
  handleClick() {
    this.setState({ count: this.state.count + 1 });
  }
  
  render() {
    return (
      <div>
        <p>Count: {this.state.count}</p>
        <button onClick={this.handleClick}>+1</button>
      </div>
    );
  }
}

// ç®­å¤´å‡½æ•°é¿å…thisç»‘å®š
class Counter extends React.Component {
  state = { count: 0 };
  
  handleClick = () => {
    this.setState({ count: this.state.count + 1 });
  }
  
  render() {
    return (
      <div>
        <p>Count: {this.state.count}</p>
        <button onClick={this.handleClick}>+1</button>
      </div>
    );
  }
}
```

#### 2.1.3 ç»„ä»¶é€šä¿¡

**ç»„ä»¶é€šä¿¡**æ˜¯Reactåº”ç”¨çš„æ ¸å¿ƒï¼ŒåŒ…æ‹¬çˆ¶å­é€šä¿¡ã€å…„å¼Ÿé€šä¿¡ã€è·¨çº§é€šä¿¡ç­‰ã€‚

**ç»„ä»¶é€šä¿¡æ¨¡å¼**ï¼š

```mermaid
graph TB
    subgraph "Reactç»„ä»¶é€šä¿¡æ–¹å¼"
        subgraph "çˆ¶å­é€šä¿¡"
            PROPS["Propsä¼ é€’<br/>çˆ¶â†’å­"]
            CALLBACK["å›è°ƒå‡½æ•°<br/>å­â†’çˆ¶"]
        end
        
        subgraph "è·¨çº§é€šä¿¡"
            CONTEXT["Context API<br/>è·¨å±‚çº§"]
            REDUX["Redux<br/>å…¨å±€çŠ¶æ€"]
        end
        
        subgraph "å…„å¼Ÿé€šä¿¡"
            LIFT_STATE["çŠ¶æ€æå‡<br/>å…±åŒçˆ¶ç»„ä»¶"]
            EVENT_BUS["äº‹ä»¶æ€»çº¿<br/>å‘å¸ƒè®¢é˜…"]
        end
        
        subgraph "é«˜çº§é€šä¿¡"
            REF["Refå¼•ç”¨<br/>ç›´æ¥è°ƒç”¨"]
            PORTAL["Portal<br/>è·¨DOMæ ‘"]
        end
    end
    
    PROPS --> CALLBACK
    LIFT_STATE --> PROPS
    CONTEXT --> PROPS
    REDUX --> PROPS
```

**é€šä¿¡ç¤ºä¾‹ä»£ç **ï¼š

```javascript
// 1. çˆ¶å­é€šä¿¡
const Parent = () => {
  const [message, setMessage] = useState('Hello from Parent');
  
  const handleChildMessage = (childMessage) => {
    console.log('æ”¶åˆ°å­ç»„ä»¶æ¶ˆæ¯:', childMessage);
  };
  
  return (
    <div>
      <Child 
        message={message} 
        onMessage={handleChildMessage}
      />
    </div>
  );
};

const Child = ({ message, onMessage }) => {
  const sendMessage = () => {
    onMessage('Hello from Child');
  };
  
  return (
    <div>
      <p>çˆ¶ç»„ä»¶æ¶ˆæ¯: {message}</p>
      <button onClick={sendMessage}>å‘çˆ¶ç»„ä»¶å‘æ¶ˆæ¯</button>
    </div>
  );
};

// 2. Context APIè·¨çº§é€šä¿¡
const ThemeContext = React.createContext('light');

const App = () => {
  const [theme, setTheme] = useState('light');
  
  return (
    <ThemeContext.Provider value={{ theme, setTheme }}>
      <Header />
      <Main />
      <Footer />
    </ThemeContext.Provider>
  );
};

const ThemeButton = () => {
  const { theme, setTheme } = useContext(ThemeContext);
  
  return (
    <button onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>
      åˆ‡æ¢åˆ°{theme === 'light' ? 'æš—' : 'äº®'}è‰²ä¸»é¢˜
    </button>
  );
};

// 3. è‡ªå®šä¹‰Hookå®ç°çŠ¶æ€å…±äº«
const useSharedState = (initialValue) => {
  const [state, setState] = useState(initialValue);
  
  const updateState = useCallback((newState) => {
    setState(newState);
  }, []);
  
  return [state, updateState];
};

// 4. Refé€šä¿¡
const Parent = () => {
  const childRef = useRef();
  
  const callChildMethod = () => {
    childRef.current.focus();
  };
  
  return (
    <div>
      <Child ref={childRef} />
      <button onClick={callChildMethod}>Focus Child</button>
    </div>
  );
};

const Child = forwardRef((props, ref) => {
  const inputRef = useRef();
  
  useImperativeHandle(ref, () => ({
    focus: () => {
      inputRef.current.focus();
    }
  }));
  
  return <input ref={inputRef} />;
});
```

### 2.2 ç”Ÿå‘½å‘¨æœŸè¯¦è§£

#### 2.2.1 æŒ‚è½½é˜¶æ®µ

**ç»„ä»¶æŒ‚è½½**æ˜¯ç»„ä»¶ä»åˆ›å»ºåˆ°æ’å…¥DOMçš„è¿‡ç¨‹ã€‚

**ç”Ÿå‘½å‘¨æœŸæµç¨‹**ï¼š

```mermaid
graph TB
    subgraph "Reactç”Ÿå‘½å‘¨æœŸï¼ˆç±»ç»„ä»¶ï¼‰"
        subgraph "æŒ‚è½½é˜¶æ®µ Mounting"
            CONSTRUCTOR["constructor()<br/>æ„é€ å‡½æ•°"]
            GET_DERIVED["getDerivedStateFromProps()<br/>ä»propsè·å–state"]
            RENDER["render()<br/>æ¸²æŸ“"]
            DID_MOUNT["componentDidMount()<br/>æŒ‚è½½å®Œæˆ"]
        end
        
        subgraph "æ›´æ–°é˜¶æ®µ Updating"
            GET_DERIVED_UPDATE["getDerivedStateFromProps()"]
            SHOULD_UPDATE["shouldComponentUpdate()<br/>æ˜¯å¦åº”è¯¥æ›´æ–°"]
            RENDER_UPDATE["render()"]
            GET_SNAPSHOT["getSnapshotBeforeUpdate()<br/>æ›´æ–°å‰å¿«ç…§"]
            DID_UPDATE["componentDidUpdate()<br/>æ›´æ–°å®Œæˆ"]
        end
        
        subgraph "å¸è½½é˜¶æ®µ Unmounting"
            WILL_UNMOUNT["componentWillUnmount()<br/>å³å°†å¸è½½"]
        end
    end
    
    CONSTRUCTOR --> GET_DERIVED
    GET_DERIVED --> RENDER
    RENDER --> DID_MOUNT
    
    DID_MOUNT --> GET_DERIVED_UPDATE
    GET_DERIVED_UPDATE --> SHOULD_UPDATE
    SHOULD_UPDATE --> RENDER_UPDATE
    RENDER_UPDATE --> GET_SNAPSHOT
    GET_SNAPSHOT --> DID_UPDATE
    DID_UPDATE --> GET_DERIVED_UPDATE
    
    DID_UPDATE --> WILL_UNMOUNT
```

**ç”Ÿå‘½å‘¨æœŸä¸Hookså¯¹åº”å…³ç³»**ï¼š

| ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ | Hooksç­‰ä»·å†™æ³• | ç”¨é€” |
|----------------|---------------|------|
| `constructor` | `useState`åˆå§‹å€¼ | åˆå§‹åŒ–çŠ¶æ€ |
| `componentDidMount` | `useEffect(fn, [])` | ç»„ä»¶æŒ‚è½½å |
| `componentDidUpdate` | `useEffect(fn)` | ç»„ä»¶æ›´æ–°å |
| `componentWillUnmount` | `useEffect(() => fn, [])` | ç»„ä»¶å¸è½½å‰ |
| `shouldComponentUpdate` | `React.memo` | æ€§èƒ½ä¼˜åŒ– |
| `getDerivedStateFromProps` | `useState` + `useEffect` | ä»propsè®¡ç®—state |

**Hooksç”Ÿå‘½å‘¨æœŸç¤ºä¾‹**ï¼š

```javascript
// ç±»ç»„ä»¶å†™æ³•
class UserProfile extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      user: null,
      loading: true
    };
  }
  
  async componentDidMount() {
    console.log('ç»„ä»¶æŒ‚è½½');
    this.setState({ loading: true });
    const user = await fetchUser(this.props.userId);
    this.setState({ user, loading: false });
  }
  
  async componentDidUpdate(prevProps) {
    if (prevProps.userId !== this.props.userId) {
      console.log('userId changed');
      this.setState({ loading: true });
      const user = await fetchUser(this.props.userId);
      this.setState({ user, loading: false });
    }
  }
  
  componentWillUnmount() {
    console.log('ç»„ä»¶å¸è½½');
    // æ¸…ç†å·¥ä½œ
  }
  
  render() {
    if (this.state.loading) return <div>Loading...</div>;
    return <div>{this.state.user?.name}</div>;
  }
}

// Hookså†™æ³•
const UserProfile = ({ userId }) => {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    console.log('ç»„ä»¶æŒ‚è½½æˆ–userIdå˜åŒ–');
    
    const loadUser = async () => {
      setLoading(true);
      const userData = await fetchUser(userId);
      setUser(userData);
      setLoading(false);
    };
    
    loadUser();
    
    // æ¸…ç†å‡½æ•°ï¼ˆç›¸å½“äºcomponentWillUnmountï¼‰
    return () => {
      console.log('æ¸…ç†å·¥ä½œ');
    };
  }, [userId]); // ä¾èµ–æ•°ç»„
  
  if (loading) return <div>Loading...</div>;
  return <div>{user?.name}</div>;
};
```

#### 2.2.2 æ›´æ–°é˜¶æ®µ

**ç»„ä»¶æ›´æ–°**å‘ç”Ÿåœ¨propsæˆ–stateå˜åŒ–æ—¶ã€‚

```javascript
// æ€§èƒ½ä¼˜åŒ–ï¼šé˜²æ­¢ä¸å¿…è¦çš„æ›´æ–°
const ExpensiveComponent = React.memo(({ data, config }) => {
  console.log('ExpensiveComponent render');
  
  // å¤æ‚è®¡ç®—
  const processedData = useMemo(() => {
    return data.map(item => ({
      ...item,
      processed: expensiveCalculation(item, config)
    }));
  }, [data, config]);
  
  return (
    <div>
      {processedData.map(item => (
        <div key={item.id}>{item.processed}</div>
      ))}
    </div>
  );
});

// è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°
const MyComponent = React.memo(({ user, settings }) => {
  return <div>{user.name}</div>;
}, (prevProps, nextProps) => {
  // è¿”å›trueè¡¨ç¤ºpropsç›¸ç­‰ï¼Œä¸éœ€è¦é‡æ–°æ¸²æŸ“
  return prevProps.user.id === nextProps.user.id;
});

// useCallbackä¼˜åŒ–å‡½æ•°å¼•ç”¨
const TodoList = ({ todos }) => {
  const [filter, setFilter] = useState('all');
  
  // é¿å…æ¯æ¬¡æ¸²æŸ“éƒ½åˆ›å»ºæ–°å‡½æ•°
  const handleToggle = useCallback((id) => {
    // åˆ‡æ¢todoçŠ¶æ€çš„é€»è¾‘
    console.log('Toggle todo:', id);
  }, []);
  
  const filteredTodos = useMemo(() => {
    return todos.filter(todo => {
      if (filter === 'active') return !todo.completed;
      if (filter === 'completed') return todo.completed;
      return true;
    });
  }, [todos, filter]);
  
  return (
    <div>
      <FilterButtons filter={filter} onFilterChange={setFilter} />
      {filteredTodos.map(todo => (
        <TodoItem 
          key={todo.id} 
          todo={todo} 
          onToggle={handleToggle}
        />
      ))}
    </div>
  );
};
```

#### 2.2.3 å¸è½½é˜¶æ®µ

**ç»„ä»¶å¸è½½**æ—¶éœ€è¦æ¸…ç†å‰¯ä½œç”¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚

```javascript
// æ¸…ç†å‰¯ä½œç”¨çš„æœ€ä½³å®è·µ
const TimerComponent = () => {
  const [time, setTime] = useState(new Date());
  
  useEffect(() => {
    const timer = setInterval(() => {
      setTime(new Date());
    }, 1000);
    
    // æ¸…ç†å®šæ—¶å™¨
    return () => {
      clearInterval(timer);
    };
  }, []);
  
  return <div>{time.toLocaleTimeString()}</div>;
};

// äº‹ä»¶ç›‘å¬å™¨æ¸…ç†
const WindowSizeTracker = () => {
  const [windowSize, setWindowSize] = useState({
    width: window.innerWidth,
    height: window.innerHeight
  });
  
  useEffect(() => {
    const handleResize = () => {
      setWindowSize({
        width: window.innerWidth,
        height: window.innerHeight
      });
    };
    
    window.addEventListener('resize', handleResize);
    
    // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
    return () => {
      window.removeEventListener('resize', handleResize);
    };
  }, []);
  
  return <div>çª—å£å¤§å°: {windowSize.width} x {windowSize.height}</div>;
};

// å–æ¶ˆç½‘ç»œè¯·æ±‚
const DataFetcher = ({ url }) => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    const abortController = new AbortController();
    
    const fetchData = async () => {
      try {
        setLoading(true);
        const response = await fetch(url, {
          signal: abortController.signal
        });
        const result = await response.json();
        setData(result);
      } catch (error) {
        if (error.name !== 'AbortError') {
          console.error('Fetch error:', error);
        }
      } finally {
        setLoading(false);
      }
    };
    
    fetchData();
    
    // æ¸…ç†ï¼šå–æ¶ˆè¯·æ±‚
    return () => {
      abortController.abort();
    };
  }, [url]);
  
  if (loading) return <div>Loading...</div>;
  return <div>{JSON.stringify(data)}</div>;
};
```

### 2.3 äº‹ä»¶å¤„ç†æœºåˆ¶

#### 2.3.1 åˆæˆäº‹ä»¶ç³»ç»Ÿ

**åˆæˆäº‹ä»¶(SyntheticEvent)**æ˜¯Reactå¯¹åŸç”Ÿäº‹ä»¶çš„å°è£…ï¼Œæä¾›è·¨æµè§ˆå™¨å…¼å®¹æ€§ã€‚

**åˆæˆäº‹ä»¶ç‰¹ç‚¹**ï¼š

```mermaid
graph TB
    subgraph "Reactåˆæˆäº‹ä»¶ç³»ç»Ÿ"
        subgraph "äº‹ä»¶ç‰¹æ€§"
            CROSS_BROWSER["è·¨æµè§ˆå™¨å…¼å®¹<br/>Cross-browser"]
            CONSISTENT_API["ä¸€è‡´çš„API<br/>Consistent API"]
            POOLING["äº‹ä»¶æ± åŒ–<br/>Event Pooling"]
        end
        
        subgraph "äº‹ä»¶å¤„ç†"
            DELEGATION["äº‹ä»¶å§”æ‰˜<br/>Event Delegation"]
            BUBBLING["äº‹ä»¶å†’æ³¡<br/>Event Bubbling"]
            CAPTURE["äº‹ä»¶æ•è·<br/>Event Capturing"]
        end
        
        subgraph "æ€§èƒ½ä¼˜åŒ–"
            MEMORY_POOL["å†…å­˜æ± <br/>Memory Pool"]
            BATCH_UPDATE["æ‰¹é‡æ›´æ–°<br/>Batch Updates"]
            ASYNC_EVENT["å¼‚æ­¥äº‹ä»¶<br/>Async Events"]
        end
    end
    
    CROSS_BROWSER --> DELEGATION
    CONSISTENT_API --> BUBBLING
    POOLING --> MEMORY_POOL
    
    DELEGATION --> BATCH_UPDATE
    BUBBLING --> ASYNC_EVENT
```

**äº‹ä»¶å¤„ç†ç¤ºä¾‹**ï¼š

```javascript
// åŸºç¡€äº‹ä»¶å¤„ç†
const Button = () => {
  const handleClick = (e) => {
    // eæ˜¯åˆæˆäº‹ä»¶å¯¹è±¡
    console.log('Event type:', e.type);
    console.log('Current target:', e.currentTarget);
    console.log('Native event:', e.nativeEvent);
    
    // é˜»æ­¢é»˜è®¤è¡Œä¸º
    e.preventDefault();
    
    // é˜»æ­¢äº‹ä»¶å†’æ³¡
    e.stopPropagation();
  };
  
  return <button onClick={handleClick}>Click me</button>;
};

// è¡¨å•äº‹ä»¶å¤„ç†
const ContactForm = () => {
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    message: ''
  });
  
  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: value
    }));
  };
  
  const handleSubmit = (e) => {
    e.preventDefault();
    console.log('Form submitted:', formData);
  };
  
  const handleKeyDown = (e) => {
    if (e.key === 'Enter' && e.ctrlKey) {
      handleSubmit(e);
    }
  };
  
  return (
    <form onSubmit={handleSubmit}>
      <input
        name="name"
        value={formData.name}
        onChange={handleChange}
        placeholder="å§“å"
      />
      <input
        name="email"
        type="email"
        value={formData.email}
        onChange={handleChange}
        placeholder="é‚®ç®±"
      />
      <textarea
        name="message"
        value={formData.message}
        onChange={handleChange}
        onKeyDown={handleKeyDown}
        placeholder="æ¶ˆæ¯ (Ctrl+Enteræäº¤)"
      />
      <button type="submit">æäº¤</button>
    </form>
  );
};

// è‡ªå®šä¹‰äº‹ä»¶å¤„ç†Hook
const useEventListener = (eventName, handler, element = window) => {
  const savedHandler = useRef();
  
  useEffect(() => {
    savedHandler.current = handler;
  }, [handler]);
  
  useEffect(() => {
    const isSupported = element && element.addEventListener;
    if (!isSupported) return;
    
    const eventListener = (event) => savedHandler.current(event);
    element.addEventListener(eventName, eventListener);
    
    return () => {
      element.removeEventListener(eventName, eventListener);
    };
  }, [eventName, element]);
};

// ä½¿ç”¨è‡ªå®šä¹‰Hook
const KeyboardShortcuts = () => {
  const [message, setMessage] = useState('');
  
  useEventListener('keydown', (e) => {
    if (e.ctrlKey && e.key === 's') {
      e.preventDefault();
      setMessage('Ctrl+S ä¿å­˜å¿«æ·é”®è¢«æŒ‰ä¸‹');
    }
    if (e.key === 'Escape') {
      setMessage('');
    }
  });
  
  return <div>{message}</div>;
};
```

#### 2.3.2 äº‹ä»¶å§”æ‰˜æœºåˆ¶

**äº‹ä»¶å§”æ‰˜**æ˜¯Reactæ€§èƒ½ä¼˜åŒ–çš„é‡è¦æœºåˆ¶ã€‚

```javascript
// Reactäº‹ä»¶å§”æ‰˜åŸç†ç¤ºä¾‹
class EventDelegation {
  constructor() {
    this.eventMap = new Map();
    this.bindEvent();
  }
  
  bindEvent() {
    // Reactå°†æ‰€æœ‰äº‹ä»¶ç»‘å®šåˆ°documentæ ¹èŠ‚ç‚¹
    document.addEventListener('click', this.handleDocumentClick.bind(this));
  }
  
  handleDocumentClick(nativeEvent) {
    let target = nativeEvent.target;
    
    // å‘ä¸Šéå†DOMæ ‘ï¼ŒæŸ¥æ‰¾æ³¨å†Œçš„äº‹ä»¶å¤„ç†å™¨
    while (target && target !== document) {
      const reactEventHandler = this.eventMap.get(target);
      if (reactEventHandler) {
        // åˆ›å»ºåˆæˆäº‹ä»¶å¯¹è±¡
        const syntheticEvent = this.createSyntheticEvent(nativeEvent, target);
        reactEventHandler(syntheticEvent);
        
        if (syntheticEvent.isPropagationStopped()) {
          break;
        }
      }
      target = target.parentNode;
    }
  }
  
  createSyntheticEvent(nativeEvent, currentTarget) {
    return {
      type: nativeEvent.type,
      currentTarget,
      target: nativeEvent.target,
      nativeEvent,
      preventDefault: () => nativeEvent.preventDefault(),
      stopPropagation: () => {
        this._propagationStopped = true;
      },
      isPropagationStopped: () => this._propagationStopped || false
    };
  }
  
  registerEvent(element, handler) {
    this.eventMap.set(element, handler);
  }
}

// å®é™…ä½¿ç”¨ä¸­çš„ä¼˜åŒ–æŠ€å·§
const ListComponent = ({ items, onItemClick }) => {
  // ä½¿ç”¨äº‹ä»¶å§”æ‰˜å¤„ç†åˆ—è¡¨é¡¹ç‚¹å‡»
  const handleListClick = (e) => {
    const itemElement = e.target.closest('[data-item-id]');
    if (itemElement) {
      const itemId = itemElement.dataset.itemId;
      onItemClick(itemId);
    }
  };
  
  return (
    <ul onClick={handleListClick}>
      {items.map(item => (
        <li key={item.id} data-item-id={item.id}>
          {item.name}
        </li>
      ))}
    </ul>
  );
};

// é˜²æŠ–å’ŒèŠ‚æµå¤„ç†
const useDebounce = (value, delay) => {
  const [debouncedValue, setDebouncedValue] = useState(value);
  
  useEffect(() => {
    const handler = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);
    
    return () => {
      clearTimeout(handler);
    };
  }, [value, delay]);
  
  return debouncedValue;
};

const SearchInput = ({ onSearch }) => {
  const [query, setQuery] = useState('');
  const debouncedQuery = useDebounce(query, 300);
  
  useEffect(() => {
    if (debouncedQuery) {
      onSearch(debouncedQuery);
    }
  }, [debouncedQuery, onSearch]);
  
  return (
    <input
      value={query}
      onChange={(e) => setQuery(e.target.value)}
      placeholder="æœç´¢..."
    />
  );
};
```

## 3. React Hooks æ·±åº¦è§£æ

### 3.1 åŸºç¡€Hooks

#### 3.1.1 useState

**useState**æ˜¯æœ€åŸºç¡€çš„Hookï¼Œç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ çŠ¶æ€ã€‚

```javascript
// åŸºç¡€ç”¨æ³•
const Counter = () => {
  const [count, setCount] = useState(0);
  
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>+1</button>
      <button onClick={() => setCount(prev => prev + 1)}>+1 (å‡½æ•°å¼)</button>
    </div>
  );
};

// å¤æ‚çŠ¶æ€ç®¡ç†
const UserForm = () => {
  const [user, setUser] = useState({
    name: '',
    email: '',
    age: 0
  });
  
  const updateUser = (field, value) => {
    setUser(prev => ({
      ...prev,
      [field]: value
    }));
  };
  
  return (
    <form>
      <input
        value={user.name}
        onChange={(e) => updateUser('name', e.target.value)}
        placeholder="å§“å"
      />
      <input
        value={user.email}
        onChange={(e) => updateUser('email', e.target.value)}
        placeholder="é‚®ç®±"
      />
      <input
        type="number"
        value={user.age}
        onChange={(e) => updateUser('age', parseInt(e.target.value))}
        placeholder="å¹´é¾„"
      />
    </form>
  );
};

// æƒ°æ€§åˆå§‹åŒ–
const ExpensiveComponent = () => {
  // åªåœ¨é¦–æ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œæ˜‚è´µçš„è®¡ç®—
  const [data, setData] = useState(() => {
    console.log('æ‰§è¡Œæ˜‚è´µçš„åˆå§‹åŒ–è®¡ç®—');
    return expensiveCalculation();
  });
  
  return <div>{data}</div>;
};

// çŠ¶æ€æ›´æ–°çš„æ³¨æ„äº‹é¡¹
const StateUpdateExample = () => {
  const [count, setCount] = useState(0);
  
  const handleClick = () => {
    // âŒ é”™è¯¯ï¼šä¼šè¢«æ‰¹é‡å¤„ç†ï¼Œåªä¼š+1
    setCount(count + 1);
    setCount(count + 1);
    setCount(count + 1);
    
    // âœ… æ­£ç¡®ï¼šä½¿ç”¨å‡½æ•°å¼æ›´æ–°
    setCount(prev => prev + 1);
    setCount(prev => prev + 1);
    setCount(prev => prev + 1);
  };
  
  const handleAsyncClick = () => {
    setTimeout(() => {
      // âŒ åœ¨å¼‚æ­¥å›è°ƒä¸­ï¼Œå¯èƒ½è·å–åˆ°è¿‡æœŸçš„state
      setCount(count + 1);
      
      // âœ… ä½¿ç”¨å‡½æ•°å¼æ›´æ–°è·å–æœ€æ–°state
      setCount(prev => prev + 1);
    }, 1000);
  };
  
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={handleClick}>åŒæ­¥+3</button>
      <button onClick={handleAsyncClick}>å¼‚æ­¥+1</button>
    </div>
  );
};
```

#### 3.1.2 useEffect

**useEffect**å¤„ç†å‰¯ä½œç”¨ï¼Œæ˜¯React Hooksä¸­æœ€é‡è¦çš„Hookä¹‹ä¸€ã€‚

```javascript
// åŸºç¡€ç”¨æ³•
const Timer = () => {
  const [seconds, setSeconds] = useState(0);
  
  // ç›¸å½“äºcomponentDidMountå’ŒcomponentDidUpdate
  useEffect(() => {
    document.title = `Timer: ${seconds}s`;
  });
  
  // ç›¸å½“äºcomponentDidMount
  useEffect(() => {
    const timer = setInterval(() => {
      setSeconds(prev => prev + 1);
    }, 1000);
    
    // ç›¸å½“äºcomponentWillUnmount
    return () => {
      clearInterval(timer);
    };
  }, []); // ç©ºä¾èµ–æ•°ç»„ï¼Œåªåœ¨æŒ‚è½½æ—¶æ‰§è¡Œ
  
  return <div>Seconds: {seconds}</div>;
};

// ä¾èµ–æ•°ç»„çš„ä½¿ç”¨
const UserProfile = ({ userId }) => {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    let cancelled = false;
    
    const fetchUser = async () => {
      setLoading(true);
      try {
        const userData = await api.getUser(userId);
        if (!cancelled) {
          setUser(userData);
        }
      } catch (error) {
        if (!cancelled) {
          console.error('è·å–ç”¨æˆ·å¤±è´¥:', error);
        }
      } finally {
        if (!cancelled) {
          setLoading(false);
        }
      }
    };
    
    fetchUser();
    
    return () => {
      cancelled = true;
    };
  }, [userId]); // userIdå˜åŒ–æ—¶é‡æ–°æ‰§è¡Œ
  
  if (loading) return <div>Loading...</div>;
  return <div>{user?.name}</div>;
};

// å¤šä¸ªuseEffectçš„ä½¿ç”¨
const ChatRoom = ({ roomId, userId }) => {
  const [messages, setMessages] = useState([]);
  const [onlineUsers, setOnlineUsers] = useState([]);
  
  // å¤„ç†æ¶ˆæ¯è®¢é˜…
  useEffect(() => {
    const unsubscribe = messageService.subscribe(roomId, (newMessage) => {
      setMessages(prev => [...prev, newMessage]);
    });
    
    return unsubscribe;
  }, [roomId]);
  
  // å¤„ç†åœ¨çº¿ç”¨æˆ·
  useEffect(() => {
    const unsubscribe = userService.subscribeOnlineUsers(roomId, (users) => {
      setOnlineUsers(users);
    });
    
    return unsubscribe;
  }, [roomId]);
  
  // ç”¨æˆ·æ´»åŠ¨çŠ¶æ€
  useEffect(() => {
    userService.setUserActive(userId, roomId);
    
    return () => {
      userService.setUserInactive(userId, roomId);
    };
  }, [userId, roomId]);
  
  return (
    <div>
      <div>åœ¨çº¿ç”¨æˆ·: {onlineUsers.length}</div>
      <div>
        {messages.map(msg => (
          <div key={msg.id}>{msg.content}</div>
        ))}
      </div>
    </div>
  );
};

// è‡ªå®šä¹‰Effect Hook
const useDocumentTitle = (title) => {
  useEffect(() => {
    const prevTitle = document.title;
    document.title = title;
    
    return () => {
      document.title = prevTitle;
    };
  }, [title]);
};

const useLocalStorage = (key, initialValue) => {
  const [value, setValue] = useState(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      return initialValue;
    }
  });
  
  useEffect(() => {
    try {
      window.localStorage.setItem(key, JSON.stringify(value));
    } catch (error) {
      console.error('ä¿å­˜åˆ°localStorageå¤±è´¥:', error);
    }
  }, [key, value]);
  
  return [value, setValue];
};

// ä½¿ç”¨è‡ªå®šä¹‰Hook
const Settings = () => {
  const [theme, setTheme] = useLocalStorage('theme', 'light');
  const [language, setLanguage] = useLocalStorage('language', 'zh');
  
  useDocumentTitle(`è®¾ç½® - ${theme === 'light' ? 'äº®è‰²' : 'æš—è‰²'}ä¸»é¢˜`);
  
  return (
    <div>
      <select value={theme} onChange={(e) => setTheme(e.target.value)}>
        <option value="light">äº®è‰²ä¸»é¢˜</option>
        <option value="dark">æš—è‰²ä¸»é¢˜</option>
      </select>
      <select value={language} onChange={(e) => setLanguage(e.target.value)}>
        <option value="zh">ä¸­æ–‡</option>
        <option value="en">English</option>
      </select>
    </div>
  );
};
```

#### 3.1.3 useContext

**useContext**ç”¨äºè·¨ç»„ä»¶å±‚çº§ä¼ é€’æ•°æ®ï¼Œé¿å…props drillingã€‚

```javascript
// åˆ›å»ºContext
const ThemeContext = createContext();
const UserContext = createContext();

// ç»„åˆå¤šä¸ªContext
const AppProvider = ({ children }) => {
  const [theme, setTheme] = useState('light');
  const [user, setUser] = useState(null);
  
  const themeValue = {
    theme,
    setTheme,
    colors: theme === 'light' ? lightColors : darkColors
  };
  
  const userValue = {
    user,
    setUser,
    isLoggedIn: !!user
  };
  
  return (
    <ThemeContext.Provider value={themeValue}>
      <UserContext.Provider value={userValue}>
        {children}
      </UserContext.Provider>
    </ThemeContext.Provider>
  );
};

// è‡ªå®šä¹‰Hookå°è£…Context
const useTheme = () => {
  const context = useContext(ThemeContext);
  if (!context) {
    throw new Error('useTheme must be used within a ThemeProvider');
  }
  return context;
};

const useUser = () => {
  const context = useContext(UserContext);
  if (!context) {
    throw new Error('useUser must be used within a UserProvider');
  }
  return context;
};

// ä½¿ç”¨Contextçš„ç»„ä»¶
const Header = () => {
  const { theme, setTheme } = useTheme();
  const { user, isLoggedIn } = useUser();
  
  return (
    <header style={{ backgroundColor: theme === 'light' ? '#fff' : '#333' }}>
      <h1>My App</h1>
      <div>
        <button onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>
          åˆ‡æ¢ä¸»é¢˜
        </button>
        {isLoggedIn ? (
          <span>æ¬¢è¿, {user.name}!</span>
        ) : (
          <button>ç™»å½•</button>
        )}
      </div>
    </header>
  );
};

// å¤æ‚çŠ¶æ€ç®¡ç†with Context + useReducer
const AppStateContext = createContext();

const appReducer = (state, action) => {
  switch (action.type) {
    case 'SET_LOADING':
      return { ...state, loading: action.payload };
    case 'SET_USER':
      return { ...state, user: action.payload, loading: false };
    case 'SET_ERROR':
      return { ...state, error: action.payload, loading: false };
    case 'CLEAR_ERROR':
      return { ...state, error: null };
    default:
      return state;
  }
};

const AppStateProvider = ({ children }) => {
  const [state, dispatch] = useReducer(appReducer, {
    user: null,
    loading: false,
    error: null
  });
  
  const login = async (credentials) => {
    dispatch({ type: 'SET_LOADING', payload: true });
    try {
      const user = await api.login(credentials);
      dispatch({ type: 'SET_USER', payload: user });
    } catch (error) {
      dispatch({ type: 'SET_ERROR', payload: error.message });
    }
  };
  
  const logout = () => {
    dispatch({ type: 'SET_USER', payload: null });
  };
  
  const value = {
    ...state,
    login,
    logout,
    clearError: () => dispatch({ type: 'CLEAR_ERROR' })
  };
  
  return (
    <AppStateContext.Provider value={value}>
      {children}
    </AppStateContext.Provider>
  );
};

const useAppState = () => {
  const context = useContext(AppStateContext);
  if (!context) {
    throw new Error('useAppState must be used within AppStateProvider');
  }
  return context;
};
```

### 3.2 é«˜çº§Hooks

#### 3.2.1 useReducer

**useReducer**æ˜¯useStateçš„æ›¿ä»£æ–¹æ¡ˆï¼Œé€‚åˆå¤æ‚çŠ¶æ€é€»è¾‘ç®¡ç†ã€‚

```javascript
// åŸºç¡€useReducerä½¿ç”¨
const initialState = { count: 0 };

const reducer = (state, action) => {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 };
    case 'decrement':
      return { count: state.count - 1 };
    case 'reset':
      return initialState;
    default:
      throw new Error(`æœªçŸ¥çš„actionç±»å‹: ${action.type}`);
  }
};

const Counter = () => {
  const [state, dispatch] = useReducer(reducer, initialState);
  
  return (
    <div>
      <p>Count: {state.count}</p>
      <button onClick={() => dispatch({ type: 'increment' })}>+</button>
      <button onClick={() => dispatch({ type: 'decrement' })}>-</button>
      <button onClick={() => dispatch({ type: 'reset' })}>Reset</button>
    </div>
  );
};
```

#### 3.2.2 useMemo å’Œ useCallback

**useMemoå’ŒuseCallback**ç”¨äºæ€§èƒ½ä¼˜åŒ–ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—å’Œé‡æ–°æ¸²æŸ“ã€‚

```javascript
// useMemoä¼˜åŒ–æ˜‚è´µè®¡ç®—
const ExpensiveList = ({ items, filter }) => {
  const filteredItems = useMemo(() => {
    console.log('æ‰§è¡Œæ˜‚è´µçš„è¿‡æ»¤è®¡ç®—');
    return items.filter(item => 
      item.name.toLowerCase().includes(filter.toLowerCase())
    );
  }, [items, filter]);
  
  return (
    <ul>
      {filteredItems.map(item => (
        <li key={item.id}>{item.name}</li>
      ))}
    </ul>
  );
};

// useCallbackä¼˜åŒ–å‡½æ•°å¼•ç”¨
const TodoList = ({ todos, onToggle }) => {
  const handleToggle = useCallback((id) => {
    onToggle(id);
  }, [onToggle]);
  
  return (
    <div>
      {todos.map(todo => (
        <TodoItem key={todo.id} todo={todo} onToggle={handleToggle} />
      ))}
    </div>
  );
};
```

#### 3.2.3 useRef å’Œ useImperativeHandle

**useRefå’ŒuseImperativeHandle**ç”¨äºè®¿é—®DOMå…ƒç´ å’Œå‘½ä»¤å¼APIã€‚

```javascript
// useRefåŸºæœ¬ç”¨æ³•
const FocusInput = () => {
  const inputRef = useRef(null);
  
  const focusInput = () => {
    inputRef.current.focus();
  };
  
  return (
    <div>
      <input ref={inputRef} type="text" />
      <button onClick={focusInput}>Focus Input</button>
    </div>
  );
};

// useImperativeHandleæš´éœ²ç»„ä»¶æ–¹æ³•
const CustomInput = forwardRef((props, ref) => {
  const inputRef = useRef();
  const [value, setValue] = useState('');
  
  useImperativeHandle(ref, () => ({
    focus: () => inputRef.current.focus(),
    clear: () => setValue(''),
    getValue: () => value
  }));
  
  return (
    <input
      ref={inputRef}
      value={value}
      onChange={(e) => setValue(e.target.value)}
      {...props}
    />
  );
});
```

### 3.3 è‡ªå®šä¹‰Hooks

#### 3.3.1 è®¾è®¡åŸåˆ™

**è‡ªå®šä¹‰Hooks**æ˜¯ç»„åˆå†…ç½®Hooksæ¥åˆ›å»ºå¯å¤ç”¨é€»è¾‘çš„å¼ºå¤§æ–¹å¼ã€‚

**è®¾è®¡åŸåˆ™**ï¼š
1. **ä»¥useå¼€å¤´**ï¼šéµå¾ªHookså‘½åçº¦å®š
2. **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªHookåªè§£å†³ä¸€ä¸ªé—®é¢˜
3. **å¯å¤ç”¨æ€§**ï¼šèƒ½åœ¨å¤šä¸ªç»„ä»¶ä¸­ä½¿ç”¨
4. **å‚æ•°åŒ–**ï¼šé€šè¿‡å‚æ•°é…ç½®ä¸åŒè¡Œä¸º

#### 3.3.2 å¸¸ç”¨è‡ªå®šä¹‰Hooks

```javascript
// 1. useToggle - åˆ‡æ¢å¸ƒå°”å€¼
const useToggle = (initialValue = false) => {
  const [value, setValue] = useState(initialValue);
  
  const toggle = useCallback(() => {
    setValue(prev => !prev);
  }, []);
  
  return [value, toggle];
};

// 2. useFetch - æ•°æ®è·å–
const useFetch = (url) => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    const fetchData = async () => {
      try {
        setLoading(true);
        const response = await fetch(url);
        const result = await response.json();
        setData(result);
      } catch (err) {
        setError(err.message);
      } finally {
        setLoading(false);
      }
    };
    
    fetchData();
  }, [url]);
  
  return { data, loading, error };
};

// 3. useLocalStorage - æœ¬åœ°å­˜å‚¨
const useLocalStorage = (key, initialValue) => {
  const [storedValue, setStoredValue] = useState(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      return initialValue;
    }
  });
  
  const setValue = (value) => {
    try {
      setStoredValue(value);
      window.localStorage.setItem(key, JSON.stringify(value));
    } catch (error) {
      console.error('Error saving to localStorage:', error);
    }
  };
  
  return [storedValue, setValue];
};
```

## 10. React é¢è¯•é¢˜è¯¦è§£

### 10.1 åŸºç¡€æ¦‚å¿µç±»

#### Q1: ä»€ä¹ˆæ˜¯Reactï¼ŸReactæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
Reactæ˜¯ç”±Facebookå¼€å‘çš„ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„JavaScriptåº“ã€‚

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
1. **å£°æ˜å¼ç¼–ç¨‹**ï¼šæè¿°UIåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Œè€Œä¸æ˜¯å¦‚ä½•æ“ä½œDOM
2. **ç»„ä»¶åŒ–**ï¼šå°†UIæ‹†åˆ†ä¸ºç‹¬ç«‹ã€å¯å¤ç”¨çš„ç»„ä»¶
3. **è™šæ‹ŸDOM**ï¼šåœ¨å†…å­˜ä¸­æ“ä½œDOMå‰¯æœ¬ï¼Œæå‡æ€§èƒ½
4. **å•å‘æ•°æ®æµ**ï¼šæ•°æ®ä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ï¼Œä¾¿äºè°ƒè¯•
5. **ç”Ÿæ€ä¸°å¯Œ**ï¼šæ‹¥æœ‰åºå¤§çš„ç¬¬ä¸‰æ–¹åº“ç”Ÿæ€ç³»ç»Ÿ

#### Q2: ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Ÿè™šæ‹ŸDOMçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

**ç­”æ¡ˆ**ï¼š
**è™šæ‹ŸDOM**æ˜¯çœŸå®DOMçš„JavaScriptè¡¨ç¤ºï¼Œæ˜¯ä¸€ä¸ªæè¿°DOMç»“æ„çš„å¯¹è±¡æ ‘ã€‚

**å·¥ä½œåŸç†**ï¼š
1. **åˆ›å»ºè™šæ‹ŸDOM**ï¼šReactç»„ä»¶renderæ–¹æ³•è¿”å›è™šæ‹ŸDOMç»“æ„
2. **Diffç®—æ³•**ï¼šæ¯”è¾ƒæ–°æ—§è™šæ‹ŸDOMæ ‘çš„å·®å¼‚
3. **ç”Ÿæˆè¡¥ä¸**ï¼šåˆ›å»ºæœ€å°åŒ–çš„æ›´æ–°æ“ä½œ
4. **åº”ç”¨æ›´æ–°**ï¼šå°†è¡¥ä¸åº”ç”¨åˆ°çœŸå®DOM

**ä¼˜åŠ¿**ï¼š
- **æ€§èƒ½ä¼˜åŒ–**ï¼šæ‰¹é‡æ›´æ–°ï¼Œå‡å°‘DOMæ“ä½œ
- **è·¨å¹³å°**ï¼šè™šæ‹ŸDOMå¯ä»¥æ¸²æŸ“åˆ°ä¸åŒå¹³å°
- **å¯é¢„æµ‹æ€§**ï¼šçŠ¶æ€å˜åŒ–äº§ç”Ÿå¯é¢„æµ‹çš„è¾“å‡º

#### Q3: è§£é‡ŠReactçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•

**ç­”æ¡ˆ**ï¼š
Reactç»„ä»¶ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š

**æŒ‚è½½é˜¶æ®µï¼ˆMountingï¼‰**ï¼š
- `constructor()`: ç»„ä»¶åˆå§‹åŒ–
- `componentDidMount()`: ç»„ä»¶æŒ‚è½½å®Œæˆï¼Œé€‚åˆå‘èµ·ç½‘ç»œè¯·æ±‚

**æ›´æ–°é˜¶æ®µï¼ˆUpdatingï¼‰**ï¼š
- `componentDidUpdate(prevProps, prevState)`: ç»„ä»¶æ›´æ–°å®Œæˆ
- `shouldComponentUpdate(nextProps, nextState)`: å†³å®šæ˜¯å¦é‡æ–°æ¸²æŸ“

**å¸è½½é˜¶æ®µï¼ˆUnmountingï¼‰**ï¼š
- `componentWillUnmount()`: ç»„ä»¶å³å°†å¸è½½ï¼Œæ¸…ç†å·¥ä½œ

**Hookså¯¹åº”å…³ç³»**ï¼š
- `componentDidMount` â†’ `useEffect(() => {}, [])`
- `componentDidUpdate` â†’ `useEffect(() => {})`
- `componentWillUnmount` â†’ `useEffect(() => { return () => {} }, [])`

#### Q4: ä»€ä¹ˆæ˜¯JSXï¼ŸJSXçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

**ç­”æ¡ˆ**ï¼š
**JSX**æ˜¯JavaScriptçš„è¯­æ³•æ‰©å±•ï¼Œå…è®¸åœ¨JavaScriptä¸­ç¼–å†™ç±»ä¼¼HTMLçš„ä»£ç ã€‚

**åŸç†**ï¼š
JSXä¼šè¢«Babelè½¬è¯‘ä¸º`React.createElement()`è°ƒç”¨ï¼š

```javascript
// JSXä»£ç 
const element = <div className="container">Hello World</div>;

// è½¬è¯‘åçš„ä»£ç 
const element = React.createElement('div', { className: 'container' }, 'Hello World');
```

#### Q5: Reactä¸­çš„keyå±æ€§æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
**keyå±æ€§**å¸®åŠ©Reactè¯†åˆ«åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ã€‚

**ä½œç”¨**ï¼š
1. **Diffç®—æ³•ä¼˜åŒ–**ï¼šå¿«é€Ÿæ‰¾åˆ°å˜åŒ–çš„å…ƒç´ 
2. **ä¿æŒç»„ä»¶çŠ¶æ€**ï¼šé¿å…ä¸å¿…è¦çš„é‡æ–°åˆ›å»º
3. **é¿å…æ¸²æŸ“é”™è¯¯**ï¼šé˜²æ­¢å…ƒç´ é¡ºåºå˜åŒ–å¯¼è‡´çš„é—®é¢˜

**æœ€ä½³å®è·µ**ï¼š
```javascript
// âœ… ä½¿ç”¨ç¨³å®šçš„å”¯ä¸€æ ‡è¯†
{users.map(user => (
  <UserItem key={user.id} user={user} />
))}

// âŒ ä¸è¦ä½¿ç”¨æ•°ç»„ç´¢å¼•
{users.map((user, index) => (
  <UserItem key={index} user={user} />
))}
```

### 10.2 ç»„ä»¶ä¸ç”Ÿå‘½å‘¨æœŸç±»

#### Q6: ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**ç­”æ¡ˆ**ï¼š

| æ–¹é¢ | ç±»ç»„ä»¶ | å‡½æ•°ç»„ä»¶ |
|------|--------|----------|
| **è¯­æ³•** | Classè¯­æ³•ï¼Œéœ€è¦extends | å‡½æ•°è¯­æ³•ï¼Œæ›´ç®€æ´ |
| **çŠ¶æ€** | this.state | useState Hook |
| **ç”Ÿå‘½å‘¨æœŸ** | ç”Ÿå‘½å‘¨æœŸæ–¹æ³• | useEffect Hook |
| **æ€§èƒ½** | éœ€è¦shouldComponentUpdate | React.memo |
| **thisç»‘å®š** | éœ€è¦æ‰‹åŠ¨ç»‘å®š | æ— thisé—®é¢˜ |
| **å¤ç”¨é€»è¾‘** | HOC, Render Props | è‡ªå®šä¹‰Hooks |

#### Q7: ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶(HOC)ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
**é«˜é˜¶ç»„ä»¶(Higher-Order Component)**æ˜¯ä¸€ä¸ªæ¥æ”¶ç»„ä»¶å¹¶è¿”å›æ–°ç»„ä»¶çš„å‡½æ•°ã€‚

```javascript
// HOCå®ç°
const withLoading = (WrappedComponent) => {
  return (props) => {
    if (props.isLoading) {
      return <div>Loading...</div>;
    }
    return <WrappedComponent {...props} />;
  };
};

// ä½¿ç”¨HOC
const UserList = ({ users }) => (
  <ul>{users.map(user => <li key={user.id}>{user.name}</li>)}</ul>
);

const EnhancedUserList = withLoading(UserList);
```

#### Q8: ä»€ä¹ˆæ˜¯Render Propsæ¨¡å¼ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
**Render Props**æ˜¯ä¸€ç§åœ¨ç»„ä»¶é—´å…±äº«ä»£ç çš„æŠ€æœ¯ï¼Œé€šè¿‡propsä¼ é€’æ¸²æŸ“å‡½æ•°ã€‚

```javascript
// Render Propså®ç°
const Mouse = ({ children }) => {
  const [position, setPosition] = useState({ x: 0, y: 0 });
  
  useEffect(() => {
    const handleMouseMove = (e) => {
      setPosition({ x: e.clientX, y: e.clientY });
    };
    
    window.addEventListener('mousemove', handleMouseMove);
    return () => window.removeEventListener('mousemove', handleMouseMove);
  }, []);
  
  return children(position);
};

// ä½¿ç”¨Render Props
const App = () => (
  <Mouse>
    {mouse => (
      <div>é¼ æ ‡ä½ç½®: ({mouse.x}, {mouse.y})</div>
    )}
  </Mouse>
);
```

### 10.3 Hooks æ·±åº¦ç†è§£ç±»

#### Q9: useEffectçš„ä¾èµ–æ•°ç»„æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
**ä¾èµ–æ•°ç»„**å†³å®šäº†useEffectä½•æ—¶é‡æ–°æ‰§è¡Œã€‚

**ä¸‰ç§æƒ…å†µ**ï¼š
```javascript
// 1. æ²¡æœ‰ä¾èµ–æ•°ç»„ï¼šæ¯æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œ
useEffect(() => {
  console.log('æ¯æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œ');
});

// 2. ç©ºä¾èµ–æ•°ç»„ï¼šåªåœ¨æŒ‚è½½æ—¶æ‰§è¡Œä¸€æ¬¡
useEffect(() => {
  console.log('åªåœ¨æŒ‚è½½æ—¶æ‰§è¡Œ');
}, []);

// 3. æœ‰ä¾èµ–ï¼šä¾èµ–å˜åŒ–æ—¶æ‰§è¡Œ
useEffect(() => {
  console.log('ä¾èµ–å˜åŒ–æ—¶æ‰§è¡Œ');
}, [dependency]);
```

#### Q10: ä¸ºä»€ä¹ˆuseStateçš„æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
useStateçš„æ›´æ–°æ˜¯**å¼‚æ­¥æ‰¹å¤„ç†**çš„ï¼Œä¸»è¦åŸå› ï¼š

**1. æ€§èƒ½ä¼˜åŒ–**ï¼šé¿å…é¢‘ç¹çš„DOMæ›´æ–°
**2. çŠ¶æ€ä¸€è‡´æ€§**ï¼šç¡®ä¿ç»„ä»¶çŠ¶æ€çš„ä¸€è‡´æ€§
**3. æ‰¹é‡å¤„ç†**ï¼šReactä¼šå°†å¤šä¸ªsetStateè°ƒç”¨æ‰¹å¤„ç†ä¸ºä¸€æ¬¡æ›´æ–°

```javascript
const [count, setCount] = useState(0);

const handleClick = () => {
  setCount(count + 1); // å¼‚æ­¥æ›´æ–°
  console.log(count); // ä»ç„¶æ˜¯æ—§å€¼
  
  // è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å‡½æ•°å¼æ›´æ–°
  setCount(prev => prev + 1);
};
```

### 10.4 æ€§èƒ½ä¼˜åŒ–ç±»

#### Q11: Reactä¸­æœ‰å“ªäº›æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
Reactæ€§èƒ½ä¼˜åŒ–ä¸»è¦åŒ…æ‹¬ï¼š

**1. é¿å…ä¸å¿…è¦çš„æ¸²æŸ“**ï¼š
```javascript
// React.memo
const ExpensiveComponent = React.memo(({ data }) => {
  return <div>{data.name}</div>;
});
```

**2. useMemoä¼˜åŒ–è®¡ç®—**ï¼š
```javascript
const ExpensiveCalculation = ({ items }) => {
  const total = useMemo(() => {
    return items.reduce((sum, item) => sum + item.price, 0);
  }, [items]);
  
  return <div>Total: {total}</div>;
};
```

**3. useCallbackä¼˜åŒ–å‡½æ•°**ï¼š
```javascript
const Parent = ({ items }) => {
  const handleClick = useCallback((id) => {
    console.log('Item clicked:', id);
  }, []);
  
  return <ItemList items={items} onItemClick={handleClick} />;
};
```

**4. ä»£ç åˆ†å‰²ä¸æ‡’åŠ è½½**ï¼š
```javascript
const LazyComponent = lazy(() => import('./LazyComponent'));

const App = () => (
  <Suspense fallback={<div>Loading...</div>}>
    <LazyComponent />
  </Suspense>
);
```

#### Q12: ä»€ä¹ˆæ˜¯React Fiberï¼Ÿå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
**React Fiber**æ˜¯React 16å¼•å…¥çš„æ–°çš„åè°ƒå¼•æ“ã€‚

**è§£å†³çš„é—®é¢˜**ï¼š
1. **é•¿æ—¶é—´é˜»å¡**ï¼šæ—§ç‰ˆæœ¬çš„é€’å½’æ›´æ–°ä¼šé˜»å¡ä¸»çº¿ç¨‹
2. **ä¼˜å…ˆçº§è°ƒåº¦**ï¼šæ— æ³•ä¸­æ–­ä½ä¼˜å…ˆçº§ä»»åŠ¡æ¥å¤„ç†é«˜ä¼˜å…ˆçº§ä»»åŠ¡
3. **ç”¨æˆ·ä½“éªŒ**ï¼šç•Œé¢å¡é¡¿ï¼Œç”¨æˆ·äº¤äº’å“åº”æ…¢

**Fiberçš„ç‰¹æ€§**ï¼š
- **å¯ä¸­æ–­**ï¼šé•¿ä»»åŠ¡å¯ä»¥è¢«é«˜ä¼˜å…ˆçº§ä»»åŠ¡ä¸­æ–­
- **å¯æ¢å¤**ï¼šè¢«ä¸­æ–­çš„ä»»åŠ¡å¯ä»¥åœ¨ç©ºé—²æ—¶é—´ç»§ç»­
- **ä¼˜å…ˆçº§**ï¼šç”¨æˆ·äº¤äº’ä¼˜å…ˆäºæ•°æ®æ›´æ–°
- **å¹¶å‘**ï¼šå¯ä»¥åŒæ—¶å‡†å¤‡å¤šä¸ªçŠ¶æ€ç‰ˆæœ¬

### 10.5 å®æˆ˜åº”ç”¨ç±»

#### Q13: å¦‚ä½•åœ¨Reactä¸­å®ç°çŠ¶æ€ç®¡ç†ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
Reactä¸­æœ‰å¤šç§çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼š

**1. æœ¬åœ°çŠ¶æ€ï¼ˆuseStateï¼‰**ï¼š
```javascript
const Counter = () => {
  const [count, setCount] = useState(0);
  return <div>Count: {count}</div>;
};
```

**2. Context API**ï¼š
```javascript
const ThemeContext = createContext();

const App = () => {
  const [theme, setTheme] = useState('light');
  
  return (
    <ThemeContext.Provider value={{ theme, setTheme }}>
      <Header />
      <Main />
    </ThemeContext.Provider>
  );
};
```

**3. useReducerå¤æ‚çŠ¶æ€**ï¼š
```javascript
const reducer = (state, action) => {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 };
    default:
      return state;
  }
};

const Counter = () => {
  const [state, dispatch] = useReducer(reducer, { count: 0 });
  return <div>Count: {state.count}</div>;
};
```

#### Q14: å¦‚ä½•å¤„ç†Reactä¸­çš„é”™è¯¯è¾¹ç•Œï¼Ÿ

**ç­”æ¡ˆ**ï¼š
**é”™è¯¯è¾¹ç•Œ(Error Boundaries)**æ˜¯Reactç»„ä»¶ï¼Œå®ƒå¯ä»¥æ•è·å…¶å­ç»„ä»¶æ ‘ä¸­çš„é”™è¯¯ã€‚

```javascript
class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false };
  }
  
  static getDerivedStateFromError(error) {
    return { hasError: true };
  }
  
  componentDidCatch(error, errorInfo) {
    console.error('Error caught:', error, errorInfo);
  }
  
  render() {
    if (this.state.hasError) {
      return <h1>Something went wrong.</h1>;
    }
    
    return this.props.children;
  }
}

// ä½¿ç”¨é”™è¯¯è¾¹ç•Œ
const App = () => (
  <ErrorBoundary>
    <MyComponent />
  </ErrorBoundary>
);
```

#### Q15: Reactä¸­å¦‚ä½•å®ç°æ¡ä»¶æ¸²æŸ“ï¼Ÿ

**ç­”æ¡ˆ**ï¼š
Reactä¸­æœ‰å¤šç§æ¡ä»¶æ¸²æŸ“æ–¹å¼ï¼š

**1. ä¸‰å…ƒè¿ç®—ç¬¦**ï¼š
```javascript
const MyComponent = ({ isLoggedIn }) => (
  <div>
    {isLoggedIn ? <UserDashboard /> : <LoginForm />}
  </div>
);
```

**2. é€»è¾‘ä¸è¿ç®—ç¬¦**ï¼š
```javascript
const Notification = ({ message }) => (
  <div>
    {message && <div className="alert">{message}</div>}
  </div>
);
```

**3. ifè¯­å¥**ï¼š
```javascript
const MyComponent = ({ user }) => {
  if (!user) {
    return <div>Loading...</div>;
  }
  
  if (user.role === 'admin') {
    return <AdminPanel />;
  }
  
  return <UserPanel user={user} />;
};
```

**4. switchè¯­å¥**ï¼š
```javascript
const StatusIndicator = ({ status }) => {
  switch (status) {
    case 'loading':
      return <Spinner />;
    case 'error':
      return <ErrorMessage />;
    case 'success':
      return <SuccessMessage />;
    default:
      return null;
  }
};
```

---

## ğŸ“š æ€»ç»“

è¿™ä»½ReactæŠ€æœ¯æŒ‡å—æ¶µç›–äº†ï¼š

### ğŸ¯ æ ¸å¿ƒå†…å®¹
1. **åŸºç¡€æ¦‚å¿µ**ï¼šè™šæ‹ŸDOMã€ç»„ä»¶åŒ–ã€JSXç­‰æ ¸å¿ƒç†å¿µ
2. **ç»„ä»¶å¼€å‘**ï¼šå‡½æ•°ç»„ä»¶ã€ç±»ç»„ä»¶ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†
3. **Hooksæ·±å…¥**ï¼šuseStateã€useEffectã€è‡ªå®šä¹‰Hooksç­‰
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šReact.memoã€useMemoã€ä»£ç åˆ†å‰²ç­‰
5. **å®æˆ˜åº”ç”¨**ï¼šçŠ¶æ€ç®¡ç†ã€é”™è¯¯å¤„ç†ã€æ¡ä»¶æ¸²æŸ“
6. **é¢è¯•å‡†å¤‡**ï¼š15é“é«˜é¢‘é¢è¯•é¢˜è¯¦è§£

### âœ… æŠ€æœ¯ç‰¹è‰²
- **å›¾æ–‡å¹¶èŒ‚**ï¼š13ä¸ªMermaidæµç¨‹å›¾è§£é‡Šæ ¸å¿ƒæ¦‚å¿µ
- **ä»£ç ä¸°å¯Œ**ï¼šå®Œæ•´å¯è¿è¡Œçš„ç¤ºä¾‹ä»£ç 
- **å®æˆ˜å¯¼å‘**ï¼šçœŸå®é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯
- **é¢è¯•å‹å¥½**ï¼šæ ‡å‡†ç­”æ¡ˆå¯ç›´æ¥ç”¨äºé¢è¯•

è¿™ä»½æŒ‡å—é€‚åˆä»åˆå­¦è€…åˆ°é«˜çº§å¼€å‘è€…çš„å„ä¸ªå±‚æ¬¡ï¼Œæ˜¯å­¦ä¹ å’ŒæŒæ¡ReactæŠ€æœ¯çš„å®Œæ•´å‚è€ƒèµ„æ–™ã€‚
