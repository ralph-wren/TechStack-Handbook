# SpringBoot æ ¸å¿ƒçŸ¥è¯†ä½“ç³»

## ç›®å½•
- [SpringBoot æ ¸å¿ƒçŸ¥è¯†ä½“ç³»](#springboot-æ ¸å¿ƒçŸ¥è¯†ä½“ç³»)
  - [ç›®å½•](#ç›®å½•)
  - [SpringBootåŸºç¡€æ¦‚å¿µ](#springbootåŸºç¡€æ¦‚å¿µ)
    - [SpringBootç®€ä»‹](#springbootç®€ä»‹)
      - [SpringBootæ ¸å¿ƒç†å¿µ](#springbootæ ¸å¿ƒç†å¿µ)
      - [SpringBootä¼˜åŠ¿](#springbootä¼˜åŠ¿)
    - [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
      - [èµ·æ­¥ä¾èµ–ï¼ˆStarter Dependenciesï¼‰](#èµ·æ­¥ä¾èµ–starter-dependencies)
      - [å¸¸ç”¨Starterå¯¹æ¯”è¡¨](#å¸¸ç”¨starterå¯¹æ¯”è¡¨)
    - [ç‰ˆæœ¬æ¼”è¿›](#ç‰ˆæœ¬æ¼”è¿›)
      - [SpringBootç‰ˆæœ¬å†å²](#springbootç‰ˆæœ¬å†å²)
      - [ç‰ˆæœ¬é€‰æ‹©å»ºè®®](#ç‰ˆæœ¬é€‰æ‹©å»ºè®®)
    - [ä¸Spring Frameworkå…³ç³»](#ä¸spring-frameworkå…³ç³»)
      - [æ¶æ„å…³ç³»å›¾](#æ¶æ„å…³ç³»å›¾)
      - [å…³ç³»è¯´æ˜](#å…³ç³»è¯´æ˜)
  - [å¿«é€Ÿå…¥é—¨](#å¿«é€Ÿå…¥é—¨)
    - [ç¯å¢ƒæ­å»º](#ç¯å¢ƒæ­å»º)
      - [å¼€å‘ç¯å¢ƒè¦æ±‚](#å¼€å‘ç¯å¢ƒè¦æ±‚)
      - [Mavené…ç½®](#mavené…ç½®)
    - [åˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨](#åˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨)
      - [ä¸»å¯åŠ¨ç±»](#ä¸»å¯åŠ¨ç±»)
      - [ç¬¬ä¸€ä¸ªController](#ç¬¬ä¸€ä¸ªcontroller)
      - [è¿è¡Œåº”ç”¨](#è¿è¡Œåº”ç”¨)
    - [é¡¹ç›®ç»“æ„è¯¦è§£](#é¡¹ç›®ç»“æ„è¯¦è§£)
      - [æ ‡å‡†é¡¹ç›®ç»“æ„](#æ ‡å‡†é¡¹ç›®ç»“æ„)
      - [åŒ…ç»“æ„æœ€ä½³å®è·µ](#åŒ…ç»“æ„æœ€ä½³å®è·µ)
    - [é…ç½®æ–‡ä»¶è¯¦è§£](#é…ç½®æ–‡ä»¶è¯¦è§£)
      - [application.ymlé…ç½®](#applicationymlé…ç½®)
      - [å¤šç¯å¢ƒé…ç½®](#å¤šç¯å¢ƒé…ç½®)
  - [è‡ªåŠ¨é…ç½®æœºåˆ¶](#è‡ªåŠ¨é…ç½®æœºåˆ¶)
      - [æ¡ä»¶æ³¨è§£](#æ¡ä»¶æ³¨è§£)
      - [é…ç½®å±æ€§](#é…ç½®å±æ€§)
    - [æ³¨è§£ä½“ç³»](#æ³¨è§£ä½“ç³»)
      - [æ ¸å¿ƒæ³¨è§£](#æ ¸å¿ƒæ³¨è§£)
    - [Webå¼€å‘](#webå¼€å‘)
      - [RESTæ¥å£](#restæ¥å£)
      - [å¼‚å¸¸å¤„ç†](#å¼‚å¸¸å¤„ç†)
    - [æ•°æ®è®¿é—®](#æ•°æ®è®¿é—®)
      - [JPAé…ç½®](#jpaé…ç½®)
      - [äº‹åŠ¡ç®¡ç†](#äº‹åŠ¡ç®¡ç†)
    - [å®‰å…¨æ¡†æ¶](#å®‰å…¨æ¡†æ¶)
      - [Spring Securityé…ç½®](#spring-securityé…ç½®)
      - [JWTæ”¯æŒ](#jwtæ”¯æŒ)
    - [å¾®æœåŠ¡](#å¾®æœåŠ¡)
      - [æœåŠ¡æ³¨å†Œ](#æœåŠ¡æ³¨å†Œ)
      - [ç†”æ–­é™çº§](#ç†”æ–­é™çº§)
    - [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
      - [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
      - [é…ç½®æœ€ä½³å®è·µ](#é…ç½®æœ€ä½³å®è·µ)
  - [å¯åŠ¨æµç¨‹ä¸åŸç†](#å¯åŠ¨æµç¨‹ä¸åŸç†)
    - [å¯åŠ¨æµç¨‹è¯¦è§£](#å¯åŠ¨æµç¨‹è¯¦è§£)
    - [è‡ªåŠ¨é…ç½®åŸç†](#è‡ªåŠ¨é…ç½®åŸç†)
    - [æ¡ä»¶æ³¨è§£è¯¦è§£](#æ¡ä»¶æ³¨è§£è¯¦è§£)
      - [è‡ªå®šä¹‰æ¡ä»¶æ³¨è§£](#è‡ªå®šä¹‰æ¡ä»¶æ³¨è§£)
    - [è‡ªå®šä¹‰è‡ªåŠ¨é…ç½®](#è‡ªå®šä¹‰è‡ªåŠ¨é…ç½®)
      - [è‡ªå®šä¹‰Starterå¼€å‘](#è‡ªå®šä¹‰starterå¼€å‘)
      - [META-INF/spring.factoriesé…ç½®](#meta-infspringfactoriesé…ç½®)
    - [é…ç½®å±æ€§ç»‘å®š](#é…ç½®å±æ€§ç»‘å®š)
      - [é…ç½®å±æ€§ç»‘å®šç¤ºä¾‹](#é…ç½®å±æ€§ç»‘å®šç¤ºä¾‹)
      - [é…ç½®å±æ€§ä½¿ç”¨](#é…ç½®å±æ€§ä½¿ç”¨)
  - [å¸¸è§é¢è¯•é¢˜](#å¸¸è§é¢è¯•é¢˜)
    - [åŸºç¡€æ¦‚å¿µé¢è¯•é¢˜](#åŸºç¡€æ¦‚å¿µé¢è¯•é¢˜)
    - [è‡ªåŠ¨é…ç½®é¢è¯•é¢˜](#è‡ªåŠ¨é…ç½®é¢è¯•é¢˜)
    - [Webå¼€å‘é¢è¯•é¢˜](#webå¼€å‘é¢è¯•é¢˜)
  - [æµ‹è¯•æ¡†æ¶](#æµ‹è¯•æ¡†æ¶)
    - [å•å…ƒæµ‹è¯•](#å•å…ƒæµ‹è¯•)
    - [é›†æˆæµ‹è¯•](#é›†æˆæµ‹è¯•)
    - [åˆ‡ç‰‡æµ‹è¯•](#åˆ‡ç‰‡æµ‹è¯•)
  - [é«˜çº§ç‰¹æ€§](#é«˜çº§ç‰¹æ€§)
    - [ç¼“å­˜æœºåˆ¶](#ç¼“å­˜æœºåˆ¶)
    - [å¼‚æ­¥å¤„ç†](#å¼‚æ­¥å¤„ç†)
    - [äº‹ä»¶æœºåˆ¶](#äº‹ä»¶æœºåˆ¶)
    - [ç›‘æ§ä¸ç®¡ç†](#ç›‘æ§ä¸ç®¡ç†)
      - [Dockerfileç¤ºä¾‹](#dockerfileç¤ºä¾‹)
      - [Docker Composeç¤ºä¾‹](#docker-composeç¤ºä¾‹)
      - [ç”Ÿäº§çº§Dockerfile](#ç”Ÿäº§çº§dockerfile)
      - [Kuberneteséƒ¨ç½²é…ç½®](#kuberneteséƒ¨ç½²é…ç½®)
      - [CI/CD Pipelineé…ç½®](#cicd-pipelineé…ç½®)
      - [ç›‘æ§å’Œæ—¥å¿—é…ç½®](#ç›‘æ§å’Œæ—¥å¿—é…ç½®)
      - [è¿ç»´è„šæœ¬](#è¿ç»´è„šæœ¬)
  - [å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
    - [é…ç½®é—®é¢˜](#é…ç½®é—®é¢˜)
    - [ä¾èµ–é—®é¢˜](#ä¾èµ–é—®é¢˜)
    - [æ€§èƒ½é—®é¢˜](#æ€§èƒ½é—®é¢˜)
    - [å®‰å…¨é—®é¢˜](#å®‰å…¨é—®é¢˜)
    - [éƒ¨ç½²é—®é¢˜](#éƒ¨ç½²é—®é¢˜)
  - [å‚è€ƒèµ„æº](#å‚è€ƒèµ„æº)
    - [å®˜æ–¹æ–‡æ¡£](#å®˜æ–¹æ–‡æ¡£)
    - [ç¤¾åŒºèµ„æº](#ç¤¾åŒºèµ„æº)
    - [ä¹¦ç±æ¨è](#ä¹¦ç±æ¨è)
      - [å…¥é—¨çº§ä¹¦ç±](#å…¥é—¨çº§ä¹¦ç±)
      - [è¿›é˜¶çº§ä¹¦ç±](#è¿›é˜¶çº§ä¹¦ç±)
      - [æºç åˆ†æä¹¦ç±](#æºç åˆ†æä¹¦ç±)
    - [å­¦ä¹ è·¯å¾„å»ºè®®](#å­¦ä¹ è·¯å¾„å»ºè®®)
    - [å®è·µé¡¹ç›®æ¨è](#å®è·µé¡¹ç›®æ¨è)
      - [åˆçº§é¡¹ç›®](#åˆçº§é¡¹ç›®)
      - [ä¸­çº§é¡¹ç›®](#ä¸­çº§é¡¹ç›®)
      - [é«˜çº§é¡¹ç›®](#é«˜çº§é¡¹ç›®)
    - [è®¤è¯è€ƒè¯•](#è®¤è¯è€ƒè¯•)
    - [æŠ€æœ¯ç¤¾åŒº](#æŠ€æœ¯ç¤¾åŒº)
    - [æŒç»­å­¦ä¹ å»ºè®®](#æŒç»­å­¦ä¹ å»ºè®®)
  - [æ–‡æ¡£æ€»ç»“](#æ–‡æ¡£æ€»ç»“)
    - [ğŸ“š çŸ¥è¯†è¦†ç›–èŒƒå›´](#-çŸ¥è¯†è¦†ç›–èŒƒå›´)
    - [ğŸ¯ æ–‡æ¡£ç‰¹è‰²](#-æ–‡æ¡£ç‰¹è‰²)
    - [ğŸš€ ä½¿ç”¨å»ºè®®](#-ä½¿ç”¨å»ºè®®)
    - [ğŸ“ˆ æŒç»­æ›´æ–°](#-æŒç»­æ›´æ–°)

## SpringBootåŸºç¡€æ¦‚å¿µ

### SpringBootç®€ä»‹

**SpringBoot**æ˜¯ç”±Pivotalå›¢é˜Ÿæä¾›çš„å…¨æ–°æ¡†æ¶ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯ç”¨æ¥**ç®€åŒ–Springåº”ç”¨çš„åˆå§‹æ­å»ºä»¥åŠå¼€å‘è¿‡ç¨‹**ã€‚SpringBooté‡‡ç”¨äº†**çº¦å®šä¼˜äºé…ç½®**çš„ç†å¿µï¼Œå¤§é‡çš„è‡ªåŠ¨é…ç½®å‡å°‘äº†å¼€å‘äººå‘˜çš„å·¥ä½œé‡ã€‚

#### SpringBootæ ¸å¿ƒç†å¿µ

```mermaid
graph TD
    A[SpringBootæ ¸å¿ƒç†å¿µ] --> B[çº¦å®šä¼˜äºé…ç½®]
    A --> C[å¼€ç®±å³ç”¨]
    A --> D[ç‹¬ç«‹è¿è¡Œ]
    A --> E[ç”Ÿäº§å°±ç»ª]
    
    B --> B1[é»˜è®¤é…ç½®]
    B --> B2[æ ‡å‡†ç›®å½•ç»“æ„]
    B --> B3[å‘½åè§„èŒƒ]
    
    C --> C1[è‡ªåŠ¨é…ç½®]
    C --> C2[èµ·æ­¥ä¾èµ–]
    C --> C3[å†…åµŒæœåŠ¡å™¨]
    
    D --> D1[å¯æ‰§è¡ŒJAR]
    D --> D2[æ— éœ€å¤–éƒ¨å®¹å™¨]
    D --> D3[java -jarå¯åŠ¨]
    
    E --> E1[å¥åº·æ£€æŸ¥]
    E --> E2[æŒ‡æ ‡ç›‘æ§]
    E --> E3[å¤–éƒ¨åŒ–é…ç½®]
```

#### SpringBootä¼˜åŠ¿

| ç‰¹æ€§ | ä¼ ç»ŸSpring | SpringBoot |
|------|------------|------------|
| é…ç½®å¤æ‚åº¦ | å¤§é‡XMLé…ç½® | æœ€å°‘é…ç½® |
| ä¾èµ–ç®¡ç† | æ‰‹åŠ¨ç®¡ç†ç‰ˆæœ¬ | è‡ªåŠ¨ç‰ˆæœ¬ç®¡ç† |
| æœåŠ¡å™¨éƒ¨ç½² | éœ€è¦å¤–éƒ¨å®¹å™¨ | å†…åµŒæœåŠ¡å™¨ |
| å¯åŠ¨æ–¹å¼ | å¤æ‚éƒ¨ç½²æµç¨‹ | java -jarå¯åŠ¨ |
| ç›‘æ§è¿ç»´ | éœ€è¦é¢å¤–é…ç½® | å†…ç½®Actuator |

### æ ¸å¿ƒç‰¹æ€§

SpringBootçš„æ ¸å¿ƒåŠŸèƒ½ç»“æ„ï¼š

```mermaid
graph TD
    A[SpringBootæ ¸å¿ƒåŠŸèƒ½] --> B[è‡ªåŠ¨é…ç½®]
    A --> C[èµ·æ­¥ä¾èµ–]
    A --> D[Actuatorç›‘æ§]
    A --> E[å¤–éƒ¨åŒ–é…ç½®]
    
    B --> B1[æ¡ä»¶æ³¨è§£]
    B --> B2[é…ç½®ç±»]
    B --> B3[è‡ªåŠ¨é…ç½®ç±»]
    
    C --> C1[ä¾èµ–ç®¡ç†]
    C --> C2[ç‰ˆæœ¬ç®¡ç†]
    
    D --> D1[å¥åº·æ£€æŸ¥]
    D --> D2[åº¦é‡æŒ‡æ ‡]
    D --> D3[è¿è¡Œä¿¡æ¯]
    
    E --> E1[é…ç½®æ–‡ä»¶]
    E --> E2[ç¯å¢ƒå˜é‡]
    E --> E3[å‘½ä»¤è¡Œå‚æ•°]
```

#### èµ·æ­¥ä¾èµ–ï¼ˆStarter Dependenciesï¼‰

```xml
<!-- Webå¼€å‘èµ·æ­¥ä¾èµ– -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>

<!-- æ•°æ®è®¿é—®èµ·æ­¥ä¾èµ– -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-jpa</artifactId>
</dependency>

<!-- å®‰å…¨æ¡†æ¶èµ·æ­¥ä¾èµ– -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-security</artifactId>
</dependency>

<!-- æµ‹è¯•èµ·æ­¥ä¾èµ– -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-test</artifactId>
    <scope>test</scope>
</dependency>
```

#### å¸¸ç”¨Starterå¯¹æ¯”è¡¨

| Starter | åŠŸèƒ½ | ä¸»è¦ä¾èµ– | é€‚ç”¨åœºæ™¯ |
|---------|------|----------|----------|
| spring-boot-starter-web | Webå¼€å‘ | Spring MVC, Tomcat | REST API, Webåº”ç”¨ |
| spring-boot-starter-data-jpa | JPAæ•°æ®è®¿é—® | Hibernate, Spring Data JPA | å…³ç³»å‹æ•°æ®åº“æ“ä½œ |
| spring-boot-starter-data-redis | Redisç¼“å­˜ | Lettuce, Spring Data Redis | ç¼“å­˜ã€ä¼šè¯å­˜å‚¨ |
| spring-boot-starter-security | å®‰å…¨æ¡†æ¶ | Spring Security | è®¤è¯æˆæƒ |
| spring-boot-starter-actuator | ç›‘æ§ç®¡ç† | Micrometer, Actuator | ç”Ÿäº§ç›‘æ§ |
| spring-boot-starter-test | æµ‹è¯•æ¡†æ¶ | JUnit, Mockito, AssertJ | å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯• |

### ç‰ˆæœ¬æ¼”è¿›

#### SpringBootç‰ˆæœ¬å†å²

```mermaid
timeline
    title SpringBootç‰ˆæœ¬æ¼”è¿›
    
    2014 : SpringBoot 1.0
         : é¦–ä¸ªæ­£å¼ç‰ˆæœ¬
         : åŸºäºSpring 4.0
    
    2016 : SpringBoot 1.4
         : æµ‹è¯•æ”¹è¿›
         : é…ç½®å¤„ç†å¢å¼º
    
    2018 : SpringBoot 2.0
         : åŸºäºSpring 5.0
         : å“åº”å¼ç¼–ç¨‹æ”¯æŒ
         : Java 8åŸºçº¿
    
    2019 : SpringBoot 2.2
         : Java 13æ”¯æŒ
         : æ€§èƒ½æ”¹è¿›
    
    2021 : SpringBoot 2.5
         : Java 16æ”¯æŒ
         : Dockeré•œåƒæ„å»º
    
    2022 : SpringBoot 2.7
         : æœ€åçš„2.xç‰ˆæœ¬
         : Java 18æ”¯æŒ
    
    2022 : SpringBoot 3.0
         : åŸºäºSpring 6.0
         : Java 17åŸºçº¿
         : åŸç”Ÿé•œåƒæ”¯æŒ
    
    2023 : SpringBoot 3.1
         : Java 20æ”¯æŒ
         : è™šæ‹Ÿçº¿ç¨‹æ”¯æŒ
```

#### ç‰ˆæœ¬é€‰æ‹©å»ºè®®

```java
/**
 * SpringBootç‰ˆæœ¬é€‰æ‹©æŒ‡å—
 */
public class VersionSelectionGuide {
    
    /**
     * ç”Ÿäº§ç¯å¢ƒç‰ˆæœ¬é€‰æ‹©
     */
    public void productionVersionSelection() {
        // æ¨èä½¿ç”¨LTSç‰ˆæœ¬
        // SpringBoot 2.7.x (Java 8+)
        // SpringBoot 3.0.x (Java 17+)
        
        // è€ƒè™‘å› ç´ ï¼š
        // 1. Javaç‰ˆæœ¬å…¼å®¹æ€§
        // 2. ç¬¬ä¸‰æ–¹åº“æ”¯æŒ
        // 3. å›¢é˜ŸæŠ€æœ¯æ ˆ
        // 4. è¿ç§»æˆæœ¬
    }
    
    /**
     * æ–°é¡¹ç›®ç‰ˆæœ¬é€‰æ‹©
     */
    public void newProjectVersionSelection() {
        // å»ºè®®ä½¿ç”¨æœ€æ–°ç¨³å®šç‰ˆæœ¬
        // SpringBoot 3.1.x (æ¨è)
        
        // ä¼˜åŠ¿ï¼š
        // 1. æœ€æ–°ç‰¹æ€§æ”¯æŒ
        // 2. æ›´å¥½çš„æ€§èƒ½
        // 3. å®‰å…¨æ›´æ–°
        // 4. é•¿æœŸæ”¯æŒ
    }
}
```

### ä¸Spring Frameworkå…³ç³»

#### æ¶æ„å…³ç³»å›¾

```mermaid
graph TD
    A[SpringBootåº”ç”¨] --> B[SpringBoot Framework]
    B --> C[Spring Framework]
    C --> D[Spring Core]
    C --> E[Spring MVC]
    C --> F[Spring Data]
    C --> G[Spring Security]
    
    B --> H[è‡ªåŠ¨é…ç½®]
    B --> I[èµ·æ­¥ä¾èµ–]
    B --> J[Actuator]
    
    D --> D1[IoCå®¹å™¨]
    D --> D2[AOP]
    D --> D3[äº‹ä»¶æœºåˆ¶]
    
    E --> E1[DispatcherServlet]
    E --> E2[HandlerMapping]
    E --> E3[ViewResolver]
```

#### å…³ç³»è¯´æ˜

```java
/**
 * SpringBootä¸Spring Frameworkå…³ç³»
 */
public class SpringRelationship {
    
    /**
     * SpringBootæ˜¯Spring Frameworkçš„æ‰©å±•
     */
    public void springBootExtension() {
        // SpringBoot = Spring Framework + è‡ªåŠ¨é…ç½® + èµ·æ­¥ä¾èµ– + å†…åµŒæœåŠ¡å™¨
        
        // 1. åŸºäºSpring Framework
        // 2. ç®€åŒ–é…ç½®è¿‡ç¨‹
        // 3. æä¾›ç”Ÿäº§å°±ç»ªç‰¹æ€§
        // 4. çº¦å®šä¼˜äºé…ç½®
    }
    
    /**
     * æ ¸å¿ƒç»„ä»¶å…³ç³»
     */
    public void coreComponentRelation() {
        // ApplicationContext (Spring Framework)
        // â†“
        // SpringApplication (SpringBoot)
        // â†“
        // è‡ªåŠ¨é…ç½® + èµ·æ­¥ä¾èµ–
        // â†“
        // å®Œæ•´çš„åº”ç”¨ç¨‹åº
    }
}
```

## å¿«é€Ÿå…¥é—¨

### ç¯å¢ƒæ­å»º

#### å¼€å‘ç¯å¢ƒè¦æ±‚

| ç»„ä»¶ | ç‰ˆæœ¬è¦æ±‚ | æ¨èç‰ˆæœ¬ | è¯´æ˜ |
|------|----------|----------|------|
| JDK | 8+ (SpringBoot 2.x), 17+ (SpringBoot 3.x) | JDK 17 | é•¿æœŸæ”¯æŒç‰ˆæœ¬ |
| Maven | 3.6.3+ | 3.9.x | æ„å»ºå·¥å…· |
| Gradle | 7.5+ | 8.x | å¯é€‰æ„å»ºå·¥å…· |
| IDE | ä»»æ„ | IntelliJ IDEA | æ¨èå¼€å‘å·¥å…· |

#### Mavené…ç½®

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    
    <!-- ç»§æ‰¿SpringBootçˆ¶é¡¹ç›® -->
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.1.5</version>
        <relativePath/>
    </parent>
    
    <groupId>com.example</groupId>
    <artifactId>demo</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>demo</name>
    <description>Demo project for Spring Boot</description>
    
    <properties>
        <java.version>17</java.version>
    </properties>
    
    <dependencies>
        <!-- Webèµ·æ­¥ä¾èµ– -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        
        <!-- æµ‹è¯•èµ·æ­¥ä¾èµ– -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>
    
    <build>
        <plugins>
            <!-- SpringBoot Mavenæ’ä»¶ -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>
</project>
```

### åˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨

#### ä¸»å¯åŠ¨ç±»

```java
/**
 * SpringBootåº”ç”¨ä¸»å¯åŠ¨ç±»
 * @SpringBootApplication æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼ŒåŒ…å«ï¼š
 * - @SpringBootConfigurationï¼šæ ‡è¯†é…ç½®ç±»
 * - @EnableAutoConfigurationï¼šå¯ç”¨è‡ªåŠ¨é…ç½®
 * - @ComponentScanï¼šç»„ä»¶æ‰«æ
 */
@SpringBootApplication
public class DemoApplication {
    
    public static void main(String[] args) {
        // å¯åŠ¨SpringBootåº”ç”¨
        SpringApplication.run(DemoApplication.class, args);
    }
    
    /**
     * è‡ªå®šä¹‰SpringApplicationé…ç½®
     */
    public static void customSpringApplication(String[] args) {
        SpringApplication app = new SpringApplication(DemoApplication.class);
        
        // è®¾ç½®åº”ç”¨ç±»å‹
        app.setWebApplicationType(WebApplicationType.SERVLET);
        
        // è®¾ç½®Banneræ¨¡å¼
        app.setBannerMode(Banner.Mode.CONSOLE);
        
        // æ·»åŠ ç›‘å¬å™¨
        app.addListeners(new ApplicationStartedEventListener());
        
        // å¯åŠ¨åº”ç”¨
        app.run(args);
    }
}
```

#### ç¬¬ä¸€ä¸ªController

```java
/**
 * ç¬¬ä¸€ä¸ªRESTæ§åˆ¶å™¨
 */
@RestController
@RequestMapping("/api")
public class HelloController {
    
    /**
     * ç®€å•çš„GETè¯·æ±‚å¤„ç†
     */
    @GetMapping("/hello")
    public String hello() {
        return "Hello, SpringBoot!";
    }
    
    /**
     * å¸¦å‚æ•°çš„è¯·æ±‚å¤„ç†
     */
    @GetMapping("/hello/{name}")
    public Map<String, Object> helloWithName(@PathVariable String name) {
        Map<String, Object> result = new HashMap<>();
        result.put("message", "Hello, " + name + "!");
        result.put("timestamp", LocalDateTime.now());
        return result;
    }
    
    /**
     * POSTè¯·æ±‚å¤„ç†
     */
    @PostMapping("/hello")
    public ResponseEntity<String> createHello(@RequestBody Map<String, String> request) {
        String name = request.get("name");
        if (name == null || name.trim().isEmpty()) {
            return ResponseEntity.badRequest().body("Name is required");
        }
        
        return ResponseEntity.ok("Hello, " + name + "! Created successfully.");
    }
}
```

#### è¿è¡Œåº”ç”¨

```bash
# ä½¿ç”¨Mavenè¿è¡Œ
./mvnw spring-boot:run

# æˆ–è€…å…ˆæ‰“åŒ…å†è¿è¡Œ
./mvnw clean package
java -jar target/demo-0.0.1-SNAPSHOT.jar

# æŒ‡å®šç«¯å£è¿è¡Œ
java -jar target/demo-0.0.1-SNAPSHOT.jar --server.port=8081

# æŒ‡å®šé…ç½®æ–‡ä»¶
java -jar target/demo-0.0.1-SNAPSHOT.jar --spring.profiles.active=dev
```

### é¡¹ç›®ç»“æ„è¯¦è§£

#### æ ‡å‡†é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â””â”€â”€ com/
â”‚   â”‚       â””â”€â”€ example/
â”‚   â”‚           â””â”€â”€ demo/
â”‚   â”‚               â”œâ”€â”€ DemoApplication.java          # ä¸»å¯åŠ¨ç±»
â”‚   â”‚               â”œâ”€â”€ config/                       # é…ç½®ç±»
â”‚   â”‚               â”‚   â”œâ”€â”€ WebConfig.java
â”‚   â”‚               â”‚   â””â”€â”€ DatabaseConfig.java
â”‚   â”‚               â”œâ”€â”€ controller/                   # æ§åˆ¶å™¨å±‚
â”‚   â”‚               â”‚   â”œâ”€â”€ UserController.java
â”‚   â”‚               â”‚   â””â”€â”€ ProductController.java
â”‚   â”‚               â”œâ”€â”€ service/                      # æœåŠ¡å±‚
â”‚   â”‚               â”‚   â”œâ”€â”€ UserService.java
â”‚   â”‚               â”‚   â””â”€â”€ ProductService.java
â”‚   â”‚               â”œâ”€â”€ repository/                   # æ•°æ®è®¿é—®å±‚
â”‚   â”‚               â”‚   â”œâ”€â”€ UserRepository.java
â”‚   â”‚               â”‚   â””â”€â”€ ProductRepository.java
â”‚   â”‚               â”œâ”€â”€ model/                        # å®ä½“ç±»
â”‚   â”‚               â”‚   â”œâ”€â”€ User.java
â”‚   â”‚               â”‚   â””â”€â”€ Product.java
â”‚   â”‚               â”œâ”€â”€ dto/                          # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚               â”‚   â”œâ”€â”€ UserDTO.java
â”‚   â”‚               â”‚   â””â”€â”€ ProductDTO.java
â”‚   â”‚               â”œâ”€â”€ exception/                    # å¼‚å¸¸å¤„ç†
â”‚   â”‚               â”‚   â”œâ”€â”€ GlobalExceptionHandler.java
â”‚   â”‚               â”‚   â””â”€â”€ BusinessException.java
â”‚   â”‚               â””â”€â”€ util/                         # å·¥å…·ç±»
â”‚   â”‚                   â”œâ”€â”€ DateUtil.java
â”‚   â”‚                   â””â”€â”€ StringUtil.java
â”‚   â””â”€â”€ resources/
â”‚       â”œâ”€â”€ static/                                   # é™æ€èµ„æº
â”‚       â”‚   â”œâ”€â”€ css/
â”‚       â”‚   â”œâ”€â”€ js/
â”‚       â”‚   â””â”€â”€ images/
â”‚       â”œâ”€â”€ templates/                                # æ¨¡æ¿æ–‡ä»¶
â”‚       â”‚   â””â”€â”€ index.html
â”‚       â”œâ”€â”€ application.yml                           # ä¸»é…ç½®æ–‡ä»¶
â”‚       â”œâ”€â”€ application-dev.yml                       # å¼€å‘ç¯å¢ƒé…ç½®
â”‚       â”œâ”€â”€ application-prod.yml                      # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚       â””â”€â”€ logback-spring.xml                        # æ—¥å¿—é…ç½®
â””â”€â”€ test/
    â””â”€â”€ java/
        â””â”€â”€ com/
            â””â”€â”€ example/
                â””â”€â”€ demo/
                    â”œâ”€â”€ DemoApplicationTests.java      # åº”ç”¨æµ‹è¯•
                    â”œâ”€â”€ controller/                    # æ§åˆ¶å™¨æµ‹è¯•
                    â”œâ”€â”€ service/                       # æœåŠ¡æµ‹è¯•
                    â””â”€â”€ repository/                    # æ•°æ®è®¿é—®æµ‹è¯•
```

#### åŒ…ç»“æ„æœ€ä½³å®è·µ

```java
/**
 * åŒ…ç»“æ„è®¾è®¡åŸåˆ™
 */
public class PackageStructureGuide {
    
    /**
     * æŒ‰å±‚åˆ†åŒ…ï¼ˆæ¨èï¼‰
     */
    public void layerBasedPackaging() {
        // com.example.demo
        // â”œâ”€â”€ controller/     # æ§åˆ¶å™¨å±‚
        // â”œâ”€â”€ service/        # æœåŠ¡å±‚  
        // â”œâ”€â”€ repository/     # æ•°æ®è®¿é—®å±‚
        // â”œâ”€â”€ model/          # å®ä½“ç±»
        // â”œâ”€â”€ dto/            # æ•°æ®ä¼ è¾“å¯¹è±¡
        // â”œâ”€â”€ config/         # é…ç½®ç±»
        // â”œâ”€â”€ exception/      # å¼‚å¸¸å¤„ç†
        // â””â”€â”€ util/           # å·¥å…·ç±»
        
        // ä¼˜ç‚¹ï¼š
        // 1. ç»“æ„æ¸…æ™°
        // 2. èŒè´£åˆ†æ˜
        // 3. æ˜“äºç»´æŠ¤
    }
    
    /**
     * æŒ‰åŠŸèƒ½åˆ†åŒ…
     */
    public void featureBasedPackaging() {
        // com.example.demo
        // â”œâ”€â”€ user/           # ç”¨æˆ·æ¨¡å—
        // â”‚   â”œâ”€â”€ UserController.java
        // â”‚   â”œâ”€â”€ UserService.java
        // â”‚   â”œâ”€â”€ UserRepository.java
        // â”‚   â””â”€â”€ User.java
        // â”œâ”€â”€ product/        # äº§å“æ¨¡å—
        // â”‚   â”œâ”€â”€ ProductController.java
        // â”‚   â”œâ”€â”€ ProductService.java
        // â”‚   â”œâ”€â”€ ProductRepository.java
        // â”‚   â””â”€â”€ Product.java
        // â””â”€â”€ common/         # å…¬å…±æ¨¡å—
        
        // ä¼˜ç‚¹ï¼š
        // 1. é«˜å†…èš
        // 2. æ¨¡å—åŒ–
        // 3. ä¾¿äºå›¢é˜Ÿåä½œ
    }
}
```

### é…ç½®æ–‡ä»¶è¯¦è§£

#### application.ymlé…ç½®

```yaml
# æœåŠ¡å™¨é…ç½®
server:
  port: 8080
  servlet:
    context-path: /api
    encoding:
      charset: UTF-8
      enabled: true
  tomcat:
    uri-encoding: UTF-8
    max-threads: 200
    min-spare-threads: 10

# Springé…ç½®
spring:
  # åº”ç”¨é…ç½®
  application:
    name: demo-application
  
  # ç¯å¢ƒé…ç½®
  profiles:
    active: dev
  
  # æ•°æ®æºé…ç½®
  datasource:
    url: jdbc:mysql://localhost:3306/demo?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: ${MYSQL_PASSWORD:123456}
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
  
  # JPAé…ç½®
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL8Dialect
        format_sql: true
  
  # Redisé…ç½®
  redis:
    host: localhost
    port: 6379
    password: ${REDIS_PASSWORD:}
    database: 0
    lettuce:
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0
        max-wait: -1ms
  
  # ç¼“å­˜é…ç½®
  cache:
    type: redis
    redis:
      time-to-live: 600000
      cache-null-values: false
  
  # Jacksoné…ç½®
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss
    time-zone: Asia/Shanghai
    default-property-inclusion: non_null

# æ—¥å¿—é…ç½®
logging:
  level:
    root: INFO
    com.example.demo: DEBUG
    org.springframework.web: DEBUG
    org.hibernate.SQL: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/application.log
    max-size: 10MB
    max-history: 30

# Actuatoré…ç½®
management:
  endpoints:
    web:
      exposure:
        include: "*"
      base-path: /actuator
  endpoint:
    health:
      show-details: always
    info:
      enabled: true
  info:
    env:
      enabled: true
    java:
      enabled: true

# è‡ªå®šä¹‰é…ç½®
app:
  name: Demo Application
  version: 1.0.0
  description: SpringBootç¤ºä¾‹åº”ç”¨
  thread-pool:
    core-size: 5
    max-size: 10
    queue-capacity: 25
  jwt:
    secret: ${JWT_SECRET:mySecretKey}
    expiration: 86400000
```

#### å¤šç¯å¢ƒé…ç½®

```yaml
# application-dev.yml (å¼€å‘ç¯å¢ƒ)
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/demo_dev
    username: dev_user
    password: dev_password
  
  jpa:
    hibernate:
      ddl-auto: create-drop
    show-sql: true
  
  redis:
    host: localhost
    port: 6379

logging:
  level:
    root: DEBUG
    com.example.demo: TRACE

---
# application-prod.yml (ç”Ÿäº§ç¯å¢ƒ)
spring:
  datasource:
    url: jdbc:mysql://prod-db:3306/demo_prod
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
  
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
  
  redis:
    host: ${REDIS_HOST}
    port: ${REDIS_PORT}
    password: ${REDIS_PASSWORD}

logging:
  level:
    root: WARN
    com.example.demo: INFO
  file:
    name: /var/log/demo/application.log

management:
  endpoints:
    web:
      exposure:
        include: "health,info,metrics"
```

## è‡ªåŠ¨é…ç½®æœºåˆ¶

SpringBootçš„æ ¸å¿ƒåŠŸèƒ½ç»“æ„ï¼š

```mermaid
graph TD
    A[SpringBootæ ¸å¿ƒåŠŸèƒ½] --> B[è‡ªåŠ¨é…ç½®]
    A --> C[èµ·æ­¥ä¾èµ–]
    A --> D[Actuatorç›‘æ§]
    A --> E[å¤–éƒ¨åŒ–é…ç½®]
    
    B --> B1[æ¡ä»¶æ³¨è§£]
    B --> B2[é…ç½®ç±»]
    B --> B3[è‡ªåŠ¨é…ç½®ç±»]
    
    C --> C1[ä¾èµ–ç®¡ç†]
    C --> C2[ç‰ˆæœ¬ç®¡ç†]
    
    D --> D1[å¥åº·æ£€æŸ¥]
    D --> D2[åº¦é‡æŒ‡æ ‡]
    D --> D3[è¿è¡Œä¿¡æ¯]
    
    E --> E1[é…ç½®æ–‡ä»¶]
    E --> E2[ç¯å¢ƒå˜é‡]
    E --> E3[å‘½ä»¤è¡Œå‚æ•°]
```

#### æ¡ä»¶æ³¨è§£
```java
/**
 * æ¡ä»¶æ³¨è§£ä½¿ç”¨ç¤ºä¾‹
 */
@Configuration
public class CustomAutoConfiguration {
    
    @ConditionalOnClass(DataSource.class)
    @ConditionalOnMissingBean
    public DataSource dataSource() {
        // æ•°æ®æºé…ç½®
    }
    
    @ConditionalOnProperty(prefix = "custom", name = "enabled", havingValue = "true")
    @ConditionalOnBean(DataSource.class)
    public CustomService customService() {
        // è‡ªå®šä¹‰æœåŠ¡é…ç½®
    }
}
```

#### é…ç½®å±æ€§
```java
/**
 * é…ç½®å±æ€§ç»‘å®š
 */
@ConfigurationProperties(prefix = "app")
@Validated
public class AppProperties {
    @NotEmpty
    private String name;
    
    @Min(0)
    @Max(100)
    private int threadPool;
    
    // getter and setter
}
```

### æ³¨è§£ä½“ç³»

SpringBootæ³¨è§£ä½“ç³»ç»“æ„ï¼š

```mermaid
graph TD
    A[SpringBootæ³¨è§£ä½“ç³»] --> B[æ ¸å¿ƒæ³¨è§£]
    A --> C[é…ç½®ç›¸å…³æ³¨è§£]
    A --> D[Webç›¸å…³æ³¨è§£]
    A --> E[æ•°æ®è®¿é—®æ³¨è§£]
    A --> F[å®‰å…¨ç›¸å…³æ³¨è§£]
    
    B --> B1["@SpringBootApplication"]
    B --> B2["@ComponentScan"]
    B --> B3["@EnableAutoConfiguration"]
    
    C --> C1["@Configuration"]
    C --> C2["@ConfigurationProperties"]
    C --> C3["@Value"]
    
    D --> D1["@RestController"]
    D --> D2["@RequestMapping"]
    D --> D3["@ControllerAdvice"]
    
    E --> E1["@Repository"]
    E --> E2["@Entity"]
    E --> E3["@Transactional"]
    
    F --> F1["@Secured"]
    F --> F2["@PreAuthorize"]
    F --> F3["@RolesAllowed"]
```

#### æ ¸å¿ƒæ³¨è§£
```java
/**
 * SpringBootåº”ç”¨ä¸»ç±»
 */
@SpringBootApplication
public class Application {
    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}

/**
 * è‡ªå®šä¹‰é…ç½®ç±»
 */
@Configuration
@EnableConfigurationProperties(AppProperties.class)
public class CustomConfiguration {
    @Bean
    @ConditionalOnMissingBean
    public CustomService customService() {
        return new CustomService();
    }
}
```

### Webå¼€å‘

#### RESTæ¥å£
```java
/**
 * RESTfulæ¥å£ç¤ºä¾‹
 */
@RestController
@RequestMapping("/api")
public class UserController {
    
    @GetMapping("/users")
    public List<User> getUsers() {
        // è·å–ç”¨æˆ·åˆ—è¡¨
    }
    
    @PostMapping("/users")
    public ResponseEntity<User> createUser(@Valid @RequestBody User user) {
        // åˆ›å»ºç”¨æˆ·
    }
    
    @PutMapping("/users/{id}")
    public User updateUser(@PathVariable Long id, @RequestBody User user) {
        // æ›´æ–°ç”¨æˆ·
    }
    
    @DeleteMapping("/users/{id}")
    public void deleteUser(@PathVariable Long id) {
        // åˆ é™¤ç”¨æˆ·
    }
}
```

#### å¼‚å¸¸å¤„ç†
```java
/**
 * å…¨å±€å¼‚å¸¸å¤„ç†
 */
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleException(Exception ex) {
        // é€šç”¨å¼‚å¸¸å¤„ç†
    }
    
    @ExceptionHandler(ValidationException.class)
    public ResponseEntity<ErrorResponse> handleValidationException(ValidationException ex) {
        // å‚æ•°æ ¡éªŒå¼‚å¸¸å¤„ç†
    }
    
    @ExceptionHandler(BusinessException.class)
    public ResponseEntity<ErrorResponse> handleBusinessException(BusinessException ex) {
        // ä¸šåŠ¡å¼‚å¸¸å¤„ç†
    }
}
```

### æ•°æ®è®¿é—®

#### JPAé…ç½®
```java
/**
 * JPAå®ä½“ç±»
 */
@Entity
@Table(name = "users")
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false)
    private String username;
    
    @Column(nullable = false)
    private String password;
    
    @OneToMany(mappedBy = "user", cascade = CascadeType.ALL)
    private List<Order> orders;
}

/**
 * JPA Repository
 */
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    Optional<User> findByUsername(String username);
    
    @Query("SELECT u FROM User u WHERE u.username LIKE %:keyword%")
    List<User> searchUsers(@Param("keyword") String keyword);
}
```

#### äº‹åŠ¡ç®¡ç†
```java
/**
 * äº‹åŠ¡ç®¡ç†ç¤ºä¾‹
 */
@Service
@Transactional
public class UserService {
    
    @Transactional(readOnly = true)
    public User getUser(Long id) {
        // æŸ¥è¯¢ç”¨æˆ·
    }
    
    @Transactional(rollbackFor = Exception.class)
    public User createUser(User user) {
        // åˆ›å»ºç”¨æˆ·
    }
    
    @Transactional(propagation = Propagation.REQUIRES_NEW)
    public void updateUser(User user) {
        // æ›´æ–°ç”¨æˆ·
    }
}
```

### å®‰å…¨æ¡†æ¶

#### Spring Securityé…ç½®
```java
/**
 * å®‰å…¨é…ç½®
 */
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {
    
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests()
                .antMatchers("/api/public/**").permitAll()
                .antMatchers("/api/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
            .and()
            .formLogin()
            .and()
            .oauth2Login()
            .and()
            .csrf().disable();
    }
    
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}
```

#### JWTæ”¯æŒ
```java
/**
 * JWTå·¥å…·ç±»
 */
@Component
public class JwtTokenProvider {
    
    @Value("${jwt.secret}")
    private String jwtSecret;
    
    @Value("${jwt.expiration}")
    private long jwtExpiration;
    
    public String generateToken(Authentication authentication) {
        // ç”ŸæˆJWT token
    }
    
    public boolean validateToken(String token) {
        // éªŒè¯JWT token
    }
    
    public String getUsernameFromToken(String token) {
        // ä»JWT tokenä¸­è·å–ç”¨æˆ·å
    }
}
```

### å¾®æœåŠ¡

#### æœåŠ¡æ³¨å†Œ
```java
/**
 * æœåŠ¡æ³¨å†Œé…ç½®
 */
@SpringBootApplication
@EnableDiscoveryClient
public class ServiceApplication {
    
    @Bean
    @LoadBalanced
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }
}
```

#### ç†”æ–­é™çº§
```java
/**
 * ç†”æ–­é™çº§ç¤ºä¾‹
 */
@Service
public class UserService {
    
    @HystrixCommand(fallbackMethod = "getDefaultUser",
        commandProperties = {
            @HystrixProperty(name = "execution.isolation.thread.timeoutInMilliseconds", value = "1000"),
            @HystrixProperty(name = "circuitBreaker.requestVolumeThreshold", value = "20"),
            @HystrixProperty(name = "circuitBreaker.errorThresholdPercentage", value = "50"),
            @HystrixProperty(name = "circuitBreaker.sleepWindowInMilliseconds", value = "5000")
        })
    public User getUser(Long id) {
        // è°ƒç”¨ç”¨æˆ·æœåŠ¡
    }
    
    public User getDefaultUser(Long id) {
        // é™çº§è¿”å›é»˜è®¤ç”¨æˆ·
    }
}
```

### æœ€ä½³å®è·µ

#### é¡¹ç›®ç»“æ„
```
src/main/java
    â”œâ”€â”€ com.example.demo
    â”‚   â”œâ”€â”€ DemoApplication.java
    â”‚   â”œâ”€â”€ config/
    â”‚   â”œâ”€â”€ controller/
    â”‚   â”œâ”€â”€ service/
    â”‚   â”œâ”€â”€ repository/
    â”‚   â”œâ”€â”€ model/
    â”‚   â”œâ”€â”€ dto/
    â”‚   â”œâ”€â”€ exception/
    â”‚   â””â”€â”€ util/
    â””â”€â”€ resources
        â”œâ”€â”€ application.yml
        â”œâ”€â”€ application-dev.yml
        â””â”€â”€ application-prod.yml
```

#### é…ç½®æœ€ä½³å®è·µ
```yaml
# application.yml
spring:
  profiles:
    active: dev
  datasource:
    url: jdbc:mysql://localhost:3306/demo
    username: root
    password: ${MYSQL_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
  redis:
    host: localhost
    port: 6379
  cache:
    type: redis
    redis:
      time-to-live: 60000

server:
  port: 8080
  servlet:
    context-path: /api

logging:
  level:
    root: INFO
    com.example: DEBUG
  file:
    name: logs/application.log

management:
  endpoints:
    web:
      exposure:
        include: "*"
  endpoint:
    health:
      show-details: always
```

## å¯åŠ¨æµç¨‹ä¸åŸç†

SpringBootå¯åŠ¨æµç¨‹å›¾ï¼š

```mermaid
graph TD
    A[SpringBootå¯åŠ¨æµç¨‹] --> B[åˆ›å»ºSpringApplication]
    B --> C[å‡†å¤‡ç¯å¢ƒ]
    C --> D[åˆ›å»ºApplicationContext]
    D --> E[åˆ·æ–°ä¸Šä¸‹æ–‡]
    E --> F[æ‰§è¡ŒRunner]
    
    B --> B1[åŠ è½½SpringFactories]
    B --> B2[æ¨æ–­åº”ç”¨ç±»å‹]
    
    C --> C1[åˆ›å»ºç¯å¢ƒ]
    C --> C2[åŠ è½½å±æ€§æº]
    C --> C3[ç»‘å®šç¯å¢ƒå˜é‡]
    
    D --> D1[åˆ›å»ºBeanå·¥å‚]
    D --> D2[æ³¨å†ŒBeanDefinition]
    
    E --> E1[å¤„ç†BeanFactoryPostProcessor]
    E --> E2[æ³¨å†ŒBeanPostProcessor]
    E --> E3[åˆå§‹åŒ–äº‹ä»¶å¹¿æ’­å™¨]
    E --> E4[åˆå§‹åŒ–éæ‡’åŠ è½½å•ä¾‹]
    
    F --> F1[æ‰§è¡ŒCommandLineRunner]
    F --> F2[æ‰§è¡ŒApplicationRunner]
```

### å¯åŠ¨æµç¨‹è¯¦è§£

```java
/**
 * SpringBootå¯åŠ¨æµç¨‹åˆ†æ
 */
public class SpringBootStartupAnalysis {
    
    /**
     * 1. åˆ›å»ºSpringApplication
     */
    public void createSpringApplication() {
        // è®¾ç½®åº”ç”¨ç±»å‹
        // SERVLET, REACTIVE, NONE
        this.webApplicationType = WebApplicationType.deduceFromClasspath();
        
        // åŠ è½½ApplicationContextInitializer
        setInitializers(getSpringFactoriesInstances(ApplicationContextInitializer.class));
        
        // åŠ è½½ApplicationListener
        setListeners(getSpringFactoriesInstances(ApplicationListener.class));
        
        // æ¨æ–­ä¸»åº”ç”¨ç±»
        this.mainApplicationClass = deduceMainApplicationClass();
    }
    
    /**
     * 2. å‡†å¤‡ç¯å¢ƒ
     */
    public void prepareEnvironment() {
        // åˆ›å»ºç¯å¢ƒå¯¹è±¡
        // StandardServletEnvironment, StandardReactiveWebEnvironment
        ConfigurableEnvironment environment = getOrCreateEnvironment();
        
        // é…ç½®ç¯å¢ƒ
        configureEnvironment(environment, args);
        
        // ç»‘å®šç¯å¢ƒå˜é‡
        ConfigurationPropertySources.attach(environment);
        
        // å‘å¸ƒç¯å¢ƒå‡†å¤‡äº‹ä»¶
        listeners.environmentPrepared(environment);
    }
    
    /**
     * 3. åˆ›å»ºApplicationContext
     */
    public void createApplicationContext() {
        // æ ¹æ®åº”ç”¨ç±»å‹åˆ›å»ºä¸Šä¸‹æ–‡
        // AnnotationConfigServletWebServerApplicationContext
        // AnnotationConfigReactiveWebServerApplicationContext
        // AnnotationConfigApplicationContext
        context = createApplicationContext();
        
        // å‡†å¤‡ä¸Šä¸‹æ–‡
        prepareContext(context, environment, listeners, applicationArguments, printedBanner);
        
        // åŠ è½½Beanå®šä¹‰
        load(context, sources.toArray(new Object[0]));
    }
    
    /**
     * 4. åˆ·æ–°ä¸Šä¸‹æ–‡
     */
    public void refreshContext() {
        // åˆ·æ–°ä¸Šä¸‹æ–‡
        refreshContext(context);
        
        // æ³¨å†Œå…³é—­é’©å­
        registerShutdownHook();
    }
    
    /**
     * 5. æ‰§è¡ŒRunner
     */
    public void callRunners() {
        // è·å–æ‰€æœ‰Runner
        Collection<ApplicationRunner> applicationRunners = context.getBeansOfType(ApplicationRunner.class).values();
        Collection<CommandLineRunner> commandLineRunners = context.getBeansOfType(CommandLineRunner.class).values();
        
        // æ’åºå¹¶æ‰§è¡Œ
        AnnotationAwareOrderComparator.sort(applicationRunners);
        AnnotationAwareOrderComparator.sort(commandLineRunners);
        
        // å…ˆæ‰§è¡ŒApplicationRunner
        for (ApplicationRunner runner : applicationRunners) {
            runner.run(args);
        }
        
        // å†æ‰§è¡ŒCommandLineRunner
        for (CommandLineRunner runner : commandLineRunners) {
            runner.run(args.getSourceArgs());
        }
    }
}
```

### è‡ªåŠ¨é…ç½®åŸç†

SpringBootè‡ªåŠ¨é…ç½®çš„æ ¸å¿ƒæœºåˆ¶ï¼š

```mermaid
graph TD
    A[è‡ªåŠ¨é…ç½®åŸç†] --> B["@EnableAutoConfiguration"]
    B --> C[AutoConfigurationImportSelector]
    C --> D[spring.factoriesæ–‡ä»¶]
    D --> E[è‡ªåŠ¨é…ç½®ç±»]
    E --> F[æ¡ä»¶æ³¨è§£åˆ¤æ–­]
    F --> G[Beanæ³¨å†Œ]
    
    B --> B1[å¯¼å…¥é…ç½®é€‰æ‹©å™¨]
    C --> C1[è·å–å€™é€‰é…ç½®]
    C --> C2[è¿‡æ»¤é…ç½®]
    C --> C3[æ’åºé…ç½®]
    
    D --> D1[META-INF/spring.factories]
    D --> D2[org.springframework.boot.autoconfigure.EnableAutoConfiguration]
    
    E --> E1[WebMvcAutoConfiguration]
    E --> E2[DataSourceAutoConfiguration]
    E --> E3[RedisAutoConfiguration]
    
    F --> F1["@ConditionalOnClass"]
    F --> F2["@ConditionalOnBean"]
    F --> F3["@ConditionalOnProperty"]
    
    G --> G1[æ³¨å†Œåˆ°Springå®¹å™¨]
    G --> G2[å¯è¢«ä¾èµ–æ³¨å…¥]
```

```java
/**
 * è‡ªåŠ¨é…ç½®åŸç†æ·±åº¦è§£æ
 */
public class AutoConfigurationPrinciple {
    
    /**
     * @EnableAutoConfigurationæ³¨è§£åˆ†æ
     */
    @Target(ElementType.TYPE)
    @Retention(RetentionPolicy.RUNTIME)
    @Documented
    @Inherited
    @AutoConfigurationPackage  // è‡ªåŠ¨é…ç½®åŒ…
    @Import(AutoConfigurationImportSelector.class)  // å¯¼å…¥è‡ªåŠ¨é…ç½®é€‰æ‹©å™¨
    public @interface EnableAutoConfiguration {
        String ENABLED_OVERRIDE_PROPERTY = "spring.boot.enableautoconfiguration";
        Class<?>[] exclude() default {};
        String[] excludeName() default {};
    }
    
    /**
     * AutoConfigurationImportSelectoræ ¸å¿ƒé€»è¾‘
     */
    public class AutoConfigurationImportSelector implements DeferredImportSelector {
        
        @Override
        public String[] selectImports(AnnotationMetadata annotationMetadata) {
            if (!isEnabled(annotationMetadata)) {
                return NO_IMPORTS;
            }
            
            // 1. è·å–è‡ªåŠ¨é…ç½®å…ƒæ•°æ®
            AutoConfigurationMetadata autoConfigurationMetadata = 
                AutoConfigurationMetadataLoader.loadMetadata(this.beanClassLoader);
            
            // 2. è·å–è‡ªåŠ¨é…ç½®æ¡ç›®
            AutoConfigurationEntry autoConfigurationEntry = 
                getAutoConfigurationEntry(autoConfigurationMetadata, annotationMetadata);
            
            return StringUtils.toStringArray(autoConfigurationEntry.getConfigurations());
        }
        
        /**
         * è·å–è‡ªåŠ¨é…ç½®æ¡ç›®
         */
        protected AutoConfigurationEntry getAutoConfigurationEntry(
                AutoConfigurationMetadata autoConfigurationMetadata,
                AnnotationMetadata annotationMetadata) {
            
            if (!isEnabled(annotationMetadata)) {
                return EMPTY_ENTRY;
            }
            
            // è·å–æ³¨è§£å±æ€§
            AnnotationAttributes attributes = getAttributes(annotationMetadata);
            
            // è·å–å€™é€‰é…ç½®
            List<String> configurations = getCandidateConfigurations(annotationMetadata, attributes);
            
            // å»é‡
            configurations = removeDuplicates(configurations);
            
            // è·å–æ’é™¤é¡¹
            Set<String> exclusions = getExclusions(annotationMetadata, attributes);
            
            // æ£€æŸ¥æ’é™¤é¡¹
            checkExcludedClasses(configurations, exclusions);
            
            // ç§»é™¤æ’é™¤é¡¹
            configurations.removeAll(exclusions);
            
            // è¿‡æ»¤é…ç½®
            configurations = filter(configurations, autoConfigurationMetadata);
            
            // è§¦å‘è‡ªåŠ¨é…ç½®å¯¼å…¥äº‹ä»¶
            fireAutoConfigurationImportEvents(configurations, exclusions);
            
            return new AutoConfigurationEntry(configurations, exclusions);
        }
        
        /**
         * è·å–å€™é€‰é…ç½®
         */
        protected List<String> getCandidateConfigurations(
                AnnotationMetadata metadata, AnnotationAttributes attributes) {
            
            // ä»spring.factoriesæ–‡ä»¶ä¸­åŠ è½½é…ç½®
            List<String> configurations = SpringFactoriesLoader.loadFactoryNames(
                getSpringFactoriesLoaderFactoryClass(), getBeanClassLoader());
            
            Assert.notEmpty(configurations, 
                "No auto configuration classes found in META-INF/spring.factories. " +
                "If you are using a custom packaging, make sure that file is correct.");
            
            return configurations;
        }
    }
    
    /**
     * å…¸å‹çš„è‡ªåŠ¨é…ç½®ç±»ç¤ºä¾‹ - WebMvcAutoConfiguration
     */
    @Configuration(proxyBeanMethods = false)
    @ConditionalOnWebApplication(type = Type.SERVLET)
    @ConditionalOnClass({ Servlet.class, DispatcherServlet.class, WebMvcConfigurer.class })
    @ConditionalOnMissingBean(WebMvcConfigurationSupport.class)
    @AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE + 10)
    @AutoConfigureAfter({ DispatcherServletAutoConfiguration.class, TaskExecutionAutoConfiguration.class,
            ValidationAutoConfiguration.class })
    public class WebMvcAutoConfiguration {
        
        @Configuration(proxyBeanMethods = false)
        @Import(EnableWebMvcConfiguration.class)
        @EnableConfigurationProperties({ WebMvcProperties.class, ResourceProperties.class })
        @Order(0)
        public static class WebMvcAutoConfigurationAdapter implements WebMvcConfigurer {
            
            private final WebMvcProperties mvcProperties;
            private final ResourceProperties resourceProperties;
            
            public WebMvcAutoConfigurationAdapter(WebMvcProperties mvcProperties, 
                                                ResourceProperties resourceProperties) {
                this.mvcProperties = mvcProperties;
                this.resourceProperties = resourceProperties;
            }
            
            @Override
            public void configurePathMatch(PathMatchConfigurer configurer) {
                // é…ç½®è·¯å¾„åŒ¹é…
                configurer.setUseTrailingSlashMatch(this.mvcProperties.getPathmatch().isUseTrailingSlashMatch());
                configurer.setUseSuffixPatternMatch(this.mvcProperties.getPathmatch().isUseSuffixPattern());
            }
            
            @Override
            public void addResourceHandlers(ResourceHandlerRegistry registry) {
                // é…ç½®é™æ€èµ„æºå¤„ç†
                if (!this.resourceProperties.isAddMappings()) {
                    return;
                }
                Duration cachePeriod = this.resourceProperties.getCache().getPeriod();
                CacheControl cacheControl = this.resourceProperties.getCache().getCachecontrol().toHttpCacheControl();
                
                if (!registry.hasMappingForPattern("/webjars/**")) {
                    customizeResourceHandlerRegistration(registry.addResourceHandler("/webjars/**")
                            .addResourceLocations("classpath:/META-INF/resources/webjars/")
                            .setCachePeriod(getSeconds(cachePeriod)).setCacheControl(cacheControl));
                }
                
                String staticPathPattern = this.mvcProperties.getStaticPathPattern();
                if (!registry.hasMappingForPattern(staticPathPattern)) {
                    customizeResourceHandlerRegistration(registry.addResourceHandler(staticPathPattern)
                            .addResourceLocations(getResourceLocations(this.resourceProperties.getStaticLocations()))
                            .setCachePeriod(getSeconds(cachePeriod)).setCacheControl(cacheControl));
                }
            }
        }
    }
}
```

### æ¡ä»¶æ³¨è§£è¯¦è§£

```java
/**
 * æ¡ä»¶æ³¨è§£å®Œæ•´è§£æ
 */
public class ConditionalAnnotations {
    
    /**
     * ç±»è·¯å¾„æ¡ä»¶æ³¨è§£
     */
    @ConditionalOnClass(DataSource.class)  // ç±»è·¯å¾„å­˜åœ¨DataSourceç±»
    @ConditionalOnMissingClass("com.example.CustomDataSource")  // ç±»è·¯å¾„ä¸å­˜åœ¨æŒ‡å®šç±»
    public DataSource dataSource() {
        return new HikariDataSource();
    }
    
    /**
     * Beanæ¡ä»¶æ³¨è§£
     */
    @ConditionalOnBean(DataSource.class)  // å®¹å™¨ä¸­å­˜åœ¨DataSourceç±»å‹çš„Bean
    @ConditionalOnMissingBean(name = "customService")  // å®¹å™¨ä¸­ä¸å­˜åœ¨åä¸ºcustomServiceçš„Bean
    @ConditionalOnSingleCandidate(DataSource.class)  // å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªDataSource Beanæˆ–æœ‰ä¸€ä¸ªä¸»è¦çš„
    public JdbcTemplate jdbcTemplate(DataSource dataSource) {
        return new JdbcTemplate(dataSource);
    }
    
    /**
     * å±æ€§æ¡ä»¶æ³¨è§£
     */
    @ConditionalOnProperty(
        prefix = "app.feature",  // å±æ€§å‰ç¼€
        name = "enabled",        // å±æ€§å
        havingValue = "true",    // æœŸæœ›å€¼
        matchIfMissing = false   // å±æ€§ä¸å­˜åœ¨æ—¶æ˜¯å¦åŒ¹é…
    )
    public FeatureService featureService() {
        return new FeatureService();
    }
    
    /**
     * èµ„æºæ¡ä»¶æ³¨è§£
     */
    @ConditionalOnResource(resources = "classpath:config/custom.properties")
    public CustomConfig customConfig() {
        return new CustomConfig();
    }
    
    /**
     * Webåº”ç”¨æ¡ä»¶æ³¨è§£
     */
    @ConditionalOnWebApplication(type = ConditionalOnWebApplication.Type.SERVLET)
    public ServletWebServerFactory servletWebServerFactory() {
        return new TomcatServletWebServerFactory();
    }
    
    @ConditionalOnNotWebApplication
    public CommandLineRunner commandLineRunner() {
        return args -> System.out.println("Non-web application started");
    }
    
    /**
     * è¡¨è¾¾å¼æ¡ä»¶æ³¨è§£
     */
    @ConditionalOnExpression("${app.feature.enabled:false} and ${app.environment} == 'production'")
    public ProductionService productionService() {
        return new ProductionService();
    }
    
    /**
     * Javaç‰ˆæœ¬æ¡ä»¶æ³¨è§£
     */
    @ConditionalOnJava(JavaVersion.EIGHT)
    public Java8SpecificService java8Service() {
        return new Java8SpecificService();
    }
    
    /**
     * JNDIæ¡ä»¶æ³¨è§£
     */
    @ConditionalOnJndi("java:comp/env/jdbc/MyDataSource")
    public DataSource jndiDataSource() {
        // JNDIæ•°æ®æºé…ç½®
        return null;
    }
}
```

#### è‡ªå®šä¹‰æ¡ä»¶æ³¨è§£

```java
/**
 * è‡ªå®šä¹‰æ¡ä»¶æ³¨è§£ç¤ºä¾‹
 */
@Target({ElementType.TYPE, ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Conditional(OnCustomCondition.class)
public @interface ConditionalOnCustom {
    String value() default "";
    String[] profiles() default {};
}

/**
 * è‡ªå®šä¹‰æ¡ä»¶å®ç°
 */
public class OnCustomCondition implements Condition {
    
    @Override
    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
        // è·å–æ³¨è§£å±æ€§
        MultiValueMap<String, Object> attributes = 
            metadata.getAllAnnotationAttributes(ConditionalOnCustom.class.getName());
        
        if (attributes == null) {
            return false;
        }
        
        String value = (String) attributes.getFirst("value");
        String[] profiles = (String[]) attributes.getFirst("profiles");
        
        Environment environment = context.getEnvironment();
        
        // æ£€æŸ¥å±æ€§æ¡ä»¶
        if (StringUtils.hasText(value)) {
            String property = environment.getProperty("custom.condition." + value);
            if (!"true".equals(property)) {
                return false;
            }
        }
        
        // æ£€æŸ¥ç¯å¢ƒæ¡ä»¶
        if (profiles != null && profiles.length > 0) {
            return environment.acceptsProfiles(Profiles.of(profiles));
        }
        
        return true;
    }
}

/**
 * ä½¿ç”¨è‡ªå®šä¹‰æ¡ä»¶æ³¨è§£
 */
@Configuration
public class CustomConfiguration {
    
    @Bean
    @ConditionalOnCustom(value = "feature1", profiles = {"dev", "test"})
    public Feature1Service feature1Service() {
        return new Feature1Service();
    }
    
    @Bean
    @ConditionalOnCustom("feature2")
    public Feature2Service feature2Service() {
        return new Feature2Service();
    }
}
```



### META-INF/spring.factoriesé…ç½®

```properties
# src/main/resources/META-INF/spring.factories
# è‡ªåŠ¨é…ç½®ç±» - æœ€é‡è¦çš„é…ç½®
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.example.autoconfigure.CustomServiceAutoConfiguration,\
com.example.autoconfigure.CustomCacheAutoConfiguration,\
com.example.autoconfigure.CustomSecurityAutoConfiguration

# åº”ç”¨ç›‘å¬å™¨ - ç›‘å¬åº”ç”¨ç”Ÿå‘½å‘¨æœŸäº‹ä»¶
org.springframework.context.ApplicationListener=\
com.example.listener.CustomApplicationStartedListener,\
com.example.listener.CustomApplicationReadyListener

# ç¯å¢ƒåå¤„ç†å™¨ - å¤„ç†ç¯å¢ƒé…ç½®
org.springframework.boot.env.EnvironmentPostProcessor=\
com.example.env.CustomEnvironmentPostProcessor

# å¤±è´¥åˆ†æå™¨ - æä¾›å‹å¥½çš„é”™è¯¯ä¿¡æ¯
org.springframework.boot.diagnostics.FailureAnalyzer=\
com.example.diagnostics.CustomDataSourceFailureAnalyzer,\
com.example.diagnostics.CustomConnectionFailureAnalyzer

# åº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹åŒ–å™¨ - åˆå§‹åŒ–åº”ç”¨ä¸Šä¸‹æ–‡
org.springframework.context.ApplicationContextInitializer=\
com.example.context.CustomApplicationContextInitializer

# è‡ªåŠ¨é…ç½®å¯¼å…¥è¿‡æ»¤å™¨ - è¿‡æ»¤ä¸éœ€è¦çš„è‡ªåŠ¨é…ç½®
org.springframework.boot.autoconfigure.AutoConfigurationImportFilter=\
com.example.filter.CustomAutoConfigurationImportFilter

# Beanåå¤„ç†å™¨ - å¤„ç†Beançš„åˆ›å»ºå’Œåˆå§‹åŒ–
org.springframework.beans.factory.config.BeanPostProcessor=\
com.example.processor.CustomBeanPostProcessor

# å±æ€§æºå®šä½å™¨ - å®šä½é…ç½®æ–‡ä»¶
org.springframework.boot.env.PropertySourceLoader=\
com.example.loader.CustomPropertySourceLoader

# è¿è¡Œç›‘å¬å™¨ - ç›‘å¬SpringBootè¿è¡Œè¿‡ç¨‹
org.springframework.boot.SpringApplicationRunListener=\
com.example.listener.CustomSpringApplicationRunListener
```

```java
/**
 * ä½¿ç”¨è‡ªå®šä¹‰Starterçš„å®Œæ•´ç¤ºä¾‹
 */
// åœ¨åº”ç”¨ä¸­ä½¿ç”¨
@SpringBootApplication
public class Application {
    
    @Autowired
    private CustomService customService;
    
    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
    
    @EventListener(ApplicationReadyEvent.class)
    public void onApplicationReady() {
        String result = customService.processData("test data");
        System.out.println("Result: " + result);
    }
}

// application.ymlé…ç½®ç¤ºä¾‹
/*
custom:
  service:
    enabled: true
    name: my-custom-service
    timeout: 10000
    retry-count: 5
    health-check: true
    metrics: true
    pool:
      max-active: 20
      max-idle: 10
      min-idle: 2
      max-wait: 5000

# å¯ç”¨å¥åº·æ£€æŸ¥ç«¯ç‚¹
management:
  endpoints:
    web:
      exposure:
        include: health,metrics,info
  endpoint:
    health:
      show-details: always
*/

/**
 * è‡ªå®šä¹‰ç¯å¢ƒåå¤„ç†å™¨ç¤ºä¾‹
 */
public class CustomEnvironmentPostProcessor implements EnvironmentPostProcessor {
    
    @Override
    public void postProcessEnvironment(ConfigurableEnvironment environment, SpringApplication application) {
        // æ·»åŠ è‡ªå®šä¹‰å±æ€§æº
        Properties properties = new Properties();
        properties.setProperty("custom.service.auto-configured", "true");
        properties.setProperty("custom.service.version", "1.0.0");
        
        PropertiesPropertySource propertySource = new PropertiesPropertySource("customServiceProperties", properties);
        environment.getPropertySources().addLast(propertySource);
        
        // æ ¹æ®ç¯å¢ƒè®¾ç½®é»˜è®¤å€¼
        String activeProfile = environment.getProperty("spring.profiles.active", "default");
        if ("production".equals(activeProfile)) {
            properties.setProperty("custom.service.pool.max-active", "50");
            properties.setProperty("custom.service.timeout", "30000");
        }
    }
}

/**
 * è‡ªå®šä¹‰å¤±è´¥åˆ†æå™¨ç¤ºä¾‹
 */
public class CustomServiceFailureAnalyzer extends AbstractFailureAnalyzer<CustomServiceException> {
    
    @Override
    protected FailureAnalysis analyze(Throwable rootFailure, CustomServiceException cause) {
        return new FailureAnalysis(
            "Custom service failed to start: " + cause.getMessage(),
            "Please check your custom.service configuration in application.yml. " +
            "Ensure that custom.service.enabled=true and all required properties are set.",
            cause
        );
    }
}

/**
 * è‡ªå®šä¹‰åº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹åŒ–å™¨ç¤ºä¾‹
 */
public class CustomApplicationContextInitializer implements ApplicationContextInitializer<ConfigurableApplicationContext> {
    
    @Override
    public void initialize(ConfigurableApplicationContext applicationContext) {
        // æ³¨å†Œè‡ªå®šä¹‰Beanå®šä¹‰
        BeanDefinitionRegistry registry = (BeanDefinitionRegistry) applicationContext.getBeanFactory();
        
        BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition(CustomInitializationService.class);
        builder.addPropertyValue("initializationTime", System.currentTimeMillis());
        
        registry.registerBeanDefinition("customInitializationService", builder.getBeanDefinition());
        
        // æ·»åŠ è‡ªå®šä¹‰å±æ€§æº
        ConfigurableEnvironment environment = applicationContext.getEnvironment();
        Map<String, Object> customProperties = new HashMap<>();
        customProperties.put("custom.initialization.timestamp", System.currentTimeMillis());
        customProperties.put("custom.initialization.source", "ApplicationContextInitializer");
        
        MapPropertySource propertySource = new MapPropertySource("customInitialization", customProperties);
        environment.getPropertySources().addFirst(propertySource);
    }
}
```

### é…ç½®å±æ€§ç»‘å®š

SpringBootæä¾›äº†å¼ºå¤§çš„é…ç½®å±æ€§ç»‘å®šæœºåˆ¶ï¼Œæ”¯æŒç±»å‹å®‰å…¨çš„é…ç½®ã€‚

#### é…ç½®å±æ€§ç»‘å®šç¤ºä¾‹

```java
/**
 * å¤æ‚é…ç½®å±æ€§ç»‘å®šç¤ºä¾‹
 */
@ConfigurationProperties(prefix = "app")
@Validated
@Data
public class AppProperties {
    
    /**
     * åº”ç”¨åŸºæœ¬ä¿¡æ¯
     */
    @NotBlank(message = "åº”ç”¨åç§°ä¸èƒ½ä¸ºç©º")
    private String name;
    
    @NotBlank(message = "åº”ç”¨ç‰ˆæœ¬ä¸èƒ½ä¸ºç©º")
    private String version;
    
    /**
     * åº”ç”¨æè¿°
     */
    private String description = "SpringBootåº”ç”¨";
    
    /**
     * æ•°æ®åº“é…ç½®
     */
    @Valid
    private Database database = new Database();
    
    /**
     * ç¼“å­˜é…ç½®
     */
    @Valid
    private Cache cache = new Cache();
    
    /**
     * å®‰å…¨é…ç½®
     */
    @Valid
    private Security security = new Security();
    
    /**
     * çº¿ç¨‹æ± é…ç½®
     */
    @Valid
    private ThreadPool threadPool = new ThreadPool();
    
    /**
     * åŠŸèƒ½å¼€å…³é…ç½®
     */
    private Map<String, Boolean> features = new HashMap<>();
    
    /**
     * å¤–éƒ¨æœåŠ¡é…ç½®
     */
    private Map<String, ExternalService> externalServices = new HashMap<>();
    
    @Data
    @Validated
    public static class Database {
        @NotBlank(message = "æ•°æ®åº“URLä¸èƒ½ä¸ºç©º")
        private String url;
        
        @NotBlank(message = "æ•°æ®åº“ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
        private String username;
        
        @NotBlank(message = "æ•°æ®åº“å¯†ç ä¸èƒ½ä¸ºç©º")
        private String password;
        
        @Min(value = 1, message = "æœ€å¤§è¿æ¥æ± å¤§å°ä¸èƒ½å°äº1")
        @Max(value = 100, message = "æœ€å¤§è¿æ¥æ± å¤§å°ä¸èƒ½è¶…è¿‡100")
        private int maxPoolSize = 10;
        
        @Min(value = 0, message = "æœ€å°è¿æ¥æ± å¤§å°ä¸èƒ½å°äº0")
        private int minPoolSize = 5;
        
        @Min(value = 1000, message = "è¿æ¥è¶…æ—¶æ—¶é—´ä¸èƒ½å°äº1000ms")
        private long connectionTimeout = 30000;
        
        @Min(value = 60000, message = "ç©ºé—²è¶…æ—¶æ—¶é—´ä¸èƒ½å°äº60000ms")
        private long idleTimeout = 600000;
        
        private boolean showSql = false;
        private boolean formatSql = false;
    }
    
    @Data
    @Validated
    public static class Cache {
        @NotBlank(message = "ç¼“å­˜ç±»å‹ä¸èƒ½ä¸ºç©º")
        private String type = "redis";
        
        @Min(value = 60, message = "é»˜è®¤è¿‡æœŸæ—¶é—´ä¸èƒ½å°äº60ç§’")
        private long defaultExpiration = 3600;
        
        private Map<String, Long> expirations = new HashMap<>();
        
        @Valid
        private Redis redis = new Redis();
        
        @Data
        public static class Redis {
            @NotBlank(message = "Redisä¸»æœºä¸èƒ½ä¸ºç©º")
            private String host = "localhost";
            
            @Min(value = 1, message = "Redisç«¯å£ä¸èƒ½å°äº1")
            @Max(value = 65535, message = "Redisç«¯å£ä¸èƒ½è¶…è¿‡65535")
            private int port = 6379;
            
            private String password;
            
            @Min(value = 0, message = "æ•°æ®åº“ç´¢å¼•ä¸èƒ½å°äº0")
            @Max(value = 15, message = "æ•°æ®åº“ç´¢å¼•ä¸èƒ½è¶…è¿‡15")
            private int database = 0;
            
            @Min(value = 1000, message = "è¿æ¥è¶…æ—¶æ—¶é—´ä¸èƒ½å°äº1000ms")
            private long timeout = 5000;
            
            @Valid
            private Pool pool = new Pool();
            
            @Data
            public static class Pool {
                @Min(value = 1, message = "æœ€å¤§æ´»è·ƒè¿æ¥æ•°ä¸èƒ½å°äº1")
                private int maxActive = 8;
                
                @Min(value = 0, message = "æœ€å¤§ç©ºé—²è¿æ¥æ•°ä¸èƒ½å°äº0")
                private int maxIdle = 8;
                
                @Min(value = 0, message = "æœ€å°ç©ºé—²è¿æ¥æ•°ä¸èƒ½å°äº0")
                private int minIdle = 0;
                
                @Min(value = -1, message = "æœ€å¤§ç­‰å¾…æ—¶é—´ä¸èƒ½å°äº-1")
                private long maxWait = -1;
            }
        }
    }
    
    @Data
    @Validated
    public static class Security {
        private boolean enabled = true;
        
        @Valid
        private Jwt jwt = new Jwt();
        
        @Valid
        private OAuth2 oauth2 = new OAuth2();
        
        private List<String> ignoredPaths = Arrays.asList("/health", "/info", "/metrics");
        
        @Data
        public static class Jwt {
            @NotBlank(message = "JWTå¯†é’¥ä¸èƒ½ä¸ºç©º")
            private String secret = "default-secret-key-change-in-production";
            
            @Min(value = 60000, message = "JWTè¿‡æœŸæ—¶é—´ä¸èƒ½å°äº60000ms")
            private long expiration = 86400000; // 24å°æ—¶
            
            @NotBlank(message = "JWTè¯·æ±‚å¤´ä¸èƒ½ä¸ºç©º")
            private String header = "Authorization";
            
            @NotBlank(message = "JWTå‰ç¼€ä¸èƒ½ä¸ºç©º")
            private String prefix = "Bearer ";
            
            private String issuer = "SpringBoot-App";
        }
        
        @Data
        public static class OAuth2 {
            private Map<String, Provider> providers = new HashMap<>();
            
            @Data
            public static class Provider {
                @NotBlank(message = "å®¢æˆ·ç«¯IDä¸èƒ½ä¸ºç©º")
                private String clientId;
                
                @NotBlank(message = "å®¢æˆ·ç«¯å¯†é’¥ä¸èƒ½ä¸ºç©º")
                private String clientSecret;
                
                @NotBlank(message = "é‡å®šå‘URIä¸èƒ½ä¸ºç©º")
                private String redirectUri;
                
                private List<String> scopes = new ArrayList<>();
                
                private String authorizationUri;
                private String tokenUri;
                private String userInfoUri;
            }
        }
    }
    
    @Data
    @Validated
    public static class ThreadPool {
        @Min(value = 1, message = "æ ¸å¿ƒçº¿ç¨‹æ•°ä¸èƒ½å°äº1")
        private int coreSize = 5;
        
        @Min(value = 1, message = "æœ€å¤§çº¿ç¨‹æ•°ä¸èƒ½å°äº1")
        private int maxSize = 10;
        
        @Min(value = 0, message = "é˜Ÿåˆ—å®¹é‡ä¸èƒ½å°äº0")
        private int queueCapacity = 25;
        
        @Min(value = 60, message = "çº¿ç¨‹ç©ºé—²æ—¶é—´ä¸èƒ½å°äº60ç§’")
        private int keepAliveSeconds = 60;
        
        @NotBlank(message = "çº¿ç¨‹åå‰ç¼€ä¸èƒ½ä¸ºç©º")
        private String threadNamePrefix = "async-";
        
        private boolean waitForTasksToCompleteOnShutdown = true;
        
        @Min(value = 0, message = "å…³é—­ç­‰å¾…æ—¶é—´ä¸èƒ½å°äº0")
        private int awaitTerminationSeconds = 60;
    }
    
    @Data
    @Validated
    public static class ExternalService {
        @NotBlank(message = "æœåŠ¡URLä¸èƒ½ä¸ºç©º")
        private String url;
        
        @Min(value = 1000, message = "è¿æ¥è¶…æ—¶æ—¶é—´ä¸èƒ½å°äº1000ms")
        private long connectTimeout = 5000;
        
        @Min(value = 1000, message = "è¯»å–è¶…æ—¶æ—¶é—´ä¸èƒ½å°äº1000ms")
        private long readTimeout = 10000;
        
        @Min(value = 0, message = "é‡è¯•æ¬¡æ•°ä¸èƒ½å°äº0")
        private int retryCount = 3;
        
        private Map<String, String> headers = new HashMap<>();
        
        private boolean enabled = true;
    }
}

/**
 * é…ç½®å±æ€§ä½¿ç”¨ç¤ºä¾‹
 */
@Configuration
@EnableConfigurationProperties(AppProperties.class)
@Slf4j
public class AppConfiguration {
    
    private final AppProperties appProperties;
    
    public AppConfiguration(AppProperties appProperties) {
        this.appProperties = appProperties;
        log.info("Application configuration loaded: {}", appProperties.getName());
    }
    
    /**
     * é…ç½®æ•°æ®æº
     */
    @Bean
    @Primary
    public DataSource dataSource() {
        AppProperties.Database dbConfig = appProperties.getDatabase();
        
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl(dbConfig.getUrl());
        config.setUsername(dbConfig.getUsername());
        config.setPassword(dbConfig.getPassword());
        config.setMaximumPoolSize(dbConfig.getMaxPoolSize());
        config.setMinimumIdle(dbConfig.getMinPoolSize());
        config.setConnectionTimeout(dbConfig.getConnectionTimeout());
        config.setIdleTimeout(dbConfig.getIdleTimeout());
        
        return new HikariDataSource(config);
    }
    
    /**
     * é…ç½®Redisè¿æ¥å·¥å‚
     */
    @Bean
    @ConditionalOnProperty(prefix = "app.cache", name = "type", havingValue = "redis")
    public LettuceConnectionFactory redisConnectionFactory() {
        AppProperties.Cache.Redis redisConfig = appProperties.getCache().getRedis();
        
        RedisStandaloneConfiguration config = new RedisStandaloneConfiguration();
        config.setHostName(redisConfig.getHost());
        config.setPort(redisConfig.getPort());
        config.setDatabase(redisConfig.getDatabase());
        if (StringUtils.hasText(redisConfig.getPassword())) {
            config.setPassword(redisConfig.getPassword());
        }
        
        LettuceClientConfiguration.Builder clientConfig = LettuceClientConfiguration.builder();
        clientConfig.commandTimeout(Duration.ofMillis(redisConfig.getTimeout()));
        
        AppProperties.Cache.Redis.Pool poolConfig = redisConfig.getPool();
        GenericObjectPoolConfig<?> poolConfiguration = new GenericObjectPoolConfig<>();
        poolConfiguration.setMaxTotal(poolConfig.getMaxActive());
        poolConfiguration.setMaxIdle(poolConfig.getMaxIdle());
        poolConfiguration.setMinIdle(poolConfig.getMinIdle());
        poolConfiguration.setMaxWaitMillis(poolConfig.getMaxWait());
        
        clientConfig.poolingClientConfiguration(LettucePoolingClientConfiguration.builder()
                .poolConfig(poolConfiguration)
                .build());
        
        return new LettuceConnectionFactory(config, clientConfig.build());
    }
    
    /**
     * é…ç½®çº¿ç¨‹æ± 
     */
    @Bean
    @Primary
    public TaskExecutor taskExecutor() {
        AppProperties.ThreadPool threadPoolConfig = appProperties.getThreadPool();
        
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(threadPoolConfig.getCoreSize());
        executor.setMaxPoolSize(threadPoolConfig.getMaxSize());
        executor.setQueueCapacity(threadPoolConfig.getQueueCapacity());
        executor.setKeepAliveSeconds(threadPoolConfig.getKeepAliveSeconds());
        executor.setThreadNamePrefix(threadPoolConfig.getThreadNamePrefix());
        executor.setWaitForTasksToCompleteOnShutdown(threadPoolConfig.isWaitForTasksToCompleteOnShutdown());
        executor.setAwaitTerminationSeconds(threadPoolConfig.getAwaitTerminationSeconds());
        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());
        executor.initialize();
        
        return executor;
    }
    
    /**
     * é…ç½®JWTå·¥å…·
     */
    @Bean
    @ConditionalOnProperty(prefix = "app.security", name = "enabled", havingValue = "true")
    public JwtTokenProvider jwtTokenProvider() {
        AppProperties.Security.Jwt jwtConfig = appProperties.getSecurity().getJwt();
        
        return new JwtTokenProvider(
            jwtConfig.getSecret(),
            jwtConfig.getExpiration(),
            jwtConfig.getHeader(),
            jwtConfig.getPrefix(),
            jwtConfig.getIssuer()
        );
    }
    
    /**
     * é…ç½®å¤–éƒ¨æœåŠ¡å®¢æˆ·ç«¯
     */
    @Bean
    public Map<String, RestTemplate> externalServiceClients() {
        Map<String, RestTemplate> clients = new HashMap<>();
        
        appProperties.getExternalServices().forEach((serviceName, serviceConfig) -> {
            if (serviceConfig.isEnabled()) {
                RestTemplate restTemplate = new RestTemplate();
                
                // é…ç½®è¶…æ—¶æ—¶é—´
                HttpComponentsClientHttpRequestFactory factory = new HttpComponentsClientHttpRequestFactory();
                factory.setConnectTimeout((int) serviceConfig.getConnectTimeout());
                factory.setReadTimeout((int) serviceConfig.getReadTimeout());
                restTemplate.setRequestFactory(factory);
                
                // æ·»åŠ æ‹¦æˆªå™¨è®¾ç½®é»˜è®¤å¤´éƒ¨
                restTemplate.getInterceptors().add((request, body, execution) -> {
                    serviceConfig.getHeaders().forEach((key, value) -> {
                        request.getHeaders().add(key, value);
                    });
                    return execution.execute(request, body);
                });
                
                clients.put(serviceName, restTemplate);
                log.info("Created RestTemplate for external service: {}", serviceName);
            }
        });
        
        return clients;
    }
}
```

å¯¹åº”çš„é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼š

```yaml
app:
  name: SpringBoot Demo Application
  version: 1.0.0
  description: è¿™æ˜¯ä¸€ä¸ªSpringBootç¤ºä¾‹åº”ç”¨
  
  database:
    url: jdbc:mysql://localhost:3306/demo?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: ${DB_PASSWORD:password123}
    max-pool-size: 20
    min-pool-size: 5
    connection-timeout: 30000
    idle-timeout: 600000
    show-sql: true
    format-sql: true
  
  cache:
    type: redis
    default-expiration: 3600
    expirations:
      user: 1800
      product: 7200
      order: 3600
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      database: 0
      timeout: 5000
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0
        max-wait: -1
  
  security:
    enabled: true
    jwt:
      secret: ${JWT_SECRET:my-super-secret-jwt-key-for-production-use}
      expiration: 86400000
      header: Authorization
      prefix: "Bearer "
      issuer: SpringBoot-Demo-App
    oauth2:
      providers:
        google:
          client-id: ${GOOGLE_CLIENT_ID}
          client-secret: ${GOOGLE_CLIENT_SECRET}
          redirect-uri: http://localhost:8080/oauth2/callback/google
          scopes:
            - openid
            - profile
            - email
          authorization-uri: https://accounts.google.com/o/oauth2/auth
          token-uri: https://oauth2.googleapis.com/token
          user-info-uri: https://www.googleapis.com/oauth2/v2/userinfo
        github:
          client-id: ${GITHUB_CLIENT_ID}
          client-secret: ${GITHUB_CLIENT_SECRET}
          redirect-uri: http://localhost:8080/oauth2/callback/github
          scopes:
            - user:email
          authorization-uri: https://github.com/login/oauth/authorize
          token-uri: https://github.com/login/oauth/access_token
          user-info-uri: https://api.github.com/user
    ignored-paths:
      - /health
      - /info
      - /metrics
      - /swagger-ui/**
      - /v3/api-docs/**
  
  thread-pool:
    core-size: 5
    max-size: 10
    queue-capacity: 25
    keep-alive-seconds: 60
    thread-name-prefix: "async-task-"
    wait-for-tasks-to-complete-on-shutdown: true
    await-termination-seconds: 60
  
  features:
    user-registration: true
    email-verification: true
    sms-notification: false
    payment-gateway: true
    analytics: true
  
  external-services:
    payment-service:
      url: ${PAYMENT_SERVICE_URL:http://localhost:8081}
      connect-timeout: 5000
      read-timeout: 10000
      retry-count: 3
      enabled: true
      headers:
        Content-Type: application/json
        X-API-Version: v1
    notification-service:
      url: ${NOTIFICATION_SERVICE_URL:http://localhost:8082}
      connect-timeout: 3000
      read-timeout: 8000
      retry-count: 2
      enabled: true
      headers:
        Content-Type: application/json
        Authorization: Bearer ${NOTIFICATION_API_KEY}
    analytics-service:
      url: ${ANALYTICS_SERVICE_URL:http://localhost:8083}
      connect-timeout: 2000
      read-timeout: 5000
      retry-count: 1
      enabled: ${ANALYTICS_ENABLED:false}
      headers:
        Content-Type: application/json
```
        


#### é…ç½®å±æ€§ä½¿ç”¨

```java
/**
 * é…ç½®å±æ€§ä½¿ç”¨ç¤ºä¾‹
 */
@Configuration
@EnableConfigurationProperties(AppProperties.class)
public class AppConfiguration {
    
    private final AppProperties appProperties;
    
    public AppConfiguration(AppProperties appProperties) {
        this.appProperties = appProperties;
    }
    
    @Bean
    public DataSource dataSource() {
        HikariConfig config = new HikariConfig();
        AppProperties.Database db = appProperties.getDatabase();
        
        config.setJdbcUrl(db.getUrl());
        config.setUsername(db.getUsername());
        config.setPassword(db.getPassword());
        config.setMaximumPoolSize(db.getMaxPoolSize());
        config.setMinimumIdle(db.getMinPoolSize());
        config.setConnectionTimeout(db.getConnectionTimeout().toMillis());
        
        return new HikariDataSource(config);
    }
    
    @Bean
    public TaskExecutor taskExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        AppProperties.ThreadPool pool = appProperties.getThreadPool();
        
        executor.setCorePoolSize(pool.getCoreSize());
        executor.setMaxPoolSize(pool.getMaxSize());
        executor.setQueueCapacity(pool.getQueueCapacity());
        executor.setKeepAliveSeconds((int) pool.getKeepAliveTime().getSeconds());
        executor.setThreadNamePrefix(pool.getThreadNamePrefix());
        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());
        
        return executor;
    }
    
    @Bean
    @ConditionalOnProperty(prefix = "app.cache", name = "enabled", havingValue = "true")
    public CacheManager cacheManager() {
        AppProperties.Cache cache = appProperties.getCache();
        
        switch (cache.getType()) {
            case REDIS:
                return createRedisCacheManager(cache);
            case CAFFEINE:
                return createCaffeineCacheManager(cache);
            default:
                return new NoOpCacheManager();
        }
    }
}
```

## å¸¸è§é¢è¯•é¢˜

### åŸºç¡€æ¦‚å¿µé¢è¯•é¢˜

**Q1: SpringBootçš„æ ¸å¿ƒç‰¹æ€§æœ‰å“ªäº›ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootçš„æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬ï¼š

1. **è‡ªåŠ¨é…ç½®ï¼ˆAuto Configurationï¼‰**
   - åŸºäºç±»è·¯å¾„ã€å±æ€§è®¾ç½®ç­‰æ¡ä»¶è‡ªåŠ¨é…ç½®Bean
   - å‡å°‘æ‰‹åŠ¨é…ç½®ï¼Œæé«˜å¼€å‘æ•ˆç‡

2. **èµ·æ­¥ä¾èµ–ï¼ˆStarter Dependenciesï¼‰**
   - é¢„å®šä¹‰çš„ä¾èµ–ç»„åˆï¼Œç®€åŒ–ä¾èµ–ç®¡ç†
   - è‡ªåŠ¨ç®¡ç†ç‰ˆæœ¬å…¼å®¹æ€§

3. **å†…åµŒæœåŠ¡å™¨**
   - å†…ç½®Tomcatã€Jettyã€Undertowç­‰æœåŠ¡å™¨
   - æ”¯æŒç‹¬ç«‹è¿è¡Œï¼Œæ— éœ€å¤–éƒ¨å®¹å™¨

4. **ç”Ÿäº§å°±ç»ªç‰¹æ€§**
   - Actuatoræä¾›ç›‘æ§ã€å¥åº·æ£€æŸ¥ã€æŒ‡æ ‡æ”¶é›†
   - å¤–éƒ¨åŒ–é…ç½®æ”¯æŒ

**Q2: @SpringBootApplicationæ³¨è§£çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå®ƒåŒ…å«å“ªäº›æ³¨è§£ï¼Ÿ**

**ç­”æ¡ˆï¼š**
`@SpringBootApplication`æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼ŒåŒ…å«ï¼š

```java
@SpringBootApplication
// ç­‰ä»·äº
@SpringBootConfiguration  // æ ‡è¯†é…ç½®ç±»
@EnableAutoConfiguration  // å¯ç”¨è‡ªåŠ¨é…ç½®
@ComponentScan           // ç»„ä»¶æ‰«æ
```

- `@SpringBootConfiguration`ï¼šæ ‡è¯†è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»
- `@EnableAutoConfiguration`ï¼šå¯ç”¨SpringBootçš„è‡ªåŠ¨é…ç½®æœºåˆ¶
- `@ComponentScan`ï¼šæ‰«æå½“å‰åŒ…åŠå­åŒ…ä¸‹çš„ç»„ä»¶

**Q3: SpringBootçš„è‡ªåŠ¨é…ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootè‡ªåŠ¨é…ç½®çš„å·¥ä½œåŸç†ï¼š

1. **åŠ è½½è‡ªåŠ¨é…ç½®ç±»**
   - é€šè¿‡`@EnableAutoConfiguration`å¯¼å…¥`AutoConfigurationImportSelector`
   - è¯»å–`META-INF/spring.factories`æ–‡ä»¶ä¸­çš„è‡ªåŠ¨é…ç½®ç±»

2. **æ¡ä»¶åˆ¤æ–­**
   - ä½¿ç”¨`@Conditional`ç³»åˆ—æ³¨è§£è¿›è¡Œæ¡ä»¶åˆ¤æ–­
   - åªæœ‰æ»¡è¶³æ¡ä»¶çš„é…ç½®ç±»æ‰ä¼šç”Ÿæ•ˆ

3. **Beanåˆ›å»º**
   - æ ¹æ®æ¡ä»¶åˆ›å»ºç›¸åº”çš„Bean
   - éµå¾ª"çº¦å®šä¼˜äºé…ç½®"åŸåˆ™

```java
// è‡ªåŠ¨é…ç½®ç¤ºä¾‹
@Configuration
@ConditionalOnClass(DataSource.class)
@ConditionalOnMissingBean(DataSource.class)
public class DataSourceAutoConfiguration {
    
    @Bean
    public DataSource dataSource() {
        return new HikariDataSource();
    }
}
```

**Q4: SpringBootä¸­å¦‚ä½•å®ç°å¤šç¯å¢ƒé…ç½®ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootæ”¯æŒå¤šç§æ–¹å¼å®ç°å¤šç¯å¢ƒé…ç½®ï¼š

1. **Profileé…ç½®æ–‡ä»¶**
```yaml
# application.yml (ä¸»é…ç½®æ–‡ä»¶)
spring:
  profiles:
    active: dev

---
# application-dev.yml (å¼€å‘ç¯å¢ƒ)
server:
  port: 8080
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/demo_dev
    username: dev_user
    password: dev_password

---
# application-prod.yml (ç”Ÿäº§ç¯å¢ƒ)
server:
  port: 80
spring:
  datasource:
    url: jdbc:mysql://prod-server:3306/demo_prod
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
```

2. **@Profileæ³¨è§£**
```java
@Configuration
@Profile("dev")
public class DevConfiguration {
    @Bean
    public DataSource devDataSource() {
        return new H2DataSource();
    }
}

@Configuration
@Profile("prod")
public class ProdConfiguration {
    @Bean
    public DataSource prodDataSource() {
        return new HikariDataSource();
    }
}
```

3. **æ¿€æ´»Profileçš„æ–¹å¼**
- é…ç½®æ–‡ä»¶ï¼š`spring.profiles.active=dev`
- å‘½ä»¤è¡Œå‚æ•°ï¼š`java -jar app.jar --spring.profiles.active=prod`
- ç¯å¢ƒå˜é‡ï¼š`SPRING_PROFILES_ACTIVE=prod`
- JVMå‚æ•°ï¼š`-Dspring.profiles.active=prod`

**Q5: SpringBoot Starterçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è‡ªå®šä¹‰Starterï¼Ÿ**

**ç­”æ¡ˆï¼š**
**Starterå·¥ä½œåŸç†ï¼š**
1. **ä¾èµ–ç®¡ç†**ï¼šStarteråŒ…å«ä¸€ç»„ç›¸å…³çš„ä¾èµ–
2. **è‡ªåŠ¨é…ç½®**ï¼šé€šè¿‡`spring.factories`æ–‡ä»¶å£°æ˜è‡ªåŠ¨é…ç½®ç±»
3. **æ¡ä»¶è£…é…**ï¼šä½¿ç”¨æ¡ä»¶æ³¨è§£æ§åˆ¶Beançš„åˆ›å»º

**è‡ªå®šä¹‰Starteræ­¥éª¤ï¼š**
```java
// 1. åˆ›å»ºé…ç½®å±æ€§ç±»
@ConfigurationProperties(prefix = "my.service")
@Data
public class MyServiceProperties {
    private boolean enabled = true;
    private String name = "default";
    private int timeout = 5000;
}

// 2. åˆ›å»ºæœåŠ¡ç±»
public class MyService {
    private final MyServiceProperties properties;
    
    public MyService(MyServiceProperties properties) {
        this.properties = properties;
    }
    
    public String process(String data) {
        return "Processed by " + properties.getName() + ": " + data;
    }
}

// 3. åˆ›å»ºè‡ªåŠ¨é…ç½®ç±»
@Configuration
@EnableConfigurationProperties(MyServiceProperties.class)
@ConditionalOnProperty(prefix = "my.service", name = "enabled", havingValue = "true", matchIfMissing = true)
@ConditionalOnClass(MyService.class)
public class MyServiceAutoConfiguration {
    
    @Bean
    @ConditionalOnMissingBean
    public MyService myService(MyServiceProperties properties) {
        return new MyService(properties);
    }
}

// 4. åˆ›å»ºspring.factoriesæ–‡ä»¶
// META-INF/spring.factories
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.example.MyServiceAutoConfiguration
```

**Q6: SpringBootä¸­çš„æ¡ä»¶æ³¨è§£æœ‰å“ªäº›ï¼Ÿåˆ†åˆ«ä»€ä¹ˆä½œç”¨ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootæä¾›äº†ä¸°å¯Œçš„æ¡ä»¶æ³¨è§£ï¼š

| æ³¨è§£ | ä½œç”¨ | ç¤ºä¾‹ |
|------|------|------|
| @ConditionalOnClass | ç±»è·¯å¾„å­˜åœ¨æŒ‡å®šç±»æ—¶ç”Ÿæ•ˆ | @ConditionalOnClass(DataSource.class) |
| @ConditionalOnMissingClass | ç±»è·¯å¾„ä¸å­˜åœ¨æŒ‡å®šç±»æ—¶ç”Ÿæ•ˆ | @ConditionalOnMissingClass("com.example.CustomClass") |
| @ConditionalOnBean | å®¹å™¨ä¸­å­˜åœ¨æŒ‡å®šBeanæ—¶ç”Ÿæ•ˆ | @ConditionalOnBean(DataSource.class) |
| @ConditionalOnMissingBean | å®¹å™¨ä¸­ä¸å­˜åœ¨æŒ‡å®šBeanæ—¶ç”Ÿæ•ˆ | @ConditionalOnMissingBean(DataSource.class) |
| @ConditionalOnProperty | æŒ‡å®šå±æ€§å­˜åœ¨ä¸”å€¼åŒ¹é…æ—¶ç”Ÿæ•ˆ | @ConditionalOnProperty(name="app.enabled", havingValue="true") |
| @ConditionalOnResource | æŒ‡å®šèµ„æºå­˜åœ¨æ—¶ç”Ÿæ•ˆ | @ConditionalOnResource(resources="classpath:config.properties") |
| @ConditionalOnWebApplication | Webåº”ç”¨ç¯å¢ƒæ—¶ç”Ÿæ•ˆ | @ConditionalOnWebApplication |
| @ConditionalOnNotWebApplication | éWebåº”ç”¨ç¯å¢ƒæ—¶ç”Ÿæ•ˆ | @ConditionalOnNotWebApplication |
| @ConditionalOnExpression | SpELè¡¨è¾¾å¼ä¸ºtrueæ—¶ç”Ÿæ•ˆ | @ConditionalOnExpression("${app.enabled:false}") |

**Q7: SpringBootçš„å¯åŠ¨æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootå¯åŠ¨æµç¨‹åŒ…æ‹¬ä»¥ä¸‹ä¸»è¦æ­¥éª¤ï¼š

```mermaid
graph TD
    A[mainæ–¹æ³•å¯åŠ¨] --> B[åˆ›å»ºSpringApplication]
    B --> C[å‡†å¤‡ç¯å¢ƒEnvironment]
    C --> D[åˆ›å»ºApplicationContext]
    D --> E[å‡†å¤‡ApplicationContext]
    E --> F[åˆ·æ–°ApplicationContext]
    F --> G[æ‰§è¡ŒRunner]
    
    B --> B1[æ¨æ–­åº”ç”¨ç±»å‹]
    B --> B2[åŠ è½½åˆå§‹åŒ–å™¨å’Œç›‘å¬å™¨]
    
    C --> C1[åˆ›å»ºç¯å¢ƒå¯¹è±¡]
    C --> C2[åŠ è½½é…ç½®æ–‡ä»¶]
    C --> C3[ç»‘å®šç¯å¢ƒå˜é‡]
    
    D --> D1[æ ¹æ®åº”ç”¨ç±»å‹åˆ›å»ºä¸Šä¸‹æ–‡]
    
    E --> E1[è®¾ç½®ç¯å¢ƒ]
    E --> E2[åŠ è½½Beanå®šä¹‰]
    
    F --> F1[è°ƒç”¨BeanFactoryPostProcessor]
    F --> F2[æ³¨å†ŒBeanPostProcessor]
    F --> F3[åˆå§‹åŒ–MessageSource]
    F --> F4[åˆå§‹åŒ–äº‹ä»¶å¹¿æ’­å™¨]
    F --> F5[å¯åŠ¨WebæœåŠ¡å™¨]
    F --> F6[å®ä¾‹åŒ–å•ä¾‹Bean]
    
    G --> G1[æ‰§è¡ŒApplicationRunner]
    G --> G2[æ‰§è¡ŒCommandLineRunner]
```

**è¯¦ç»†æ­¥éª¤è¯´æ˜ï¼š**
1. **åˆ›å»ºSpringApplication**ï¼šæ¨æ–­åº”ç”¨ç±»å‹ï¼ŒåŠ è½½åˆå§‹åŒ–å™¨å’Œç›‘å¬å™¨
2. **å‡†å¤‡ç¯å¢ƒ**ï¼šåˆ›å»ºEnvironmentï¼ŒåŠ è½½é…ç½®æ–‡ä»¶ï¼Œå¤„ç†å‘½ä»¤è¡Œå‚æ•°
3. **åˆ›å»ºApplicationContext**ï¼šæ ¹æ®åº”ç”¨ç±»å‹åˆ›å»ºç›¸åº”çš„ä¸Šä¸‹æ–‡
4. **å‡†å¤‡ä¸Šä¸‹æ–‡**ï¼šè®¾ç½®ç¯å¢ƒï¼ŒåŠ è½½Beanå®šä¹‰ï¼Œåº”ç”¨åˆå§‹åŒ–å™¨
5. **åˆ·æ–°ä¸Šä¸‹æ–‡**ï¼šæ‰§è¡ŒSpringå®¹å™¨çš„åˆ·æ–°è¿‡ç¨‹ï¼Œåˆ›å»ºBeanå®ä¾‹
6. **æ‰§è¡ŒRunner**ï¼šæ‰§è¡ŒApplicationRunnerå’ŒCommandLineRunner

**Q8: SpringBootä¸­å¦‚ä½•å®ç°é…ç½®çš„å¤–éƒ¨åŒ–ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootæ”¯æŒå¤šç§é…ç½®å¤–éƒ¨åŒ–æ–¹å¼ï¼ŒæŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š

1. **å‘½ä»¤è¡Œå‚æ•°**
```bash
java -jar app.jar --server.port=8081 --spring.profiles.active=prod
```

2. **JNDIå±æ€§**
```java
@Value("${java:comp/env/server.port}")
private int serverPort;
```

3. **Javaç³»ç»Ÿå±æ€§**
```bash
java -Dserver.port=8081 -jar app.jar
```

4. **æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡**
```bash
export SERVER_PORT=8081
export SPRING_PROFILES_ACTIVE=prod
```

5. **application-{profile}.properties/yml**
```yaml
# application-prod.yml
server:
  port: 8081
```

6. **application.properties/yml**
```yaml
# application.yml
server:
  port: 8080
```

7. **@PropertySourceæ³¨è§£**
```java
@Configuration
@PropertySource("classpath:custom.properties")
public class CustomConfig {
    @Value("${custom.property}")
    private String customProperty;
}
```

8. **é»˜è®¤å±æ€§**
```java
@Value("${server.port:8080}")
private int serverPort; // é»˜è®¤å€¼8080
```

**é…ç½®ç»‘å®šç¤ºä¾‹ï¼š**
```java
@ConfigurationProperties(prefix = "app")
@Data
public class AppProperties {
    private String name;
    private String version;
    private Database database = new Database();
    
    @Data
    public static class Database {
        private String url;
        private String username;
        private String password;
    }
}

// å¯¹åº”é…ç½®
app:
  name: MyApp
  version: 1.0.0
  database:
    url: jdbc:mysql://localhost:3306/mydb
    username: root
    password: password
```

### è‡ªåŠ¨é…ç½®é¢è¯•é¢˜

**Q1: å¦‚ä½•æ’é™¤ç‰¹å®šçš„è‡ªåŠ¨é…ç½®ç±»ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootæä¾›å¤šç§æ–¹å¼æ’é™¤è‡ªåŠ¨é…ç½®ç±»ï¼š

1. **ä½¿ç”¨@SpringBootApplicationçš„excludeå±æ€§**
```java
@SpringBootApplication(exclude = {DataSourceAutoConfiguration.class, RedisAutoConfiguration.class})
public class Application {
    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}
```

2. **ä½¿ç”¨@EnableAutoConfigurationçš„excludeå±æ€§**
```java
@Configuration
@EnableAutoConfiguration(exclude = {DataSourceAutoConfiguration.class})
@ComponentScan
public class Application {
    // ...
}
```

3. **ä½¿ç”¨é…ç½®æ–‡ä»¶**
```yaml
spring:
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
```

4. **ä½¿ç”¨excludeNameå±æ€§**
```java
@SpringBootApplication(excludeName = {
    "org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration"
})
public class Application {
    // ...
}
```

**Q2: å¦‚ä½•æŸ¥çœ‹SpringBootåº”ç”¨ä¸­ç”Ÿæ•ˆçš„è‡ªåŠ¨é…ç½®ï¼Ÿ**

**ç­”æ¡ˆï¼š**
å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹ç”Ÿæ•ˆçš„è‡ªåŠ¨é…ç½®ï¼š

1. **å¯ç”¨debugæ¨¡å¼**
```yaml
# application.yml
debug: true
```
æˆ–å‘½ä»¤è¡Œå‚æ•°ï¼š
```bash
java -jar app.jar --debug
```

2. **ä½¿ç”¨Actuatorç«¯ç‚¹**
```yaml
# å¯ç”¨autoconfigç«¯ç‚¹
management:
  endpoints:
    web:
      exposure:
        include: autoconfig
```
è®¿é—®ï¼š`http://localhost:8080/actuator/autoconfig`

3. **ä½¿ç”¨conditionsç«¯ç‚¹**
```yaml
management:
  endpoints:
    web:
      exposure:
        include: conditions
```
è®¿é—®ï¼š`http://localhost:8080/actuator/conditions`

4. **ç¼–ç¨‹æ–¹å¼è·å–**
```java
@RestController
public class AutoConfigController {
    
    @Autowired
    private ApplicationContext applicationContext;
    
    @GetMapping("/autoconfig")
    public Map<String, Object> getAutoConfig() {
        ConditionEvaluationReport report = ConditionEvaluationReport.get(applicationContext.getBeanFactory());
        
        Map<String, Object> result = new HashMap<>();
        result.put("positiveMatches", report.getConditionAndOutcomesBySource().entrySet().stream()
            .filter(entry -> entry.getValue().isFullMatch())
            .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue)));
        
        result.put("negativeMatches", report.getConditionAndOutcomesBySource().entrySet().stream()
            .filter(entry -> !entry.getValue().isFullMatch())
            .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue)));
        
        return result;
    }
}
```

**Q3: SpringBootå¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootå¤„ç†å¾ªç¯ä¾èµ–çš„ç­–ç•¥ï¼š

1. **æ„é€ å™¨å¾ªç¯ä¾èµ–**ï¼šæ— æ³•è§£å†³ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸
```java
// è¿™ç§æƒ…å†µä¼šæŠ¥é”™
@Service
public class ServiceA {
    private final ServiceB serviceB;
    
    public ServiceA(ServiceB serviceB) { // æ„é€ å™¨æ³¨å…¥
        this.serviceB = serviceB;
    }
}

@Service
public class ServiceB {
    private final ServiceA serviceA;
    
    public ServiceB(ServiceA serviceA) { // æ„é€ å™¨æ³¨å…¥
        this.serviceA = serviceA;
    }
}
```

2. **Setterå¾ªç¯ä¾èµ–**ï¼šå¯ä»¥è§£å†³
```java
@Service
public class ServiceA {
    @Autowired
    private ServiceB serviceB; // å­—æ®µæ³¨å…¥
}

@Service
public class ServiceB {
    @Autowired
    private ServiceA serviceA; // å­—æ®µæ³¨å…¥
}
```

3. **è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨`@Lazy`æ³¨è§£å»¶è¿Ÿåˆå§‹åŒ–
- é‡æ–°è®¾è®¡ç±»ç»“æ„ï¼Œæ¶ˆé™¤å¾ªç¯ä¾èµ–
- ä½¿ç”¨`@PostConstruct`è¿›è¡Œåˆå§‹åŒ–
- ä½¿ç”¨ApplicationContextæ‰‹åŠ¨è·å–Bean

```java
// ä½¿ç”¨@Lazyè§£å†³
@Service
public class ServiceA {
    private final ServiceB serviceB;
    
    public ServiceA(@Lazy ServiceB serviceB) {
        this.serviceB = serviceB;
    }
}

// ä½¿ç”¨ApplicationContext
@Service
public class ServiceA implements ApplicationContextAware {
    private ApplicationContext applicationContext;
    private ServiceB serviceB;
    
    @PostConstruct
    public void init() {
        this.serviceB = applicationContext.getBean(ServiceB.class);
    }
    
    @Override
    public void setApplicationContext(ApplicationContext applicationContext) {
        this.applicationContext = applicationContext;
    }
}
```



**Q5: SpringBoot Starterçš„ä½œç”¨å’ŒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ**

**ç­”æ¡ˆï¼š**
Starterçš„ä½œç”¨ï¼š
- **ç®€åŒ–ä¾èµ–ç®¡ç†**ï¼šé¢„å®šä¹‰ç›¸å…³ä¾èµ–çš„ç»„åˆ
- **è‡ªåŠ¨é…ç½®**ï¼šæä¾›é»˜è®¤é…ç½®ï¼Œå‡å°‘æ‰‹åŠ¨é…ç½®
- **ç‰ˆæœ¬ç®¡ç†**ï¼šç¡®ä¿ä¾èµ–ç‰ˆæœ¬å…¼å®¹æ€§

Starterçš„ç»„æˆï¼š
1. **ä¾èµ–ç®¡ç†**ï¼špom.xmlä¸­å®šä¹‰ç›¸å…³ä¾èµ–
2. **è‡ªåŠ¨é…ç½®ç±»**ï¼šæä¾›é»˜è®¤Beané…ç½®
3. **é…ç½®å±æ€§ç±»**ï¼šæ”¯æŒå¤–éƒ¨åŒ–é…ç½®
4. **spring.factories**ï¼šå£°æ˜è‡ªåŠ¨é…ç½®ç±»



**Q6: å¦‚ä½•è‡ªå®šä¹‰SpringBoot Starterï¼Ÿ**

**ç­”æ¡ˆï¼š**
åˆ›å»ºè‡ªå®šä¹‰Starterçš„æ­¥éª¤ï¼š

1. **åˆ›å»ºé…ç½®å±æ€§ç±»**
```java
@ConfigurationProperties(prefix = "my.service")
public class MyServiceProperties {
    private boolean enabled = true;
    private String name = "default";
    // getters and setters
}
```

2. **åˆ›å»ºè‡ªåŠ¨é…ç½®ç±»**
```java
@Configuration
@ConditionalOnClass(MyService.class)
@EnableConfigurationProperties(MyServiceProperties.class)
public class MyServiceAutoConfiguration {
    
    @Bean
    @ConditionalOnMissingBean
    public MyService myService(MyServiceProperties properties) {
        return new MyService(properties);
    }
}
```

3. **åˆ›å»ºspring.factoriesæ–‡ä»¶**
```properties
# META-INF/spring.factories
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.example.MyServiceAutoConfiguration
```

**Q7: @Conditionalæ³¨è§£çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ**

**ç­”æ¡ˆï¼š**
`@Conditional`æ³¨è§£çš„å·¥ä½œåŸç†ï¼š

1. **æ¡ä»¶è¯„ä¼°**ï¼šåœ¨Beanåˆ›å»ºå‰è¯„ä¼°æ¡ä»¶
2. **Conditionæ¥å£**ï¼šå®ç°`matches`æ–¹æ³•åˆ¤æ–­æ¡ä»¶
3. **ä¸Šä¸‹æ–‡ä¿¡æ¯**ï¼šæä¾›`ConditionContext`å’Œ`AnnotatedTypeMetadata`

```java
public class MyCondition implements Condition {
    @Override
    public boolean matches(ConditionContext context, 
                          AnnotatedTypeMetadata metadata) {
        // æ¡ä»¶åˆ¤æ–­é€»è¾‘
        return context.getEnvironment()
                     .getProperty("my.feature.enabled", Boolean.class, false);
    }
}
```

å¸¸ç”¨æ¡ä»¶æ³¨è§£ï¼š
- `@ConditionalOnClass`ï¼šç±»å­˜åœ¨æ—¶
- `@ConditionalOnBean`ï¼šBeanå­˜åœ¨æ—¶
- `@ConditionalOnProperty`ï¼šå±æ€§æ»¡è¶³æ¡ä»¶æ—¶
- `@ConditionalOnMissingBean`ï¼šBeanä¸å­˜åœ¨æ—¶

### Webå¼€å‘é¢è¯•é¢˜

**Q8: SpringBootä¸­å¦‚ä½•å¤„ç†å…¨å±€å¼‚å¸¸ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootæä¾›å¤šç§å¼‚å¸¸å¤„ç†æ–¹å¼ï¼š

1. **@ControllerAdviceå…¨å±€å¼‚å¸¸å¤„ç†**
```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(ValidationException.class)
    public ResponseEntity<ErrorResponse> handleValidation(ValidationException e) {
        ErrorResponse error = new ErrorResponse("VALIDATION_ERROR", e.getMessage());
        return ResponseEntity.badRequest().body(error);
    }
    
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleGeneral(Exception e) {
        ErrorResponse error = new ErrorResponse("INTERNAL_ERROR", "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯");
        return ResponseEntity.status(500).body(error);
    }
}
```

2. **@ExceptionHandleræ–¹æ³•çº§å¼‚å¸¸å¤„ç†**
```java
@RestController
public class UserController {
    
    @ExceptionHandler(UserNotFoundException.class)
    public ResponseEntity<String> handleUserNotFound(UserNotFoundException e) {
        return ResponseEntity.notFound().build();
    }
}
```

3. **å®ç°ErrorControllerè‡ªå®šä¹‰é”™è¯¯é¡µé¢**
```java
@Controller
public class CustomErrorController implements ErrorController {
    
    @RequestMapping("/error")
    public String handleError(HttpServletRequest request) {
        Integer statusCode = (Integer) request.getAttribute("javax.servlet.error.status_code");
        if (statusCode == 404) {
            return "error/404";
        }
        return "error/500";
    }
}
```

**Q9: SpringBootä¸­å¦‚ä½•å®ç°å‚æ•°éªŒè¯ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBooté›†æˆäº†Bean Validationï¼Œæ”¯æŒå¤šç§éªŒè¯æ–¹å¼ï¼š

1. **å®ä½“ç±»éªŒè¯**
```java
public class User {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-20ä¹‹é—´")
    private String username;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    @NotBlank(message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    private String email;
    
    @Min(value = 18, message = "å¹´é¾„ä¸èƒ½å°äº18")
    @Max(value = 100, message = "å¹´é¾„ä¸èƒ½å¤§äº100")
    private Integer age;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    @Valid
    private Address address; // åµŒå¥—éªŒè¯
}

public class Address {
    @NotBlank(message = "çœä»½ä¸èƒ½ä¸ºç©º")
    private String province;
    
    @NotBlank(message = "åŸå¸‚ä¸èƒ½ä¸ºç©º")
    private String city;
    
    @NotBlank(message = "è¯¦ç»†åœ°å€ä¸èƒ½ä¸ºç©º")
    private String detail;
}
```

2. **Controllerå±‚éªŒè¯**
```java
@RestController
@Validated
public class UserController {
    
    // è¯·æ±‚ä½“éªŒè¯
    @PostMapping("/users")
    public ResponseEntity<User> createUser(@Valid @RequestBody User user) {
        // éªŒè¯å¤±è´¥ä¼šæŠ›å‡ºMethodArgumentNotValidException
        return ResponseEntity.ok(userService.save(user));
    }
    
    // è·¯å¾„å‚æ•°éªŒè¯
    @GetMapping("/users/{id}")
    public ResponseEntity<User> getUser(@PathVariable @Min(1) Long id) {
        // éªŒè¯å¤±è´¥ä¼šæŠ›å‡ºConstraintViolationException
        return ResponseEntity.ok(userService.findById(id));
    }
    
    // æŸ¥è¯¢å‚æ•°éªŒè¯
    @GetMapping("/users")
    public ResponseEntity<List<User>> getUsers(
            @RequestParam @Size(min = 1, max = 50) String keyword,
            @RequestParam @Min(1) @Max(100) Integer pageSize) {
        return ResponseEntity.ok(userService.search(keyword, pageSize));
    }
}
```

3. **è‡ªå®šä¹‰éªŒè¯æ³¨è§£**
```java
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = PhoneValidator.class)
@Documented
public @interface Phone {
    String message() default "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}

public class PhoneValidator implements ConstraintValidator<Phone, String> {
    
    private static final Pattern PHONE_PATTERN = Pattern.compile("^1[3-9]\\d{9}$");
    
    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        if (value == null || value.isEmpty()) {
            return true; // ç©ºå€¼ç”±@NotBlankç­‰æ³¨è§£å¤„ç†
        }
        return PHONE_PATTERN.matcher(value).matches();
    }
}
```

4. **éªŒè¯å¼‚å¸¸å¤„ç†**
```java
@RestControllerAdvice
public class ValidationExceptionHandler {
    
    // å¤„ç†è¯·æ±‚ä½“éªŒè¯å¼‚å¸¸
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<Map<String, Object>> handleMethodArgumentNotValid(
            MethodArgumentNotValidException ex) {
        
        Map<String, Object> errors = new HashMap<>();
        ex.getBindingResult().getFieldErrors().forEach(error -> {
            errors.put(error.getField(), error.getDefaultMessage());
        });
        
        Map<String, Object> response = new HashMap<>();
        response.put("code", "VALIDATION_ERROR");
        response.put("message", "å‚æ•°éªŒè¯å¤±è´¥");
        response.put("errors", errors);
        
        return ResponseEntity.badRequest().body(response);
    }
    
    // å¤„ç†å‚æ•°éªŒè¯å¼‚å¸¸
    @ExceptionHandler(ConstraintViolationException.class)
    public ResponseEntity<Map<String, Object>> handleConstraintViolation(
            ConstraintViolationException ex) {
        
        Map<String, String> errors = new HashMap<>();
        ex.getConstraintViolations().forEach(violation -> {
            String propertyPath = violation.getPropertyPath().toString();
            String message = violation.getMessage();
            errors.put(propertyPath, message);
        });
        
        Map<String, Object> response = new HashMap<>();
        response.put("code", "VALIDATION_ERROR");
        response.put("message", "å‚æ•°éªŒè¯å¤±è´¥");
        response.put("errors", errors);
        
        return ResponseEntity.badRequest().body(response);
    }
}
```

**Q10: SpringBootä¸­å¦‚ä½•å®ç°è·¨åŸŸå¤„ç†ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootæä¾›å¤šç§è·¨åŸŸå¤„ç†æ–¹å¼ï¼š

1. **@CrossOriginæ³¨è§£**
```java
@RestController
@CrossOrigin(origins = "http://localhost:3000", maxAge = 3600)
public class UserController {
    
    @CrossOrigin(origins = "http://localhost:8080")
    @GetMapping("/users")
    public List<User> getUsers() {
        return userService.findAll();
    }
}
```

2. **å…¨å±€CORSé…ç½®**
```java
@Configuration
public class CorsConfig implements WebMvcConfigurer {
    
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
                .allowedOrigins("http://localhost:3000", "http://localhost:8080")
                .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS")
                .allowedHeaders("*")
                .allowCredentials(true)
                .maxAge(3600);
    }
}
```

3. **CorsFilteré…ç½®**
```java
@Configuration
public class CorsConfig {
    
    @Bean
    public CorsFilter corsFilter() {
        CorsConfiguration config = new CorsConfiguration();
        config.setAllowCredentials(true);
        config.addAllowedOrigin("http://localhost:3000");
        config.addAllowedHeader("*");
        config.addAllowedMethod("*");
        config.setMaxAge(3600L);
        
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", config);
        
        return new CorsFilter(source);
    }
}
```

4. **é…ç½®æ–‡ä»¶æ–¹å¼**
```yaml
spring:
  web:
    cors:
      allowed-origins: "http://localhost:3000,http://localhost:8080"
      allowed-methods: "GET,POST,PUT,DELETE,OPTIONS"
      allowed-headers: "*"
      allow-credentials: true
      max-age: 3600
```

**Q11: SpringBootä¸­å¦‚ä½•å®ç°æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Ÿ**

**ç­”æ¡ˆï¼š**

1. **æ–‡ä»¶ä¸Šä¼ é…ç½®**
```yaml
spring:
  servlet:
    multipart:
      enabled: true
      max-file-size: 10MB
      max-request-size: 100MB
      file-size-threshold: 2KB
      location: /tmp
```

2. **æ–‡ä»¶ä¸Šä¼ å®ç°**
```java
@RestController
public class FileController {
    
    @Value("${file.upload.path:/tmp/uploads}")
    private String uploadPath;
    
    @PostMapping("/upload")
    public ResponseEntity<Map<String, Object>> uploadFile(
            @RequestParam("file") MultipartFile file) {
        
        if (file.isEmpty()) {
            return ResponseEntity.badRequest()
                .body(Map.of("message", "æ–‡ä»¶ä¸èƒ½ä¸ºç©º"));
        }
        
        try {
            // æ£€æŸ¥æ–‡ä»¶ç±»å‹
            String contentType = file.getContentType();
            if (!isValidFileType(contentType)) {
                return ResponseEntity.badRequest()
                    .body(Map.of("message", "ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹"));
            }
            
            // ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å
            String originalFilename = file.getOriginalFilename();
            String extension = getFileExtension(originalFilename);
            String filename = UUID.randomUUID().toString() + extension;
            
            // åˆ›å»ºä¸Šä¼ ç›®å½•
            Path uploadDir = Paths.get(uploadPath);
            if (!Files.exists(uploadDir)) {
                Files.createDirectories(uploadDir);
            }
            
            // ä¿å­˜æ–‡ä»¶
            Path filePath = uploadDir.resolve(filename);
            Files.copy(file.getInputStream(), filePath, StandardCopyOption.REPLACE_EXISTING);
            
            Map<String, Object> response = new HashMap<>();
            response.put("filename", filename);
            response.put("originalFilename", originalFilename);
            response.put("size", file.getSize());
            response.put("contentType", contentType);
            response.put("url", "/download/" + filename);
            
            return ResponseEntity.ok(response);
            
        } catch (IOException e) {
            return ResponseEntity.status(500)
                .body(Map.of("message", "æ–‡ä»¶ä¸Šä¼ å¤±è´¥: " + e.getMessage()));
        }
    }
    
    @PostMapping("/upload/multiple")
    public ResponseEntity<List<Map<String, Object>>> uploadMultipleFiles(
            @RequestParam("files") MultipartFile[] files) {
        
        List<Map<String, Object>> results = new ArrayList<>();
        
        for (MultipartFile file : files) {
            if (!file.isEmpty()) {
                // å¤„ç†æ¯ä¸ªæ–‡ä»¶ï¼ˆå¤ç”¨ä¸Šé¢çš„é€»è¾‘ï¼‰
                // ...
            }
        }
        
        return ResponseEntity.ok(results);
    }
    
    private boolean isValidFileType(String contentType) {
        return contentType != null && (
            contentType.startsWith("image/") ||
            contentType.equals("application/pdf") ||
            contentType.equals("application/msword") ||
            contentType.equals("application/vnd.openxmlformats-officedocument.wordprocessingml.document")
        );
    }
    
    private String getFileExtension(String filename) {
        if (filename == null || filename.lastIndexOf(".") == -1) {
            return "";
        }
        return filename.substring(filename.lastIndexOf("."));
    }
}
```

3. **æ–‡ä»¶ä¸‹è½½å®ç°**
```java
@GetMapping("/download/{filename}")
public ResponseEntity<Resource> downloadFile(@PathVariable String filename) {
    try {
        Path filePath = Paths.get(uploadPath).resolve(filename);
        Resource resource = new UrlResource(filePath.toUri());
        
        if (!resource.exists() || !resource.isReadable()) {
            return ResponseEntity.notFound().build();
        }
        
        // è·å–æ–‡ä»¶çš„MIMEç±»å‹
        String contentType = Files.probeContentType(filePath);
        if (contentType == null) {
            contentType = "application/octet-stream";
        }
        
        return ResponseEntity.ok()
                .contentType(MediaType.parseMediaType(contentType))
                .header(HttpHeaders.CONTENT_DISPOSITION, 
                       "attachment; filename=\"" + resource.getFilename() + "\"")
                .body(resource);
                
    } catch (IOException e) {
        return ResponseEntity.status(500).build();
    }
}

@GetMapping("/preview/{filename}")
public ResponseEntity<Resource> previewFile(@PathVariable String filename) {
    try {
        Path filePath = Paths.get(uploadPath).resolve(filename);
        Resource resource = new UrlResource(filePath.toUri());
        
        if (!resource.exists() || !resource.isReadable()) {
            return ResponseEntity.notFound().build();
        }
        
        String contentType = Files.probeContentType(filePath);
        if (contentType == null) {
            contentType = "application/octet-stream";
        }
        
        return ResponseEntity.ok()
                .contentType(MediaType.parseMediaType(contentType))
                .header(HttpHeaders.CONTENT_DISPOSITION, "inline")
                .body(resource);
                
    } catch (IOException e) {
        return ResponseEntity.status(500).build();
    }
}
```

**Q12: SpringBootä¸­å¦‚ä½•å®ç°æ¥å£é™æµï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°æ¥å£é™æµï¼š

1. **ä½¿ç”¨Redis + Luaè„šæœ¬å®ç°ä»¤ç‰Œæ¡¶ç®—æ³•**
```java
@Component
public class RedisRateLimiter {
    
    @Autowired
    private RedisTemplate<String, String> redisTemplate;
    
    private static final String RATE_LIMIT_SCRIPT = 
        "local key = KEYS[1]\n" +
        "local capacity = tonumber(ARGV[1])\n" +
        "local tokens = tonumber(ARGV[2])\n" +
        "local interval = tonumber(ARGV[3])\n" +
        "local current = redis.call('hmget', key, 'tokens', 'last_refill')\n" +
        "local now = redis.call('time')[1]\n" +
        "if current[1] == false then\n" +
        "    redis.call('hmset', key, 'tokens', capacity, 'last_refill', now)\n" +
        "    redis.call('expire', key, interval * 2)\n" +
        "    return {1, capacity - tokens}\n" +
        "end\n" +
        "local last_refill = tonumber(current[2])\n" +
        "local current_tokens = tonumber(current[1])\n" +
        "local elapsed = math.max(0, now - last_refill)\n" +
        "local new_tokens = math.min(capacity, current_tokens + elapsed * capacity / interval)\n" +
        "if new_tokens >= tokens then\n" +
        "    redis.call('hmset', key, 'tokens', new_tokens - tokens, 'last_refill', now)\n" +
        "    return {1, new_tokens - tokens}\n" +
        "else\n" +
        "    redis.call('hmset', key, 'tokens', new_tokens, 'last_refill', now)\n" +
        "    return {0, new_tokens}\n" +
        "end";
    
    public boolean isAllowed(String key, int capacity, int tokens, int intervalInSeconds) {
        DefaultRedisScript<List> script = new DefaultRedisScript<>();
        script.setScriptText(RATE_LIMIT_SCRIPT);
        script.setResultType(List.class);
        
        List<Long> result = redisTemplate.execute(script, 
            Collections.singletonList(key), 
            String.valueOf(capacity), 
            String.valueOf(tokens), 
            String.valueOf(intervalInSeconds));
        
        return result != null && result.get(0) == 1L;
    }
}
```

2. **è‡ªå®šä¹‰é™æµæ³¨è§£**
```java
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface RateLimit {
    String key() default "";
    int capacity() default 100;
    int tokens() default 1;
    int interval() default 60;
    String message() default "è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•";
}

@Aspect
@Component
public class RateLimitAspect {
    
    @Autowired
    private RedisRateLimiter rateLimiter;
    
    @Around("@annotation(rateLimit)")
    public Object around(ProceedingJoinPoint joinPoint, RateLimit rateLimit) throws Throwable {
        String key = generateKey(joinPoint, rateLimit);
        
        if (!rateLimiter.isAllowed(key, rateLimit.capacity(), rateLimit.tokens(), rateLimit.interval())) {
            throw new RateLimitException(rateLimit.message());
        }
        
        return joinPoint.proceed();
    }
    
    private String generateKey(ProceedingJoinPoint joinPoint, RateLimit rateLimit) {
        if (StringUtils.hasText(rateLimit.key())) {
            return rateLimit.key();
        }
        
        // åŸºäºæ–¹æ³•ç­¾åå’Œç”¨æˆ·IDç”Ÿæˆkey
        String methodName = joinPoint.getSignature().toShortString();
        String userId = getCurrentUserId(); // è·å–å½“å‰ç”¨æˆ·ID
        return "rate_limit:" + methodName + ":" + userId;
    }
    
    private String getCurrentUserId() {
        // ä»SecurityContextæˆ–è¯·æ±‚ä¸­è·å–ç”¨æˆ·ID
        return "anonymous";
    }
}
```

3. **ä½¿ç”¨é™æµæ³¨è§£**
```java
@RestController
public class ApiController {
    
    @RateLimit(capacity = 10, tokens = 1, interval = 60, message = "æ¯åˆ†é’Ÿæœ€å¤šè®¿é—®10æ¬¡")
    @GetMapping("/api/data")
    public ResponseEntity<String> getData() {
        return ResponseEntity.ok("data");
    }
    
    @RateLimit(key = "upload", capacity = 5, tokens = 1, interval = 300, message = "æ¯5åˆ†é’Ÿæœ€å¤šä¸Šä¼ 5æ¬¡")
    @PostMapping("/api/upload")
    public ResponseEntity<String> upload(@RequestParam MultipartFile file) {
        return ResponseEntity.ok("uploaded");
    }
}
```

4. **é™æµå¼‚å¸¸å¤„ç†**
```java
@RestControllerAdvice
public class RateLimitExceptionHandler {
    
    @ExceptionHandler(RateLimitException.class)
    public ResponseEntity<Map<String, Object>> handleRateLimit(RateLimitException e) {
        Map<String, Object> response = new HashMap<>();
        response.put("code", "RATE_LIMIT_EXCEEDED");
        response.put("message", e.getMessage());
        response.put("timestamp", System.currentTimeMillis());
        
        return ResponseEntity.status(429).body(response);
    }
}

public class RateLimitException extends RuntimeException {
    public RateLimitException(String message) {
        super(message);
    }
}
```

1. **å®ä½“ç±»éªŒè¯**
```java
public class User {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-20ä¹‹é—´")
    private String username;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @Min(value = 18, message = "å¹´é¾„ä¸èƒ½å°äº18")
    private Integer age;
}
```

2. **ControlleréªŒè¯**
```java
@RestController
public class UserController {
    
    @PostMapping("/users")
    public ResponseEntity<User> createUser(@Valid @RequestBody User user) {
        // éªŒè¯å¤±è´¥ä¼šæŠ›å‡ºMethodArgumentNotValidException
        return ResponseEntity.ok(userService.save(user));
    }
    
    @GetMapping("/users/{id}")
    public User getUser(@PathVariable @Min(1) Long id) {
        return userService.findById(id);
    }
}
```

3. **è‡ªå®šä¹‰éªŒè¯å™¨**
```java
@Target({ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = PhoneValidator.class)
public @interface Phone {
    String message() default "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}

public class PhoneValidator implements ConstraintValidator<Phone, String> {
    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        return value != null && value.matches("^1[3-9]\\d{9}$");
    }
}
```

**Q10: SpringBootä¸­å¦‚ä½•å®ç°è·¨åŸŸå¤„ç†ï¼Ÿ**

**ç­”æ¡ˆï¼š**
SpringBootæä¾›å¤šç§è·¨åŸŸå¤„ç†æ–¹å¼ï¼š

1. **@CrossOriginæ³¨è§£**
```java
@RestController
@CrossOrigin(origins = "http://localhost:3000")
public class ApiController {
    
    @CrossOrigin(origins = "http://example.com", maxAge = 3600)
    @GetMapping("/data")
    public List<Data> getData() {
        return dataService.findAll();
    }
}
```

2. **å…¨å±€CORSé…ç½®**
```java
@Configuration
public class CorsConfig implements WebMvcConfigurer {
    
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/api/**")
                .allowedOrigins("http://localhost:3000", "https://example.com")
                .allowedMethods("GET", "POST", "PUT", "DELETE")
                .allowedHeaders("*")
                .allowCredentials(true)
                .maxAge(3600);
    }
}
```

3. **CorsFilteré…ç½®**
```java
@Bean
public CorsFilter corsFilter() {
    CorsConfiguration config = new CorsConfiguration();
    config.setAllowCredentials(true);
    config.addAllowedOrigin("http://localhost:3000");
    config.addAllowedHeader("*");
    config.addAllowedMethod("*");
    
    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
    source.registerCorsConfiguration("/api/**", config);
    
    return new CorsFilter(source);
}
```tSelector.class)
        
        // 2. åŠ è½½META-INF/spring.factories
        List<String> configurations = SpringFactoriesLoader.loadFactoryNames(
            EnableAutoConfiguration.class, classLoader);
        
        // 3. è¿‡æ»¤éœ€è¦è‡ªåŠ¨é…ç½®çš„ç±»
        configurations = filter(configurations, autoConfigurationMetadata);
        
        // 4. åŠ è½½è‡ªåŠ¨é…ç½®ç±»
        // ä¾‹å¦‚ï¼šDataSourceAutoConfiguration, WebMvcAutoConfigurationç­‰
    }
    
    /**
     * æ¡ä»¶æ³¨è§£å·¥ä½œåŸç†
     */
    public void conditionalAnnotationAnalysis() {
        // å¸¸ç”¨æ¡ä»¶æ³¨è§£
        // @ConditionalOnClassï¼šå½“ç±»è·¯å¾„ä¸‹æœ‰æŒ‡å®šçš„ç±»æ—¶
        // @ConditionalOnMissingClassï¼šå½“ç±»è·¯å¾„ä¸‹æ²¡æœ‰æŒ‡å®šçš„ç±»æ—¶
        // @ConditionalOnBeanï¼šå½“å®¹å™¨ä¸­æœ‰æŒ‡å®šçš„Beanæ—¶
        // @ConditionalOnMissingBeanï¼šå½“å®¹å™¨ä¸­æ²¡æœ‰æŒ‡å®šçš„Beanæ—¶
        // @ConditionalOnPropertyï¼šå½“é…ç½®æ–‡ä»¶ä¸­æœ‰æŒ‡å®šçš„å±æ€§æ—¶
        // @ConditionalOnResourceï¼šå½“ç±»è·¯å¾„ä¸‹æœ‰æŒ‡å®šçš„èµ„æºæ—¶
        // @ConditionalOnWebApplicationï¼šå½“åº”ç”¨æ˜¯Webåº”ç”¨æ—¶
        // @ConditionalOnNotWebApplicationï¼šå½“åº”ç”¨ä¸æ˜¯Webåº”ç”¨æ—¶
        
        // æ¡ä»¶æ³¨è§£å¤„ç†æµç¨‹
        // 1. æ”¶é›†æ‰€æœ‰@Conditionalæ³¨è§£
        // 2. åˆ›å»ºå¯¹åº”çš„Conditionå®ä¾‹
        // 3. è°ƒç”¨Condition.matches()æ–¹æ³•åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³
        // 4. æ ¹æ®ç»“æœå†³å®šæ˜¯å¦åŠ è½½Bean
    }
}
```

## æµ‹è¯•æ¡†æ¶

SpringBootæµ‹è¯•æ¡†æ¶å›¾ï¼š

```mermaid
graph TD
    A[SpringBootæµ‹è¯•] --> B[å•å…ƒæµ‹è¯•]
    A --> C[é›†æˆæµ‹è¯•]
    A --> D[Webæµ‹è¯•]
    A --> E[æ€§èƒ½æµ‹è¯•]
    
    B --> B1[JUnit 5]
    B --> B2[Mockito]
    B --> B3[AssertJ]
    
    C --> C1[@SpringBootTest]
    C --> C2[TestRestTemplate]
    C --> C3[TestConfiguration]
    
    D --> D1[MockMvc]
    D --> D2[WebTestClient]
    D --> D3[@WebMvcTest]
    
    E --> E1[JMeter]
    E --> E2[Gatling]
    E --> E3[Spring Cloud Contract]
```

### å•å…ƒæµ‹è¯•

```java
/**
 * å•å…ƒæµ‹è¯•ç¤ºä¾‹ - ä½¿ç”¨JUnit 5 + Mockito
 */
@ExtendWith(MockitoExtension.class)
class UserServiceTest {
    
    @Mock
    private UserRepository userRepository;
    
    @Mock
    private EmailService emailService;
    
    @InjectMocks
    private UserService userService;
    
    @Test
    @DisplayName("æ ¹æ®IDè·å–ç”¨æˆ· - æˆåŠŸåœºæ™¯")
    void testGetUserById_Success() {
        // Given - å‡†å¤‡æµ‹è¯•æ•°æ®
        Long userId = 1L;
        User expectedUser = User.builder()
                .id(userId)
                .username("testuser")
                .email("test@example.com")
                .status(UserStatus.ACTIVE)
                .build();
        
        when(userRepository.findById(userId)).thenReturn(Optional.of(expectedUser));
        
        // When - æ‰§è¡Œæµ‹è¯•æ–¹æ³•
        User actualUser = userService.getUserById(userId);
        
        // Then - éªŒè¯ç»“æœ
        assertThat(actualUser).isNotNull();
        assertThat(actualUser.getId()).isEqualTo(userId);
        assertThat(actualUser.getUsername()).isEqualTo("testuser");
        assertThat(actualUser.getEmail()).isEqualTo("test@example.com");
        
        verify(userRepository).findById(userId);
        verifyNoMoreInteractions(userRepository);
    }
    
    @Test
    @DisplayName("æ ¹æ®IDè·å–ç”¨æˆ· - ç”¨æˆ·ä¸å­˜åœ¨")
    void testGetUserById_UserNotFound() {
        // Given
        Long userId = 999L;
        when(userRepository.findById(userId)).thenReturn(Optional.empty());
        
        // When & Then
        assertThatThrownBy(() -> userService.getUserById(userId))
                .isInstanceOf(UserNotFoundException.class)
                .hasMessage("ç”¨æˆ·ä¸å­˜åœ¨: " + userId);
        
        verify(userRepository).findById(userId);
    }
    
    @Test
    @DisplayName("åˆ›å»ºç”¨æˆ· - æˆåŠŸåœºæ™¯")
    void testCreateUser_Success() {
        // Given
        CreateUserRequest request = CreateUserRequest.builder()
                .username("newuser")
                .email("newuser@example.com")
                .password("password123")
                .build();
        
        User savedUser = User.builder()
                .id(1L)
                .username(request.getUsername())
                .email(request.getEmail())
                .status(UserStatus.ACTIVE)
                .createdAt(LocalDateTime.now())
                .build();
        
        when(userRepository.existsByUsername(request.getUsername())).thenReturn(false);
        when(userRepository.existsByEmail(request.getEmail())).thenReturn(false);
        when(userRepository.save(any(User.class))).thenReturn(savedUser);
        doNothing().when(emailService).sendWelcomeEmail(any(User.class));
        
        // When
        User result = userService.createUser(request);
        
        // Then
        assertThat(result).isNotNull();
        assertThat(result.getId()).isEqualTo(1L);
        assertThat(result.getUsername()).isEqualTo("newuser");
        assertThat(result.getEmail()).isEqualTo("newuser@example.com");
        assertThat(result.getStatus()).isEqualTo(UserStatus.ACTIVE);
        
        verify(userRepository).existsByUsername(request.getUsername());
        verify(userRepository).existsByEmail(request.getEmail());
        verify(userRepository).save(any(User.class));
        verify(emailService).sendWelcomeEmail(any(User.class));
    }
    
    @Test
    @DisplayName("åˆ›å»ºç”¨æˆ· - ç”¨æˆ·åå·²å­˜åœ¨")
    void testCreateUser_UsernameExists() {
        // Given
        CreateUserRequest request = CreateUserRequest.builder()
                .username("existinguser")
                .email("test@example.com")
                .password("password123")
                .build();
        
        when(userRepository.existsByUsername(request.getUsername())).thenReturn(true);
        
        // When & Then
        assertThatThrownBy(() -> userService.createUser(request))
                .isInstanceOf(UserAlreadyExistsException.class)
                .hasMessage("ç”¨æˆ·åå·²å­˜åœ¨: " + request.getUsername());
        
        verify(userRepository).existsByUsername(request.getUsername());
        verify(userRepository, never()).save(any(User.class));
        verify(emailService, never()).sendWelcomeEmail(any(User.class));
    }
    
    @ParameterizedTest
    @DisplayName("éªŒè¯ç”¨æˆ·åæ ¼å¼")
    @ValueSource(strings = {"", " ", "ab", "a".repeat(21)})
    void testValidateUsername_InvalidFormats(String username) {
        // Given
        CreateUserRequest request = CreateUserRequest.builder()
                .username(username)
                .email("test@example.com")
                .password("password123")
                .build();
        
        // When & Then
        assertThatThrownBy(() -> userService.createUser(request))
                .isInstanceOf(ValidationException.class);
    }
    
    @Test
    @DisplayName("æ‰¹é‡åˆ é™¤ç”¨æˆ·")
    void testDeleteUsers_Batch() {
        // Given
        List<Long> userIds = Arrays.asList(1L, 2L, 3L);
        
        when(userRepository.findAllById(userIds)).thenReturn(Arrays.asList(
                User.builder().id(1L).username("user1").build(),
                User.builder().id(2L).username("user2").build(),
                User.builder().id(3L).username("user3").build()
        ));
        
        // When
        userService.deleteUsers(userIds);
        
        // Then
        verify(userRepository).findAllById(userIds);
        verify(userRepository).deleteAllById(userIds);
    }
    
    @Nested
    @DisplayName("ç”¨æˆ·çŠ¶æ€ç®¡ç†æµ‹è¯•")
    class UserStatusManagementTest {
        
        @Test
        @DisplayName("æ¿€æ´»ç”¨æˆ·")
        void testActivateUser() {
            // Given
            Long userId = 1L;
            User user = User.builder()
                    .id(userId)
                    .username("testuser")
                    .status(UserStatus.INACTIVE)
                    .build();
            
            when(userRepository.findById(userId)).thenReturn(Optional.of(user));
            when(userRepository.save(any(User.class))).thenAnswer(invocation -> invocation.getArgument(0));
            
            // When
            User result = userService.activateUser(userId);
            
            // Then
            assertThat(result.getStatus()).isEqualTo(UserStatus.ACTIVE);
            verify(userRepository).save(user);
        }
        
        @Test
        @DisplayName("åœç”¨ç”¨æˆ·")
        void testDeactivateUser() {
            // Given
            Long userId = 1L;
            User user = User.builder()
                    .id(userId)
                    .username("testuser")
                    .status(UserStatus.ACTIVE)
                    .build();
            
            when(userRepository.findById(userId)).thenReturn(Optional.of(user));
            when(userRepository.save(any(User.class))).thenAnswer(invocation -> invocation.getArgument(0));
            
            // When
            User result = userService.deactivateUser(userId);
            
            // Then
            assertThat(result.getStatus()).isEqualTo(UserStatus.INACTIVE);
            verify(userRepository).save(user);
        }
    }
}

/**
 * Repositoryå±‚å•å…ƒæµ‹è¯•
 */
@DataJpaTest
@TestPropertySource(properties = {
    "spring.jpa.hibernate.ddl-auto=create-drop",
    "spring.datasource.url=jdbc:h2:mem:testdb",
    "spring.jpa.show-sql=true"
})
class UserRepositoryTest {
    
    @Autowired
    private TestEntityManager entityManager;
    
    @Autowired
    private UserRepository userRepository;
    
    @Test
    @DisplayName("æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·")
    void testFindByUsername() {
        // Given
        User user = User.builder()
                .username("testuser")
                .email("test@example.com")
                .password("password")
                .status(UserStatus.ACTIVE)
                .build();
        
        entityManager.persistAndFlush(user);
        
        // When
        Optional<User> found = userRepository.findByUsername("testuser");
        
        // Then
        assertThat(found).isPresent();
        assertThat(found.get().getUsername()).isEqualTo("testuser");
        assertThat(found.get().getEmail()).isEqualTo("test@example.com");
    }
    
    @Test
    @DisplayName("æ ¹æ®é‚®ç®±æŸ¥æ‰¾ç”¨æˆ·")
    void testFindByEmail() {
        // Given
        User user = User.builder()
                .username("testuser")
                .email("test@example.com")
                .password("password")
                .status(UserStatus.ACTIVE)
                .build();
        
        entityManager.persistAndFlush(user);
        
        // When
        Optional<User> found = userRepository.findByEmail("test@example.com");
        
        // Then
        assertThat(found).isPresent();
        assertThat(found.get().getEmail()).isEqualTo("test@example.com");
    }
    
    @Test
    @DisplayName("æ ¹æ®çŠ¶æ€æŸ¥æ‰¾ç”¨æˆ·")
    void testFindByStatus() {
        // Given
        User activeUser = User.builder()
                .username("activeuser")
                .email("active@example.com")
                .password("password")
                .status(UserStatus.ACTIVE)
                .build();
        
        User inactiveUser = User.builder()
                .username("inactiveuser")
                .email("inactive@example.com")
                .password("password")
                .status(UserStatus.INACTIVE)
                .build();
        
        entityManager.persistAndFlush(activeUser);
        entityManager.persistAndFlush(inactiveUser);
        
        // When
        List<User> activeUsers = userRepository.findByStatus(UserStatus.ACTIVE);
        List<User> inactiveUsers = userRepository.findByStatus(UserStatus.INACTIVE);
        
        // Then
        assertThat(activeUsers).hasSize(1);
        assertThat(activeUsers.get(0).getUsername()).isEqualTo("activeuser");
        
        assertThat(inactiveUsers).hasSize(1);
        assertThat(inactiveUsers.get(0).getUsername()).isEqualTo("inactiveuser");
    }
    
    @Test
    @DisplayName("è‡ªå®šä¹‰æŸ¥è¯¢ - æ ¹æ®ç”¨æˆ·åæ¨¡ç³ŠæŸ¥æ‰¾")
    void testFindByUsernameContaining() {
        // Given
        User user1 = User.builder()
                .username("testuser1")
                .email("test1@example.com")
                .password("password")
                .status(UserStatus.ACTIVE)
                .build();
        
        User user2 = User.builder()
                .username("testuser2")
                .email("test2@example.com")
                .password("password")
                .status(UserStatus.ACTIVE)
                .build();
        
        User user3 = User.builder()
                .username("admin")
                .email("admin@example.com")
                .password("password")
                .status(UserStatus.ACTIVE)
                .build();
        
        entityManager.persistAndFlush(user1);
        entityManager.persistAndFlush(user2);
        entityManager.persistAndFlush(user3);
        
        // When
        List<User> users = userRepository.findByUsernameContaining("test");
        
        // Then
        assertThat(users).hasSize(2);
        assertThat(users).extracting(User::getUsername)
                .containsExactlyInAnyOrder("testuser1", "testuser2");
    }
}
```

### é›†æˆæµ‹è¯•

```java
/**
 * SpringBooté›†æˆæµ‹è¯•ç¤ºä¾‹
 */
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@TestPropertySource(properties = {
    "spring.datasource.url=jdbc:h2:mem:testdb",
    "spring.jpa.hibernate.ddl-auto=create-drop"
})
@Transactional
@Rollback
class UserIntegrationTest {
    
    @Autowired
    private TestRestTemplate restTemplate;
    
    @Autowired
    private UserRepository userRepository;
    
    @Autowired
    private UserService userService;
    
    @LocalServerPort
    private int port;
    
    private String baseUrl;
    
    @BeforeEach
    void setUp() {
        baseUrl = "http://localhost:" + port + "/api";
        
        // æ¸…ç†æµ‹è¯•æ•°æ®
        userRepository.deleteAll();
        
        // å‡†å¤‡æµ‹è¯•æ•°æ®
        User testUser = User.builder()
                .username("testuser")
                .email("test@example.com")
                .password("password123")
                .status(UserStatus.ACTIVE)
                .build();
        userRepository.save(testUser);
    }
    
    @Test
    @DisplayName("é›†æˆæµ‹è¯• - è·å–ç”¨æˆ·åˆ—è¡¨")
    void testGetUsers() {
        // When
        ResponseEntity<User[]> response = restTemplate.getForEntity(
                baseUrl + "/users", User[].class);
        
        // Then
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
        assertThat(response.getBody()).isNotNull();
        assertThat(response.getBody()).hasSize(1);
        assertThat(response.getBody()[0].getUsername()).isEqualTo("testuser");
    }
    
    @Test
    @DisplayName("é›†æˆæµ‹è¯• - åˆ›å»ºç”¨æˆ·")
    void testCreateUser() {
        // Given
        CreateUserRequest request = CreateUserRequest.builder()
                .username("newuser")
                .email("newuser@example.com")
                .password("password123")
                .build();
        
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_JSON);
        HttpEntity<CreateUserRequest> entity = new HttpEntity<>(request, headers);
        
        // When
        ResponseEntity<User> response = restTemplate.postForEntity(
                baseUrl + "/users", entity, User.class);
        
        // Then
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.CREATED);
        assertThat(response.getBody()).isNotNull();
        assertThat(response.getBody().getUsername()).isEqualTo("newuser");
        assertThat(response.getBody().getEmail()).isEqualTo("newuser@example.com");
        
        // éªŒè¯æ•°æ®åº“ä¸­çš„æ•°æ®
        Optional<User> savedUser = userRepository.findByUsername("newuser");
        assertThat(savedUser).isPresent();
        assertThat(savedUser.get().getEmail()).isEqualTo("newuser@example.com");
    }
    
    @Test
    @DisplayName("é›†æˆæµ‹è¯• - æ›´æ–°ç”¨æˆ·")
    void testUpdateUser() {
        // Given
        User existingUser = userRepository.findByUsername("testuser").orElseThrow();
        
        UpdateUserRequest request = UpdateUserRequest.builder()
                .email("updated@example.com")
                .build();
        
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_JSON);
        HttpEntity<UpdateUserRequest> entity = new HttpEntity<>(request, headers);
        
        // When
        ResponseEntity<User> response = restTemplate.exchange(
                baseUrl + "/users/" + existingUser.getId(),
                HttpMethod.PUT,
                entity,
                User.class);
        
        // Then
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
        assertThat(response.getBody()).isNotNull();
        assertThat(response.getBody().getEmail()).isEqualTo("updated@example.com");
        
        // éªŒè¯æ•°æ®åº“ä¸­çš„æ•°æ®
        User updatedUser = userRepository.findById(existingUser.getId()).orElseThrow();
        assertThat(updatedUser.getEmail()).isEqualTo("updated@example.com");
    }
    
    @Test
    @DisplayName("é›†æˆæµ‹è¯• - åˆ é™¤ç”¨æˆ·")
    void testDeleteUser() {
        // Given
        User existingUser = userRepository.findByUsername("testuser").orElseThrow();
        
        // When
        ResponseEntity<Void> response = restTemplate.exchange(
                baseUrl + "/users/" + existingUser.getId(),
                HttpMethod.DELETE,
                null,
                Void.class);
        
        // Then
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.NO_CONTENT);
        
        // éªŒè¯ç”¨æˆ·å·²è¢«åˆ é™¤
        Optional<User> deletedUser = userRepository.findById(existingUser.getId());
        assertThat(deletedUser).isEmpty();
    }
    
    @Test
    @DisplayName("é›†æˆæµ‹è¯• - ç”¨æˆ·ä¸å­˜åœ¨æ—¶è¿”å›404")
    void testGetUserNotFound() {
        // When
        ResponseEntity<String> response = restTemplate.getForEntity(
                baseUrl + "/users/999", String.class);
        
        // Then
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.NOT_FOUND);
    }
}

/**
 * ä½¿ç”¨TestContainersçš„é›†æˆæµ‹è¯•
 */
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@Testcontainers
class UserIntegrationTestWithTestContainers {
    
    @Container
    static MySQLContainer<?> mysql = new MySQLContainer<>("mysql:8.0")
            .withDatabaseName("testdb")
            .withUsername("test")
            .withPassword("test");
    
    @Container
    static GenericContainer<?> redis = new GenericContainer<>("redis:7-alpine")
            .withExposedPorts(6379);
    
    @Autowired
    private TestRestTemplate restTemplate;
    
    @Autowired
    private UserRepository userRepository;
    
    @LocalServerPort
    private int port;
    
    @DynamicPropertySource
    static void configureProperties(DynamicPropertyRegistry registry) {
        registry.add("spring.datasource.url", mysql::getJdbcUrl);
        registry.add("spring.datasource.username", mysql::getUsername);
        registry.add("spring.datasource.password", mysql::getPassword);
        registry.add("spring.redis.host", redis::getHost);
        registry.add("spring.redis.port", redis::getFirstMappedPort);
    }
    
    @Test
    @DisplayName("TestContainersé›†æˆæµ‹è¯• - ç”¨æˆ·CRUDæ“ä½œ")
    void testUserCrudOperations() {
        String baseUrl = "http://localhost:" + port + "/api";
        
        // åˆ›å»ºç”¨æˆ·
        CreateUserRequest createRequest = CreateUserRequest.builder()
                .username("testuser")
                .email("test@example.com")
                .password("password123")
                .build();
        
        ResponseEntity<User> createResponse = restTemplate.postForEntity(
                baseUrl + "/users", createRequest, User.class);
        
        assertThat(createResponse.getStatusCode()).isEqualTo(HttpStatus.CREATED);
        assertThat(createResponse.getBody()).isNotNull();
        
        Long userId = createResponse.getBody().getId();
        
        // æŸ¥è¯¢ç”¨æˆ·
        ResponseEntity<User> getResponse = restTemplate.getForEntity(
                baseUrl + "/users/" + userId, User.class);
        
        assertThat(getResponse.getStatusCode()).isEqualTo(HttpStatus.OK);
        assertThat(getResponse.getBody().getUsername()).isEqualTo("testuser");
        
        // æ›´æ–°ç”¨æˆ·
        UpdateUserRequest updateRequest = UpdateUserRequest.builder()
                .email("updated@example.com")
                .build();
        
        ResponseEntity<User> updateResponse = restTemplate.exchange(
                baseUrl + "/users/" + userId,
                HttpMethod.PUT,
                new HttpEntity<>(updateRequest),
                User.class);
        
        assertThat(updateResponse.getStatusCode()).isEqualTo(HttpStatus.OK);
        assertThat(updateResponse.getBody().getEmail()).isEqualTo("updated@example.com");
        
        // åˆ é™¤ç”¨æˆ·
        ResponseEntity<Void> deleteResponse = restTemplate.exchange(
                baseUrl + "/users/" + userId,
                HttpMethod.DELETE,
                null,
                Void.class);
        
        assertThat(deleteResponse.getStatusCode()).isEqualTo(HttpStatus.NO_CONTENT);
    }
}
```

### åˆ‡ç‰‡æµ‹è¯•

```java
/**
 * Webå±‚åˆ‡ç‰‡æµ‹è¯• - @WebMvcTest
 */
@WebMvcTest(UserController.class)
class UserControllerTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @MockBean
    private UserService userService;
    
    @Autowired
    private ObjectMapper objectMapper;
    
    @Test
    @DisplayName("Webå±‚æµ‹è¯• - è·å–ç”¨æˆ·åˆ—è¡¨")
    void testGetUsers() throws Exception {
        // Given
        List<User> users = Arrays.asList(
                User.builder().id(1L).username("user1").email("user1@example.com").build(),
                User.builder().id(2L).username("user2").email("user2@example.com").build()
        );
        
        when(userService.getAllUsers()).thenReturn(users);
        
        // When & Then
        mockMvc.perform(get("/api/users")
                        .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$", hasSize(2)))
                .andExpect(jsonPath("$[0].username", is("user1")))
                .andExpect(jsonPath("$[0].email", is("user1@example.com")))
                .andExpect(jsonPath("$[1].username", is("user2")))
                .andExpect(jsonPath("$[1].email", is("user2@example.com")))
                .andDo(print());
        
        verify(userService).getAllUsers();
    }
    
    @Test
    @DisplayName("Webå±‚æµ‹è¯• - æ ¹æ®IDè·å–ç”¨æˆ·")
    void testGetUserById() throws Exception {
        // Given
        Long userId = 1L;
        User user = User.builder()
                .id(userId)
                .username("testuser")
                .email("test@example.com")
                .build();
        
        when(userService.getUserById(userId)).thenReturn(user);
        
        // When & Then
        mockMvc.perform(get("/api/users/{id}", userId)
                        .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.id", is(userId.intValue())))
                .andExpect(jsonPath("$.username", is("testuser")))
                .andExpect(jsonPath("$.email", is("test@example.com")))
                .andDo(print());
        
        verify(userService).getUserById(userId);
    }
    
    @Test
    @DisplayName("Webå±‚æµ‹è¯• - åˆ›å»ºç”¨æˆ·")
    void testCreateUser() throws Exception {
        // Given
        CreateUserRequest request = CreateUserRequest.builder()
                .username("newuser")
                .email("newuser@example.com")
                .password("password123")
                .build();
        
        User createdUser = User.builder()
                .id(1L)
                .username(request.getUsername())
                .email(request.getEmail())
                .status(UserStatus.ACTIVE)
                .build();
        
        when(userService.createUser(any(CreateUserRequest.class))).thenReturn(createdUser);
        
        // When & Then
        mockMvc.perform(post("/api/users")
                        .contentType(MediaType.APPLICATION_JSON)
                        .content(objectMapper.writeValueAsString(request)))
                .andExpect(status().isCreated())
                .andExpect(jsonPath("$.id", is(1)))
                .andExpect(jsonPath("$.username", is("newuser")))
                .andExpect(jsonPath("$.email", is("newuser@example.com")))
                .andExpect(jsonPath("$.status", is("ACTIVE")))
                .andDo(print());
        
        verify(userService).createUser(any(CreateUserRequest.class));
    }
    
    @Test
    @DisplayName("Webå±‚æµ‹è¯• - å‚æ•°éªŒè¯å¤±è´¥")
    void testCreateUserWithInvalidData() throws Exception {
        // Given
        CreateUserRequest request = CreateUserRequest.builder()
                .username("") // ç©ºç”¨æˆ·å
                .email("invalid-email") // æ— æ•ˆé‚®ç®±
                .password("123") // å¯†ç å¤ªçŸ­
                .build();
        
        // When & Then
        mockMvc.perform(post("/api/users")
                        .contentType(MediaType.APPLICATION_JSON)
                        .content(objectMapper.writeValueAsString(request)))
                .andExpect(status().isBadRequest())
                .andExpect(jsonPath("$.code", is("VALIDATION_ERROR")))
                .andExpect(jsonPath("$.errors").exists())
                .andDo(print());
        
        verify(userService, never()).createUser(any(CreateUserRequest.class));
    }
    
    @Test
    @DisplayName("Webå±‚æµ‹è¯• - ç”¨æˆ·ä¸å­˜åœ¨å¼‚å¸¸")
    void testGetUserNotFound() throws Exception {
        // Given
        Long userId = 999L;
        when(userService.getUserById(userId)).thenThrow(new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨: " + userId));
        
        // When & Then
        mockMvc.perform(get("/api/users/{id}", userId)
                        .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isNotFound())
                .andExpect(jsonPath("$.code", is("USER_NOT_FOUND")))
                .andExpect(jsonPath("$.message", containsString("ç”¨æˆ·ä¸å­˜åœ¨")))
                .andDo(print());
        
        verify(userService).getUserById(userId);
    }
}

/**
 * JPAå±‚åˆ‡ç‰‡æµ‹è¯• - @DataJpaTest
 */
@DataJpaTest
@TestPropertySource(properties = {
    "spring.jpa.hibernate.ddl-auto=create-drop",
    "spring.jpa.show-sql=true"
})
class UserRepositorySliceTest {
    
    @Autowired
    private TestEntityManager entityManager;
    
    @Autowired
    private UserRepository userRepository;
    
    @Test
    @DisplayName("JPAå±‚æµ‹è¯• - ä¿å­˜å’ŒæŸ¥æ‰¾ç”¨æˆ·")
    void testSaveAndFindUser() {
        // Given
        User user = User.builder()
                .username("testuser")
                .email("test@example.com")
                .password("password123")
                .status(UserStatus.ACTIVE)
                .createdAt(LocalDateTime.now())
                .build();
        
        // When
        User savedUser = userRepository.save(user);
        entityManager.flush();
        
        // Then
        assertThat(savedUser.getId()).isNotNull();
        assertThat(savedUser.getUsername()).isEqualTo("testuser");
        assertThat(savedUser.getEmail()).isEqualTo("test@example.com");
        
        Optional<User> foundUser = userRepository.findById(savedUser.getId());
        assertThat(foundUser).isPresent();
        assertThat(foundUser.get().getUsername()).isEqualTo("testuser");
    }
    
    @Test
    @DisplayName("JPAå±‚æµ‹è¯• - è‡ªå®šä¹‰æŸ¥è¯¢æ–¹æ³•")
    void testCustomQueryMethods() {
        // Given
        User user1 = User.builder()
                .username("activeuser")
                .email("active@example.com")
                .password("password123")
                .status(UserStatus.ACTIVE)
                .build();
        
        User user2 = User.builder()
                .username("inactiveuser")
                .email("inactive@example.com")
                .password("password123")
                .status(UserStatus.INACTIVE)
                .build();
        
        entityManager.persistAndFlush(user1);
        entityManager.persistAndFlush(user2);
        
        // When & Then
        Optional<User> foundByUsername = userRepository.findByUsername("activeuser");
        assertThat(foundByUsername).isPresent();
        assertThat(foundByUsername.get().getStatus()).isEqualTo(UserStatus.ACTIVE);
        
        Optional<User> foundByEmail = userRepository.findByEmail("inactive@example.com");
        assertThat(foundByEmail).isPresent();
        assertThat(foundByEmail.get().getStatus()).isEqualTo(UserStatus.INACTIVE);
        
        List<User> activeUsers = userRepository.findByStatus(UserStatus.ACTIVE);
        assertThat(activeUsers).hasSize(1);
        assertThat(activeUsers.get(0).getUsername()).isEqualTo("activeuser");
        
        List<User> usersContainingUser = userRepository.findByUsernameContaining("user");
        assertThat(usersContainingUser).hasSize(2);
    }
    
    @Test
    @DisplayName("JPAå±‚æµ‹è¯• - åˆ†é¡µæŸ¥è¯¢")
    void testPagination() {
        // Given
        for (int i = 1; i <= 10; i++) {
            User user = User.builder()
                    .username("user" + i)
                    .email("user" + i + "@example.com")
                    .password("password123")
                    .status(UserStatus.ACTIVE)
                    .build();
            entityManager.persistAndFlush(user);
        }
        
        // When
        Pageable pageable = PageRequest.of(0, 5, Sort.by("username"));
        Page<User> userPage = userRepository.findAll(pageable);
        
        // Then
        assertThat(userPage.getTotalElements()).isEqualTo(10);
        assertThat(userPage.getTotalPages()).isEqualTo(2);
        assertThat(userPage.getContent()).hasSize(5);
        assertThat(userPage.getContent().get(0).getUsername()).isEqualTo("user1");
        assertThat(userPage.getContent().get(4).getUsername()).isEqualTo("user5");
    }
}

/**
 * JSONåºåˆ—åŒ–æµ‹è¯• - @JsonTest
 */
@JsonTest
class UserJsonTest {
    
    @Autowired
    private JacksonTester<User> userJson;
    
    @Autowired
    private JacksonTester<CreateUserRequest> createUserRequestJson;
    
    @Test
    @DisplayName("JSONæµ‹è¯• - Userå¯¹è±¡åºåˆ—åŒ–")
    void testUserSerialization() throws Exception {
        // Given
        User user = User.builder()
                .id(1L)
                .username("testuser")
                .email("test@example.com")
                .status(UserStatus.ACTIVE)
                .createdAt(LocalDateTime.of(2023, 10, 1, 12, 0, 0))
                .build();
        
        // When & Then
        assertThat(userJson.write(user))
                .hasJsonPathNumberValue("$.id", 1)
                .hasJsonPathStringValue("$.username", "testuser")
                .hasJsonPathStringValue("$.email", "test@example.com")
                .hasJsonPathStringValue("$.status", "ACTIVE")
                .hasJsonPathStringValue("$.createdAt", "2023-10-01T12:00:00");
    }
    
    @Test
    @DisplayName("JSONæµ‹è¯• - Userå¯¹è±¡ååºåˆ—åŒ–")
    void testUserDeserialization() throws Exception {
        // Given
        String json = """
                {
                    "id": 1,
                    "username": "testuser",
                    "email": "test@example.com",
                    "status": "ACTIVE",
                    "createdAt": "2023-10-01T12:00:00"
                }
                """;
        
        // When
        User user = userJson.parseObject(json);
        
        // Then
        assertThat(user.getId()).isEqualTo(1L);
        assertThat(user.getUsername()).isEqualTo("testuser");
        assertThat(user.getEmail()).isEqualTo("test@example.com");
        assertThat(user.getStatus()).isEqualTo(UserStatus.ACTIVE);
        assertThat(user.getCreatedAt()).isEqualTo(LocalDateTime.of(2023, 10, 1, 12, 0, 0));
    }
    
    @Test
    @DisplayName("JSONæµ‹è¯• - CreateUserRequestååºåˆ—åŒ–")
    void testCreateUserRequestDeserialization() throws Exception {
        // Given
        String json = """
                {
                    "username": "newuser",
                    "email": "newuser@example.com",
                    "password": "password123"
                }
                """;
        
        // When
        CreateUserRequest request = createUserRequestJson.parseObject(json);
        
        // Then
        assertThat(request.getUsername()).isEqualTo("newuser");
        assertThat(request.getEmail()).isEqualTo("newuser@example.com");
        assertThat(request.getPassword()).isEqualTo("password123");
    }
}

/**
 * Redisåˆ‡ç‰‡æµ‹è¯• - @DataRedisTest
 */
@DataRedisTest
class UserCacheTest {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    @Autowired
    private StringRedisTemplate stringRedisTemplate;
    
    @Test
    @DisplayName("Redisæµ‹è¯• - ç¼“å­˜ç”¨æˆ·æ•°æ®")
    void testCacheUserData() {
        // Given
        User user = User.builder()
                .id(1L)
                .username("testuser")
                .email("test@example.com")
                .status(UserStatus.ACTIVE)
                .build();
        
        String key = "user:" + user.getId();
        
        // When
        redisTemplate.opsForValue().set(key, user, Duration.ofMinutes(10));
        
        // Then
        Object cachedUser = redisTemplate.opsForValue().get(key);
        assertThat(cachedUser).isNotNull();
        assertThat(cachedUser).isInstanceOf(User.class);
        assertThat(((User) cachedUser).getUsername()).isEqualTo("testuser");
        
        // éªŒè¯è¿‡æœŸæ—¶é—´
        Long ttl = redisTemplate.getExpire(key, TimeUnit.SECONDS);
        assertThat(ttl).isGreaterThan(0);
        assertThat(ttl).isLessThanOrEqualTo(600); // 10åˆ†é’Ÿ
    }
    
    @Test
    @DisplayName("Redisæµ‹è¯• - å­—ç¬¦ä¸²æ“ä½œ")
    void testStringOperations() {
        // Given
        String key = "counter:user:login";
        
        // When
        stringRedisTemplate.opsForValue().increment(key);
        stringRedisTemplate.opsForValue().increment(key);
        stringRedisTemplate.opsForValue().increment(key);
        
        // Then
        String value = stringRedisTemplate.opsForValue().get(key);
        assertThat(value).isEqualTo("3");
    }
}
```
        user.setUsername("test");
        
        // æ¨¡æ‹ŸRepositoryè¡Œä¸º
        when(userRepository.findById(1L)).thenReturn(Optional.of(user));
        
        // æ‰§è¡Œæµ‹è¯•
        User result = userService.getUserById(1L);
        
        // éªŒè¯ç»“æœ
        assertThat(result).isNotNull();
        assertThat(result.getUsername()).isEqualTo("test");
        
        // éªŒè¯äº¤äº’
        verify(userRepository).findById(1L);
    }
}
```

### é›†æˆæµ‹è¯•

```java
/**
 * é›†æˆæµ‹è¯•ç¤ºä¾‹
 */
@SpringBootTest
@AutoConfigureMockMvc
public class UserControllerIntegrationTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @Autowired
    private ObjectMapper objectMapper;
    
    @MockBean
    private UserService userService;
    
    @Test
    public void testCreateUser() throws Exception {
        // å‡†å¤‡æµ‹è¯•æ•°æ®
        User user = new User();
        user.setUsername("test");
        user.setPassword("password");
        
        User savedUser = new User();
        savedUser.setId(1L);
        savedUser.setUsername("test");
        
        // æ¨¡æ‹ŸServiceè¡Œä¸º
        when(userService.createUser(any(User.class))).thenReturn(savedUser);
        
        // æ‰§è¡Œæµ‹è¯•
        mockMvc.perform(post("/api/users")
                .contentType(MediaType.APPLICATION_JSON)
                .content(objectMapper.writeValueAsString(user)))
                .andExpect(status().isCreated())
                .andExpect(jsonPath("$.id").value(1))
                .andExpect(jsonPath("$.username").value("test"));
        
        // éªŒè¯äº¤äº’
        verify(userService).createUser(any(User.class));
    }
}
```

### åˆ‡ç‰‡æµ‹è¯•

```java
/**
 * Webåˆ‡ç‰‡æµ‹è¯•ç¤ºä¾‹
 */
@WebMvcTest(UserController.class)
public class UserControllerTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @MockBean
    private UserService userService;
    
    @Test
    public void testGetUser() throws Exception {
        // å‡†å¤‡æµ‹è¯•æ•°æ®
        User user = new User();
        user.setId(1L);
        user.setUsername("test");
        
        // æ¨¡æ‹ŸServiceè¡Œä¸º
        when(userService.getUserById(1L)).thenReturn(user);
        
        // æ‰§è¡Œæµ‹è¯•
        mockMvc.perform(get("/api/users/1"))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.id").value(1))
                .andExpect(jsonPath("$.username").value("test"));
    }
}
```

## é«˜çº§ç‰¹æ€§

### ç¼“å­˜æœºåˆ¶

```java
/**
 * ç¼“å­˜é…ç½®
 */
@Configuration
@EnableCaching
public class CacheConfig {
    
    @Bean
    public CacheManager cacheManager(RedisConnectionFactory redisConnectionFactory) {
        // ç¼“å­˜é…ç½®
        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofMinutes(10))
            .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(new StringRedisSerializer()))
            .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(new GenericJackson2JsonRedisSerializer()));
        
        // ç¼“å­˜ç©ºé—´
        Map<String, RedisCacheConfiguration> configMap = new HashMap<>();
        configMap.put("users", config.entryTtl(Duration.ofMinutes(5)));
        configMap.put("products", config.entryTtl(Duration.ofMinutes(15)));
        
        // åˆ›å»ºç¼“å­˜ç®¡ç†å™¨
        return RedisCacheManager.builder(redisConnectionFactory)
            .cacheDefaults(config)
            .withInitialCacheConfigurations(configMap)
            .build();
    }
}

/**
 * ç¼“å­˜ä½¿ç”¨ç¤ºä¾‹
 */
@Service
public class ProductService {
    
    @Autowired
    private ProductRepository productRepository;
    
    @Cacheable(value = "products", key = "#id")
    public Product getProductById(Long id) {
        return productRepository.findById(id)
            .orElseThrow(() -> new NotFoundException("Product not found"));
    }
    
    @CachePut(value = "products", key = "#product.id")
    public Product updateProduct(Product product) {
        return productRepository.save(product);
    }
    
    @CacheEvict(value = "products", key = "#id")
    public void deleteProduct(Long id) {
        productRepository.deleteById(id);
    }
    
    @CacheEvict(value = "products", allEntries = true)
    public void clearAllProductCache() {
        // æ¸…ç©ºæ‰€æœ‰äº§å“ç¼“å­˜
    }
    
    @Cacheable(value = "products", key = "#category + '_' + #page + '_' + #size", 
               condition = "#category != null", unless = "#result.isEmpty()")
    public List<Product> getProductsByCategory(String category, int page, int size) {
        Pageable pageable = PageRequest.of(page, size);
        return productRepository.findByCategory(category, pageable).getContent();
    }
}

/**
 * è‡ªå®šä¹‰ç¼“å­˜Keyç”Ÿæˆå™¨
 */
@Component
public class CustomKeyGenerator implements KeyGenerator {
    
    @Override
    public Object generate(Object target, Method method, Object... params) {
        StringBuilder sb = new StringBuilder();
        sb.append(target.getClass().getSimpleName()).append(".");
        sb.append(method.getName()).append("(");
        
        for (int i = 0; i < params.length; i++) {
            if (i > 0) {
                sb.append(",");
            }
            if (params[i] != null) {
                sb.append(params[i].toString());
            } else {
                sb.append("null");
            }
        }
        sb.append(")");
        
        return sb.toString();
    }
}

/**
 * ç¼“å­˜äº‹ä»¶ç›‘å¬å™¨
 */
@Component
@Slf4j
public class CacheEventListener {
    
    @EventListener
    public void handleCacheGetEvent(CacheGetEvent event) {
        log.debug("Cache get: key={}, cacheName={}", event.getKey(), event.getCacheName());
    }
    
    @EventListener
    public void handleCachePutEvent(CachePutEvent event) {
        log.debug("Cache put: key={}, cacheName={}", event.getKey(), event.getCacheName());
    }
    
    @EventListener
    public void handleCacheEvictEvent(CacheEvictEvent event) {
        log.debug("Cache evict: key={}, cacheName={}", event.getKey(), event.getCacheName());
    }
}
```

### å¼‚æ­¥å¤„ç†

```java
/**
 * å¼‚æ­¥é…ç½®
 */
@Configuration
@EnableAsync
public class AsyncConfig implements AsyncConfigurer {
    
    @Override
    @Bean(name = "taskExecutor")
    public Executor getAsyncExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.setMaxPoolSize(10);
        executor.setQueueCapacity(25);
        executor.setKeepAliveSeconds(60);
        executor.setThreadNamePrefix("async-");
        executor.setWaitForTasksToCompleteOnShutdown(true);
        executor.setAwaitTerminationSeconds(60);
        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());
        executor.initialize();
        return executor;
    }
    
    @Override
    public AsyncUncaughtExceptionHandler getAsyncUncaughtExceptionHandler() {
        return new CustomAsyncExceptionHandler();
    }
    
    /**
     * è‡ªå®šä¹‰å¼‚æ­¥å¼‚å¸¸å¤„ç†å™¨
     */
    public static class CustomAsyncExceptionHandler implements AsyncUncaughtExceptionHandler {
        
        private static final Logger logger = LoggerFactory.getLogger(CustomAsyncExceptionHandler.class);
        
        @Override
        public void handleUncaughtException(Throwable throwable, Method method, Object... objects) {
            logger.error("Async method execution failed. Method: {}, Parameters: {}", 
                        method.getName(), Arrays.toString(objects), throwable);
            
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å‘Šè­¦ã€é‡è¯•ç­‰é€»è¾‘
            // ä¾‹å¦‚ï¼šå‘é€é‚®ä»¶é€šçŸ¥ã€è®°å½•åˆ°ç›‘æ§ç³»ç»Ÿç­‰
        }
    }
}

/**
 * å¼‚æ­¥æœåŠ¡ç¤ºä¾‹
 */
@Service
@Slf4j
public class AsyncService {
    
    @Async("taskExecutor")
    public CompletableFuture<String> processDataAsync(String data) {
        log.info("å¼€å§‹å¼‚æ­¥å¤„ç†æ•°æ®: {}", data);
        
        try {
            // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
            Thread.sleep(2000);
            
            String result = "å¤„ç†å®Œæˆ: " + data.toUpperCase();
            log.info("å¼‚æ­¥å¤„ç†å®Œæˆ: {}", result);
            
            return CompletableFuture.completedFuture(result);
            
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            log.error("å¼‚æ­¥å¤„ç†è¢«ä¸­æ–­", e);
            return CompletableFuture.failedFuture(e);
        } catch (Exception e) {
            log.error("å¼‚æ­¥å¤„ç†å¤±è´¥", e);
            return CompletableFuture.failedFuture(e);
        }
    }
    
    @Async
    public void sendEmailAsync(String to, String subject, String content) {
        log.info("å¼€å§‹å‘é€é‚®ä»¶: to={}, subject={}", to, subject);
        
        try {
            // æ¨¡æ‹Ÿå‘é€é‚®ä»¶
            Thread.sleep(1000);
            log.info("é‚®ä»¶å‘é€æˆåŠŸ: {}", to);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            log.error("é‚®ä»¶å‘é€è¢«ä¸­æ–­", e);
        } catch (Exception e) {
            log.error("é‚®ä»¶å‘é€å¤±è´¥", e);
        }
    }
    
    @Async
    public CompletableFuture<Void> batchProcessAsync(List<String> dataList) {
        log.info("å¼€å§‹æ‰¹é‡å¼‚æ­¥å¤„ç†ï¼Œæ•°æ®é‡: {}", dataList.size());
        
        List<CompletableFuture<String>> futures = dataList.stream()
                .map(this::processDataAsync)
                .collect(Collectors.toList());
        
        return CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]))
                .thenRun(() -> log.info("æ‰¹é‡å¼‚æ­¥å¤„ç†å®Œæˆ"));
    }
    
    @Async
    @Retryable(value = {Exception.class}, maxAttempts = 3, backoff = @Backoff(delay = 1000))
    public CompletableFuture<String> processWithRetry(String data) {
        log.info("å¤„ç†æ•°æ®ï¼ˆå¸¦é‡è¯•ï¼‰: {}", data);
        
        // æ¨¡æ‹Ÿå¯èƒ½å¤±è´¥çš„æ“ä½œ
        if (Math.random() < 0.7) {
            throw new RuntimeException("å¤„ç†å¤±è´¥ï¼Œéœ€è¦é‡è¯•");
        }
        
        return CompletableFuture.completedFuture("å¤„ç†æˆåŠŸ: " + data);
    }
    
    @Recover
    public CompletableFuture<String> recover(Exception ex, String data) {
        log.error("é‡è¯•å¤±è´¥ï¼Œæ‰§è¡Œæ¢å¤é€»è¾‘: data={}", data, ex);
        return CompletableFuture.completedFuture("æ¢å¤å¤„ç†: " + data);
    }
}

/**
 * å¼‚æ­¥æ§åˆ¶å™¨ç¤ºä¾‹
 */
@RestController
@RequestMapping("/api/async")
@Slf4j
public class AsyncController {
    
    @Autowired
    private AsyncService asyncService;
    
    @PostMapping("/process")
    public ResponseEntity<Map<String, Object>> processAsync(@RequestBody Map<String, String> request) {
        String data = request.get("data");
        
        CompletableFuture<String> future = asyncService.processDataAsync(data);
        
        Map<String, Object> response = new HashMap<>();
        response.put("message", "å¼‚æ­¥å¤„ç†å·²å¯åŠ¨");
        response.put("taskId", UUID.randomUUID().toString());
        response.put("timestamp", System.currentTimeMillis());
        
        // å¼‚æ­¥å¤„ç†å®Œæˆåçš„å›è°ƒ
        future.whenComplete((result, throwable) -> {
            if (throwable != null) {
                log.error("å¼‚æ­¥å¤„ç†å¤±è´¥", throwable);
                // å¯ä»¥åœ¨è¿™é‡Œå‘é€WebSocketé€šçŸ¥æˆ–ä¿å­˜ç»“æœåˆ°æ•°æ®åº“
            } else {
                log.info("å¼‚æ­¥å¤„ç†æˆåŠŸ: {}", result);
                // å¯ä»¥åœ¨è¿™é‡Œå‘é€WebSocketé€šçŸ¥æˆ–ä¿å­˜ç»“æœåˆ°æ•°æ®åº“
            }
        });
        
        return ResponseEntity.ok(response);
    }
    
    @PostMapping("/batch")
    public ResponseEntity<Map<String, Object>> batchProcessAsync(@RequestBody Map<String, List<String>> request) {
        List<String> dataList = request.get("dataList");
        
        CompletableFuture<Void> future = asyncService.batchProcessAsync(dataList);
        
        Map<String, Object> response = new HashMap<>();
        response.put("message", "æ‰¹é‡å¼‚æ­¥å¤„ç†å·²å¯åŠ¨");
        response.put("count", dataList.size());
        response.put("timestamp", System.currentTimeMillis());
        
        return ResponseEntity.ok(response);
    }
    
    @GetMapping("/status/{taskId}")
    public ResponseEntity<Map<String, Object>> getTaskStatus(@PathVariable String taskId) {
        // è¿™é‡Œå¯ä»¥ä»ç¼“å­˜æˆ–æ•°æ®åº“ä¸­æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
        Map<String, Object> response = new HashMap<>();
        response.put("taskId", taskId);
        response.put("status", "PROCESSING"); // PENDING, PROCESSING, COMPLETED, FAILED
        response.put("progress", 50);
        
        return ResponseEntity.ok(response);
    }
}
```

### äº‹ä»¶æœºåˆ¶

```java
/**
 * è‡ªå®šä¹‰äº‹ä»¶
 */
public class UserRegisteredEvent extends ApplicationEvent {
    
    private final User user;
    private final String registrationSource;
    private final LocalDateTime registrationTime;
    
    public UserRegisteredEvent(Object source, User user, String registrationSource) {
        super(source);
        this.user = user;
        this.registrationSource = registrationSource;
        this.registrationTime = LocalDateTime.now();
    }
    
    // getters
    public User getUser() { return user; }
    public String getRegistrationSource() { return registrationSource; }
    public LocalDateTime getRegistrationTime() { return registrationTime; }
}

/**
 * è®¢å•äº‹ä»¶
 */
public class OrderCreatedEvent extends ApplicationEvent {
    
    private final Order order;
    private final User customer;
    
    public OrderCreatedEvent(Object source, Order order, User customer) {
        super(source);
        this.order = order;
        this.customer = customer;
    }
    
    public Order getOrder() { return order; }
    public User getCustomer() { return customer; }
}

/**
 * äº‹ä»¶å‘å¸ƒè€…
 */
@Service
@Slf4j
public class UserService {
    
    @Autowired
    private ApplicationEventPublisher eventPublisher;
    
    @Autowired
    private UserRepository userRepository;
    
    public User registerUser(CreateUserRequest request) {
        // åˆ›å»ºç”¨æˆ·
        User user = User.builder()
                .username(request.getUsername())
                .email(request.getEmail())
                .password(passwordEncoder.encode(request.getPassword()))
                .status(UserStatus.ACTIVE)
                .createdAt(LocalDateTime.now())
                .build();
        
        User savedUser = userRepository.save(user);
        
        // å‘å¸ƒç”¨æˆ·æ³¨å†Œäº‹ä»¶
        UserRegisteredEvent event = new UserRegisteredEvent(this, savedUser, "WEB");
        eventPublisher.publishEvent(event);
        
        log.info("ç”¨æˆ·æ³¨å†ŒæˆåŠŸï¼Œå·²å‘å¸ƒäº‹ä»¶: userId={}", savedUser.getId());
        
        return savedUser;
    }
}

/**
 * äº‹ä»¶ç›‘å¬å™¨
 */
@Component
@Slf4j
public class UserEventListener {
    
    @Autowired
    private EmailService emailService;
    
    @Autowired
    private NotificationService notificationService;
    
    @Autowired
    private AnalyticsService analyticsService;
    
    /**
     * ç›‘å¬ç”¨æˆ·æ³¨å†Œäº‹ä»¶ - å‘é€æ¬¢è¿é‚®ä»¶
     */
    @EventListener
    @Async
    public void handleUserRegistered(UserRegisteredEvent event) {
        User user = event.getUser();
        log.info("å¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶ - å‘é€æ¬¢è¿é‚®ä»¶: userId={}", user.getId());
        
        try {
            emailService.sendWelcomeEmail(user);
            log.info("æ¬¢è¿é‚®ä»¶å‘é€æˆåŠŸ: userId={}", user.getId());
        } catch (Exception e) {
            log.error("æ¬¢è¿é‚®ä»¶å‘é€å¤±è´¥: userId={}", user.getId(), e);
        }
    }
    
    /**
     * ç›‘å¬ç”¨æˆ·æ³¨å†Œäº‹ä»¶ - å‘é€ç³»ç»Ÿé€šçŸ¥
     */
    @EventListener
    @Async
    public void handleUserRegisteredNotification(UserRegisteredEvent event) {
        User user = event.getUser();
        log.info("å¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶ - å‘é€ç³»ç»Ÿé€šçŸ¥: userId={}", user.getId());
        
        try {
            String message = String.format("æ¬¢è¿ %s åŠ å…¥æˆ‘ä»¬ï¼", user.getUsername());
            notificationService.sendNotification(user.getId(), message);
            log.info("ç³»ç»Ÿé€šçŸ¥å‘é€æˆåŠŸ: userId={}", user.getId());
        } catch (Exception e) {
            log.error("ç³»ç»Ÿé€šçŸ¥å‘é€å¤±è´¥: userId={}", user.getId(), e);
        }
    }
    
    /**
     * ç›‘å¬ç”¨æˆ·æ³¨å†Œäº‹ä»¶ - è®°å½•åˆ†ææ•°æ®
     */
    @EventListener
    @Async
    public void handleUserRegisteredAnalytics(UserRegisteredEvent event) {
        User user = event.getUser();
        String source = event.getRegistrationSource();
        LocalDateTime time = event.getRegistrationTime();
        
        log.info("å¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶ - è®°å½•åˆ†ææ•°æ®: userId={}, source={}", user.getId(), source);
        
        try {
            analyticsService.recordUserRegistration(user.getId(), source, time);
            log.info("åˆ†ææ•°æ®è®°å½•æˆåŠŸ: userId={}", user.getId());
        } catch (Exception e) {
            log.error("åˆ†ææ•°æ®è®°å½•å¤±è´¥: userId={}", user.getId(), e);
        }
    }
    
    /**
     * æ¡ä»¶ç›‘å¬ - åªå¤„ç†ç‰¹å®šæ¥æºçš„æ³¨å†Œ
     */
    @EventListener(condition = "#event.registrationSource == 'MOBILE'")
    public void handleMobileUserRegistered(UserRegisteredEvent event) {
        User user = event.getUser();
        log.info("å¤„ç†ç§»åŠ¨ç«¯ç”¨æˆ·æ³¨å†Œ: userId={}", user.getId());
        
        // ç§»åŠ¨ç«¯ç”¨æˆ·ç‰¹æ®Šå¤„ç†é€»è¾‘
        // ä¾‹å¦‚ï¼šå‘é€APPæ¨é€é€šçŸ¥ã€èµ é€ç§»åŠ¨ç«¯ä¸“å±ä¼˜æƒ åˆ¸ç­‰
    }
}

/**
 * è®¢å•äº‹ä»¶ç›‘å¬å™¨
 */
@Component
@Slf4j
public class OrderEventListener {
    
    @Autowired
    private InventoryService inventoryService;
    
    @Autowired
    private PaymentService paymentService;
    
    @Autowired
    private EmailService emailService;
    
    @EventListener
    @Order(1) // è®¾ç½®ç›‘å¬å™¨æ‰§è¡Œé¡ºåº
    public void handleOrderCreatedInventory(OrderCreatedEvent event) {
        Order order = event.getOrder();
        log.info("å¤„ç†è®¢å•åˆ›å»ºäº‹ä»¶ - æ›´æ–°åº“å­˜: orderId={}", order.getId());
        
        try {
            inventoryService.reserveItems(order.getItems());
            log.info("åº“å­˜é¢„ç•™æˆåŠŸ: orderId={}", order.getId());
        } catch (Exception e) {
            log.error("åº“å­˜é¢„ç•™å¤±è´¥: orderId={}", order.getId(), e);
            // å¯ä»¥å‘å¸ƒåº“å­˜é¢„ç•™å¤±è´¥äº‹ä»¶
        }
    }
    
    @EventListener
    @Order(2)
    public void handleOrderCreatedPayment(OrderCreatedEvent event) {
        Order order = event.getOrder();
        User customer = event.getCustomer();
        
        log.info("å¤„ç†è®¢å•åˆ›å»ºäº‹ä»¶ - å¤„ç†æ”¯ä»˜: orderId={}", order.getId());
        
        try {
            paymentService.processPayment(order, customer);
            log.info("æ”¯ä»˜å¤„ç†æˆåŠŸ: orderId={}", order.getId());
        } catch (Exception e) {
            log.error("æ”¯ä»˜å¤„ç†å¤±è´¥: orderId={}", order.getId(), e);
            // å¯ä»¥å‘å¸ƒæ”¯ä»˜å¤±è´¥äº‹ä»¶
        }
    }
    
    @EventListener
    @Order(3)
    @Async
    public void handleOrderCreatedEmail(OrderCreatedEvent event) {
        Order order = event.getOrder();
        User customer = event.getCustomer();
        
        log.info("å¤„ç†è®¢å•åˆ›å»ºäº‹ä»¶ - å‘é€ç¡®è®¤é‚®ä»¶: orderId={}", order.getId());
        
        try {
            emailService.sendOrderConfirmationEmail(customer, order);
            log.info("è®¢å•ç¡®è®¤é‚®ä»¶å‘é€æˆåŠŸ: orderId={}", order.getId());
        } catch (Exception e) {
            log.error("è®¢å•ç¡®è®¤é‚®ä»¶å‘é€å¤±è´¥: orderId={}", order.getId(), e);
        }
    }
}

/**
 * äº‹ä»¶é…ç½®
 */
@Configuration
public class EventConfig {
    
    /**
     * è‡ªå®šä¹‰äº‹ä»¶å¤šæ’­å™¨
     */
    @Bean
    public ApplicationEventMulticaster applicationEventMulticaster() {
        SimpleApplicationEventMulticaster multicaster = new SimpleApplicationEventMulticaster();
        
        // è®¾ç½®å¼‚æ­¥æ‰§è¡Œå™¨
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(2);
        executor.setMaxPoolSize(5);
        executor.setQueueCapacity(10);
        executor.setThreadNamePrefix("event-");
        executor.initialize();
        
        multicaster.setTaskExecutor(executor);
        
        // è®¾ç½®é”™è¯¯å¤„ç†å™¨
        multicaster.setErrorHandler(throwable -> {
            log.error("äº‹ä»¶å¤„ç†å¼‚å¸¸", throwable);
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å‘Šè­¦é€»è¾‘
        });
        
        return multicaster;
    }
}

/**
 * äº‹åŠ¡äº‹ä»¶ç›‘å¬å™¨
 */
@Component
@Slf4j
public class TransactionalEventListener {
    
    /**
     * äº‹åŠ¡æäº¤åæ‰§è¡Œ
     */
    @TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
    public void handleUserRegisteredAfterCommit(UserRegisteredEvent event) {
        User user = event.getUser();
        log.info("äº‹åŠ¡æäº¤åå¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶: userId={}", user.getId());
        
        // åªæœ‰åœ¨äº‹åŠ¡æˆåŠŸæäº¤åæ‰æ‰§è¡Œçš„é€»è¾‘
        // ä¾‹å¦‚ï¼šå‘é€ç¬¬ä¸‰æ–¹APIé€šçŸ¥ã€æ¸…ç†ç¼“å­˜ç­‰
    }
    
    /**
     * äº‹åŠ¡å›æ»šåæ‰§è¡Œ
     */
    @TransactionalEventListener(phase = TransactionPhase.AFTER_ROLLBACK)
    public void handleUserRegisteredAfterRollback(UserRegisteredEvent event) {
        User user = event.getUser();
        log.info("äº‹åŠ¡å›æ»šåå¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶: userId={}", user.getId());
        
        // äº‹åŠ¡å›æ»šåçš„æ¸…ç†é€»è¾‘
        // ä¾‹å¦‚ï¼šæ¸…ç†ä¸´æ—¶æ–‡ä»¶ã€å‘é€å¤±è´¥é€šçŸ¥ç­‰
    }
    
    /**
     * äº‹åŠ¡å®Œæˆåæ‰§è¡Œï¼ˆæ— è®ºæäº¤è¿˜æ˜¯å›æ»šï¼‰
     */
    @TransactionalEventListener(phase = TransactionPhase.AFTER_COMPLETION)
    public void handleUserRegisteredAfterCompletion(UserRegisteredEvent event) {
        User user = event.getUser();
        log.info("äº‹åŠ¡å®Œæˆåå¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶: userId={}", user.getId());
        
        // æ— è®ºäº‹åŠ¡æˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½è¦æ‰§è¡Œçš„é€»è¾‘
        // ä¾‹å¦‚ï¼šè®°å½•å®¡è®¡æ—¥å¿—ã€æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ç­‰
    }
}
```


### å¼‚æ­¥å¤„ç†

```java
/**
 * å¼‚æ­¥é…ç½®
 */
@Configuration
@EnableAsync
public class AsyncConfig {
    
    @Bean
    public Executor taskExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.setMaxPoolSize(10);
        executor.setQueueCapacity(25);
        executor.setThreadNamePrefix("Async-");
        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());
        executor.initialize();
        return executor;
    }
}

/**
 * å¼‚æ­¥æœåŠ¡ç¤ºä¾‹
 */
@Service
public class EmailService {
    
    @Async
    public CompletableFuture<Boolean> sendEmail(String to, String subject, String content) {
        // å¼‚æ­¥å‘é€é‚®ä»¶
        try {
            // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
            Thread.sleep(2000);
            
            // å‘é€é‚®ä»¶é€»è¾‘
            System.out.println("Sending email to: " + to);
            
            return CompletableFuture.completedFuture(true);
        } catch (Exception e) {
            return CompletableFuture.completedFuture(false);
        }
    }
    
    @Async
    public CompletableFuture<List<String>> processEmails(List<String> emails) {
        return CompletableFuture.supplyAsync(() -> {
            // å¤„ç†é‚®ä»¶åˆ—è¡¨
            return emails.stream()
                .map(email -> email + " processed")
                .collect(Collectors.toList());
        });
    }
}
```

### äº‹ä»¶æœºåˆ¶

```java
/**
 * è‡ªå®šä¹‰äº‹ä»¶
 */
public class UserRegisteredEvent extends ApplicationEvent {
    
    private final User user;
    
    public UserRegisteredEvent(Object source, User user) {
        super(source);
        this.user = user;
    }
    
    public User getUser() {
        return user;
    }
}

/**
 * äº‹ä»¶å‘å¸ƒè€…
 */
@Service
public class UserService {
    
    @Autowired
    private ApplicationEventPublisher eventPublisher;
    
    @Autowired
    private UserRepository userRepository;
    
    @Transactional
    public User registerUser(User user) {
        // ä¿å­˜ç”¨æˆ·
        User savedUser = userRepository.save(user);
        
        // å‘å¸ƒäº‹ä»¶
        eventPublisher.publishEvent(new UserRegisteredEvent(this, savedUser));
        
        return savedUser;
    }
}

/**
 * äº‹ä»¶ç›‘å¬å™¨
 */
@Component
public class UserEventListener {
    
    @Autowired
    private EmailService emailService;
    
    @EventListener
    public void handleUserRegisteredEvent(UserRegisteredEvent event) {
        // å¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶
        User user = event.getUser();
        
        // å‘é€æ¬¢è¿é‚®ä»¶
        emailService.sendEmail(user.getEmail(), "Welcome", "Welcome to our platform!");
    }
    
    @EventListener
    @Async
    public void handleUserRegisteredEventAsync(UserRegisteredEvent event) {
        // å¼‚æ­¥å¤„ç†äº‹ä»¶
        System.out.println("Async processing user registration: " + event.getUser().getUsername());
    }
    
    @TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
    public void handleUserRegisteredEventTransactional(UserRegisteredEvent event) {
        // äº‹åŠ¡æäº¤åå¤„ç†äº‹ä»¶
        System.out.println("Transaction committed for user: " + event.getUser().getUsername());
    }
}
```

### ç›‘æ§ä¸ç®¡ç†

SpringBoot Actuatoræä¾›äº†å¼ºå¤§çš„ç›‘æ§å’Œç®¡ç†åŠŸèƒ½ï¼š

```mermaid
graph TD
    A[SpringBoot Actuator] --> B[å¥åº·æ£€æŸ¥]
    A --> C[æŒ‡æ ‡ç›‘æ§]
    A --> D[åº”ç”¨ä¿¡æ¯]
    A --> E[ç¯å¢ƒä¿¡æ¯]
    A --> F[æ—¥å¿—ç®¡ç†]
    
    B --> B1[å†…ç½®å¥åº·æ£€æŸ¥]
    B --> B2[è‡ªå®šä¹‰å¥åº·æ£€æŸ¥]
    B --> B3[å¥åº·ç»„åˆ]
    
    C --> C1[JVMæŒ‡æ ‡]
    C --> C2[HTTPæŒ‡æ ‡]
    C --> C3[æ•°æ®åº“æŒ‡æ ‡]
    C --> C4[è‡ªå®šä¹‰æŒ‡æ ‡]
    
    D --> D1[åº”ç”¨ç‰ˆæœ¬]
    D --> D2[æ„å»ºä¿¡æ¯]
    D --> D3[Gitä¿¡æ¯]
    
    E --> E1[é…ç½®å±æ€§]
    E --> E2[ç¯å¢ƒå˜é‡]
    E --> E3[ç³»ç»Ÿå±æ€§]
    
    F --> F1[æ—¥å¿—çº§åˆ«]
    F --> F2[æ—¥å¿—é…ç½®]
    F --> F3[åŠ¨æ€è°ƒæ•´]
```

```java
/**
 * Actuatoré…ç½®
 */
@Configuration
public class ActuatorConfig {
    
    /**
     * è‡ªå®šä¹‰å¥åº·æ£€æŸ¥æŒ‡ç¤ºå™¨
     */
    @Bean
    public HealthIndicator databaseHealthIndicator(DataSource dataSource) {
        return new AbstractHealthIndicator() {
            @Override
            protected void doHealthCheck(Health.Builder builder) throws Exception {
                try (Connection connection = dataSource.getConnection()) {
                    if (connection.isValid(1)) {
                        builder.up()
                                .withDetail("database", "MySQL")
                                .withDetail("validationQuery", "SELECT 1")
                                .withDetail("connectionTimeout", "1000ms");
                    } else {
                        builder.down()
                                .withDetail("database", "MySQL")
                                .withDetail("error", "Connection validation failed");
                    }
                } catch (SQLException e) {
                    builder.down()
                            .withDetail("database", "MySQL")
                            .withException(e);
                }
            }
        };
    }
    
    /**
     * å¤–éƒ¨æœåŠ¡å¥åº·æ£€æŸ¥
     */
    @Bean
    public HealthIndicator externalServiceHealthIndicator(RestTemplate restTemplate) {
        return new AbstractHealthIndicator() {
            @Override
            protected void doHealthCheck(Health.Builder builder) throws Exception {
                try {
                    ResponseEntity<String> response = restTemplate.getForEntity(
                            "http://external-service/health", String.class);
                    
                    if (response.getStatusCode().is2xxSuccessful()) {
                        builder.up()
                                .withDetail("externalService", "UP")
                                .withDetail("responseTime", "< 1000ms")
                                .withDetail("status", response.getStatusCode());
                    } else {
                        builder.down()
                                .withDetail("externalService", "DOWN")
                                .withDetail("status", response.getStatusCode());
                    }
                } catch (Exception e) {
                    builder.down()
                            .withDetail("externalService", "DOWN")
                            .withException(e);
                }
            }
        };
    }
    
    /**
     * Rediså¥åº·æ£€æŸ¥
     */
    @Bean
    @ConditionalOnBean(RedisTemplate.class)
    public HealthIndicator redisHealthIndicator(RedisTemplate<String, Object> redisTemplate) {
        return new AbstractHealthIndicator() {
            @Override
            protected void doHealthCheck(Health.Builder builder) throws Exception {
                try {
                    String pong = redisTemplate.getConnectionFactory()
                            .getConnection()
                            .ping();
                    
                    if ("PONG".equals(pong)) {
                        builder.up()
                                .withDetail("redis", "UP")
                                .withDetail("ping", pong);
                    } else {
                        builder.down()
                                .withDetail("redis", "DOWN")
                                .withDetail("ping", pong);
                    }
                } catch (Exception e) {
                    builder.down()
                            .withDetail("redis", "DOWN")
                            .withException(e);
                }
            }
        };
    }
    
    /**
     * è‡ªå®šä¹‰åº”ç”¨ä¿¡æ¯è´¡çŒ®è€…
     */
    @Bean
    public InfoContributor customInfoContributor() {
        return builder -> {
            Map<String, Object> appInfo = new HashMap<>();
            appInfo.put("name", "SpringBoot Demo Application");
            appInfo.put("version", "1.0.0");
            appInfo.put("buildDate", LocalDateTime.now().toString());
            appInfo.put("javaVersion", System.getProperty("java.version"));
            appInfo.put("springBootVersion", SpringBootVersion.getVersion());
            
            Map<String, Object> teamInfo = new HashMap<>();
            teamInfo.put("developer", "Development Team");
            teamInfo.put("email", "dev-team@example.com");
            teamInfo.put("department", "Engineering");
            
            builder.withDetail("application", appInfo);
            builder.withDetail("team", teamInfo);
        };
    }
    
    /**
     * è‡ªå®šä¹‰æŒ‡æ ‡
     */
    @Bean
    public MeterRegistryCustomizer<MeterRegistry> metricsCommonTags() {
        return registry -> registry.config().commonTags(
                "application", "springboot-demo",
                "environment", "production"
        );
    }
}

/**
 * è‡ªå®šä¹‰æŒ‡æ ‡æœåŠ¡
 */
@Service
@Slf4j
public class MetricsService {
    
    private final Counter userRegistrationCounter;
    private final Counter orderCreatedCounter;
    private final Timer orderProcessingTimer;
    private final Gauge activeUsersGauge;
    private final AtomicInteger activeUsersCount = new AtomicInteger(0);
    
    public MetricsService(MeterRegistry meterRegistry) {
        // è®¡æ•°å™¨æŒ‡æ ‡
        this.userRegistrationCounter = Counter.builder("user.registration")
                .description("ç”¨æˆ·æ³¨å†Œæ¬¡æ•°")
                .tag("source", "web")
                .register(meterRegistry);
        
        this.orderCreatedCounter = Counter.builder("order.created")
                .description("è®¢å•åˆ›å»ºæ¬¡æ•°")
                .register(meterRegistry);
        
        // è®¡æ—¶å™¨æŒ‡æ ‡
        this.orderProcessingTimer = Timer.builder("order.processing.time")
                .description("è®¢å•å¤„ç†æ—¶é—´")
                .register(meterRegistry);
        
        // ä»ªè¡¨æŒ‡æ ‡
        this.activeUsersGauge = Gauge.builder("users.active")
                .description("å½“å‰æ´»è·ƒç”¨æˆ·æ•°")
                .register(meterRegistry, activeUsersCount, AtomicInteger::get);
    }
    
    public void recordUserRegistration() {
        userRegistrationCounter.increment();
        activeUsersCount.incrementAndGet();
        log.debug("ç”¨æˆ·æ³¨å†ŒæŒ‡æ ‡å·²è®°å½•");
    }
    
    public void recordOrderCreated() {
        orderCreatedCounter.increment();
        log.debug("è®¢å•åˆ›å»ºæŒ‡æ ‡å·²è®°å½•");
    }
    
    public void recordOrderProcessingTime(Duration duration) {
        orderProcessingTimer.record(duration);
        log.debug("è®¢å•å¤„ç†æ—¶é—´æŒ‡æ ‡å·²è®°å½•: {}ms", duration.toMillis());
    }
    
    public Timer.Sample startOrderProcessingTimer() {
        return Timer.start();
    }
    
    public void stopOrderProcessingTimer(Timer.Sample sample) {
        sample.stop(orderProcessingTimer);
    }
    
    public void decrementActiveUsers() {
        activeUsersCount.decrementAndGet();
    }
}

/**
 * æŒ‡æ ‡æ”¶é›†åˆ‡é¢
 */
@Aspect
@Component
@Slf4j
public class MetricsAspect {
    
    private final MeterRegistry meterRegistry;
    
    public MetricsAspect(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
    }
    
    @Around("@annotation(Timed)")
    public Object timeMethod(ProceedingJoinPoint joinPoint) throws Throwable {
        Timer.Sample sample = Timer.start(meterRegistry);
        
        try {
            Object result = joinPoint.proceed();
            
            // è®°å½•æˆåŠŸæ‰§è¡Œçš„æŒ‡æ ‡
            sample.stop(Timer.builder("method.execution.time")
                    .tag("class", joinPoint.getTarget().getClass().getSimpleName())
                    .tag("method", joinPoint.getSignature().getName())
                    .tag("status", "success")
                    .register(meterRegistry));
            
            return result;
            
        } catch (Exception e) {
            // è®°å½•å¼‚å¸¸æ‰§è¡Œçš„æŒ‡æ ‡
            sample.stop(Timer.builder("method.execution.time")
                    .tag("class", joinPoint.getTarget().getClass().getSimpleName())
                    .tag("method", joinPoint.getSignature().getName())
                    .tag("status", "error")
                    .register(meterRegistry));
            
            // è®°å½•å¼‚å¸¸è®¡æ•°
            Counter.builder("method.execution.errors")
                    .tag("class", joinPoint.getTarget().getClass().getSimpleName())
                    .tag("method", joinPoint.getSignature().getName())
                    .tag("exception", e.getClass().getSimpleName())
                    .register(meterRegistry)
                    .increment();
            
            throw e;
        }
    }
}

/**
 * è‡ªå®šä¹‰ç«¯ç‚¹
 */
@Component
@Endpoint(id = "custom")
public class CustomEndpoint {
    
    @Autowired
    private UserService userService;
    
    @Autowired
    private OrderService orderService;
    
    @ReadOperation
    public Map<String, Object> customInfo() {
        Map<String, Object> info = new HashMap<>();
        
        // ä¸šåŠ¡ç»Ÿè®¡ä¿¡æ¯
        info.put("totalUsers", userService.getTotalUserCount());
        info.put("activeUsers", userService.getActiveUserCount());
        info.put("totalOrders", orderService.getTotalOrderCount());
        info.put("todayOrders", orderService.getTodayOrderCount());
        
        // ç³»ç»Ÿä¿¡æ¯
        Runtime runtime = Runtime.getRuntime();
        Map<String, Object> systemInfo = new HashMap<>();
        systemInfo.put("totalMemory", runtime.totalMemory());
        systemInfo.put("freeMemory", runtime.freeMemory());
        systemInfo.put("usedMemory", runtime.totalMemory() - runtime.freeMemory());
        systemInfo.put("maxMemory", runtime.maxMemory());
        systemInfo.put("availableProcessors", runtime.availableProcessors());
        
        info.put("system", systemInfo);
        
        return info;
    }
    
    @ReadOperation
    public Map<String, Object> userStats(@Selector String period) {
        Map<String, Object> stats = new HashMap<>();
        
        switch (period.toLowerCase()) {
            case "today":
                stats.put("registrations", userService.getTodayRegistrations());
                stats.put("logins", userService.getTodayLogins());
                break;
            case "week":
                stats.put("registrations", userService.getWeekRegistrations());
                stats.put("logins", userService.getWeekLogins());
                break;
            case "month":
                stats.put("registrations", userService.getMonthRegistrations());
                stats.put("logins", userService.getMonthLogins());
                break;
            default:
                stats.put("error", "Invalid period. Use: today, week, or month");
        }
        
        return stats;
    }
    
    @WriteOperation
    public Map<String, Object> clearCache(@Selector String cacheName) {
        Map<String, Object> result = new HashMap<>();
        
        try {
            // æ¸…ç†æŒ‡å®šç¼“å­˜
            cacheManager.getCache(cacheName).clear();
            result.put("status", "success");
            result.put("message", "Cache cleared: " + cacheName);
        } catch (Exception e) {
            result.put("status", "error");
            result.put("message", "Failed to clear cache: " + e.getMessage());
        }
        
        return result;
    }
    
    @DeleteOperation
    public Map<String, Object> resetMetrics() {
        Map<String, Object> result = new HashMap<>();
        
        try {
            // é‡ç½®è‡ªå®šä¹‰æŒ‡æ ‡
            // è¿™é‡Œå¯ä»¥æ·»åŠ é‡ç½®é€»è¾‘
            result.put("status", "success");
            result.put("message", "Metrics reset successfully");
        } catch (Exception e) {
            result.put("status", "error");
            result.put("message", "Failed to reset metrics: " + e.getMessage());
        }
        
        return result;
    }
}

/**
 * Webç«¯ç‚¹é…ç½®
 */
@RestControllerEndpoint(id = "business")
@Component
public class BusinessEndpoint {
    
    @Autowired
    private BusinessService businessService;
    
    @GetMapping("/summary")
    public ResponseEntity<Map<String, Object>> getBusinessSummary() {
        Map<String, Object> summary = businessService.getBusinessSummary();
        return ResponseEntity.ok(summary);
    }
    
    @GetMapping("/health-check")
    public ResponseEntity<Map<String, Object>> performHealthCheck() {
        Map<String, Object> result = businessService.performComprehensiveHealthCheck();
        
        boolean allHealthy = (Boolean) result.get("allHealthy");
        HttpStatus status = allHealthy ? HttpStatus.OK : HttpStatus.SERVICE_UNAVAILABLE;
        
        return ResponseEntity.status(status).body(result);
    }
    
    @PostMapping("/maintenance")
    public ResponseEntity<Map<String, Object>> toggleMaintenanceMode(@RequestParam boolean enabled) {
        Map<String, Object> result = businessService.toggleMaintenanceMode(enabled);
        return ResponseEntity.ok(result);
    }
}

/**
 * Actuatoré…ç½®æ–‡ä»¶
 */
/*
# application.yml
management:
  endpoints:
    web:
      exposure:
        include: "*"
      base-path: /actuator
      cors:
        allowed-origins: "http://localhost:3000"
        allowed-methods: "GET,POST,PUT,DELETE"
  
  endpoint:
    health:
      show-details: always
      show-components: always
      group:
        custom:
          include: "db,redis,external"
          show-details: always
    
    info:
      enabled: true
    
    metrics:
      enabled: true
    
    prometheus:
      enabled: true
    
    custom:
      enabled: true
    
    business:
      enabled: true
  
  health:
    circuitbreakers:
      enabled: true
    ratelimiters:
      enabled: true
  
  info:
    env:
      enabled: true
    java:
      enabled: true
    os:
      enabled: true
    git:
      mode: full
  
  metrics:
    tags:
      application: ${spring.application.name}
      environment: ${spring.profiles.active}
    
    distribution:
      percentiles-histogram:
        http.server.requests: true
        method.execution.time: true
      
      percentiles:
        http.server.requests: 0.5, 0.95, 0.99
        method.execution.time: 0.5, 0.95, 0.99
    
    export:
      prometheus:
        enabled: true
        step: 1m
      
      influx:
        enabled: false
        uri: http://localhost:8086
        db: mydb
        step: 1m
  
  server:
    port: 8081
    ssl:
      enabled: false
*/


/**
 * è‡ªå®šä¹‰ç«¯ç‚¹
 */
@Component
@Endpoint(id = "features")
public class FeaturesEndpoint {
    
    private Map<String, Boolean> features = new HashMap<>();
    
    public FeaturesEndpoint() {
        features.put("user-management", true);
        features.put("product-catalog", true);
        features.put("payment-gateway", false);
    }
    
    @ReadOperation
    public Map<String, Boolean> features() {
        return features;
    }
    
    @ReadOperation
    public Boolean feature(@Selector String name) {
        return features.get(name);
    }
    
    @WriteOperation
    public void configureFeature(@Selector String name, Boolean enabled) {
        features.put(name, enabled);
    }
}
```

### éƒ¨ç½²ä¸è¿ç»´

#### æ‰“åŒ…ä¸éƒ¨ç½²

```bash
# æ„å»ºå¯æ‰§è¡ŒJAR
./mvnw clean package

# è¿è¡ŒJAR
java -jar target/myapp.jar

# æŒ‡å®šé…ç½®æ–‡ä»¶
java -jar target/myapp.jar --spring.profiles.active=prod

# æŒ‡å®šJVMå‚æ•°
java -Xms512m -Xmx1024m -jar target/myapp.jar

# ä½¿ç”¨Dockeréƒ¨ç½²
docker build -t myapp .
docker run -p 8080:8080 myapp
```

#### Dockerfileç¤ºä¾‹

```dockerfile
FROM openjdk:11-jre-slim
VOLUME /tmp
ARG JAR_FILE=target/*.jar
COPY ${JAR_FILE} app.jar
ENTRYPOINT ["java", "-Djava.security.egd=file:/dev/./urandom", "-jar", "/app.jar"]
```

#### Docker Composeç¤ºä¾‹

```yaml
version: '3.8'
services:
  app:
    build: 
      context: .
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - SPRING_DATASOURCE_URL=jdbc:mysql://db:3306/mydb
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=secret
      - SPRING_REDIS_HOST=redis
      - SPRING_REDIS_PORT=6379
      - JAVA_OPTS=-Xms512m -Xmx1024m
    depends_on:
      db:
        condition: service_healthy
      redis:
        condition: service_started
    restart: unless-stopped
    networks:
      - app-network
    volumes:
      - ./logs:/app/logs
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
  
  db:
    image: mysql:8.0
    environment:
      - MYSQL_ROOT_PASSWORD=secret
      - MYSQL_DATABASE=mydb
      - MYSQL_USER=app_user
      - MYSQL_PASSWORD=app_password
    ports:
      - "3306:3306"
    volumes:
      - db-data:/var/lib/mysql
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    restart: unless-stopped
    networks:
      - app-network
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 30s
  
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data
      - ./redis.conf:/usr/local/etc/redis/redis.conf
    command: redis-server /usr/local/etc/redis/redis.conf
    restart: unless-stopped
    networks:
      - app-network
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 3s
      retries: 3
  
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/nginx/ssl
    depends_on:
      - app
    restart: unless-stopped
    networks:
      - app-network

volumes:
  db-data:
    driver: local
  redis-data:
    driver: local

networks:
  app-network:
    driver: bridge
```

#### ç”Ÿäº§çº§Dockerfile

```dockerfile
# å¤šé˜¶æ®µæ„å»º
FROM maven:3.8.6-openjdk-17-slim AS builder

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶pom.xmlå’Œæºä»£ç 
COPY pom.xml .
COPY src ./src

# æ„å»ºåº”ç”¨
RUN mvn clean package -DskipTests

# è¿è¡Œæ—¶é•œåƒ
FROM openjdk:17-jre-slim

# å®‰è£…å¿…è¦çš„å·¥å…·
RUN apt-get update && apt-get install -y \
    curl \
    dumb-init \
    && rm -rf /var/lib/apt/lists/*

# åˆ›å»ºåº”ç”¨ç”¨æˆ·
RUN groupadd -r appuser && useradd -r -g appuser appuser

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶æ„å»ºçš„JARæ–‡ä»¶
COPY --from=builder /app/target/*.jar app.jar

# åˆ›å»ºæ—¥å¿—ç›®å½•
RUN mkdir -p /app/logs && chown -R appuser:appuser /app

# åˆ‡æ¢åˆ°érootç”¨æˆ·
USER appuser

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD curl -f http://localhost:8080/actuator/health || exit 1

# æš´éœ²ç«¯å£
EXPOSE 8080

# è®¾ç½®JVMå‚æ•°
ENV JAVA_OPTS="-Xms512m -Xmx1024m -XX:+UseG1GC -XX:+UseContainerSupport"

# ä½¿ç”¨dumb-initä½œä¸ºPID 1
ENTRYPOINT ["dumb-init", "--"]

# å¯åŠ¨åº”ç”¨
CMD ["sh", "-c", "java $JAVA_OPTS -Djava.security.egd=file:/dev/./urandom -jar app.jar"]
```

#### Kuberneteséƒ¨ç½²é…ç½®

```yaml
# deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: springboot-app
  labels:
    app: springboot-app
spec:
  replicas: 3
  selector:
    matchLabels:
      app: springboot-app
  template:
    metadata:
      labels:
        app: springboot-app
    spec:
      containers:
      - name: springboot-app
        image: myregistry/springboot-app:latest
        ports:
        - containerPort: 8080
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "k8s"
        - name: SPRING_DATASOURCE_URL
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: url
        - name: SPRING_DATASOURCE_USERNAME
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: username
        - name: SPRING_DATASOURCE_PASSWORD
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: password
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 30
          timeoutSeconds: 10
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        volumeMounts:
        - name: config-volume
          mountPath: /app/config
        - name: logs-volume
          mountPath: /app/logs
      volumes:
      - name: config-volume
        configMap:
          name: app-config
      - name: logs-volume
        emptyDir: {}

---
# service.yaml
apiVersion: v1
kind: Service
metadata:
  name: springboot-app-service
spec:
  selector:
    app: springboot-app
  ports:
  - protocol: TCP
    port: 80
    targetPort: 8080
  type: ClusterIP

---
# ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: springboot-app-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
spec:
  tls:
  - hosts:
    - myapp.example.com
    secretName: myapp-tls
  rules:
  - host: myapp.example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: springboot-app-service
            port:
              number: 80

---
# configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
data:
  application-k8s.yml: |
    server:
      port: 8080
    
    spring:
      datasource:
        hikari:
          maximum-pool-size: 20
          minimum-idle: 5
      
      redis:
        host: redis-service
        port: 6379
    
    management:
      endpoints:
        web:
          exposure:
            include: "health,info,metrics,prometheus"
      endpoint:
        health:
          probes:
            enabled: true

---
# secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: db-secret
type: Opaque
data:
  url: amRiYzpteXNxbDovL215c3FsLXNlcnZpY2U6MzMwNi9teWRi  # base64 encoded
  username: YXBwX3VzZXI=  # base64 encoded
  password: YXBwX3Bhc3N3b3Jk  # base64 encoded

---
# hpa.yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: springboot-app-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: springboot-app
  minReplicas: 3
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
```

#### CI/CD Pipelineé…ç½®

```yaml
# .github/workflows/ci-cd.yml
name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

jobs:
  test:
    runs-on: ubuntu-latest
    
    services:
      mysql:
        image: mysql:8.0
        env:
          MYSQL_ROOT_PASSWORD: test
          MYSQL_DATABASE: testdb
        ports:
          - 3306:3306
        options: >-
          --health-cmd="mysqladmin ping"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=3
      
      redis:
        image: redis:7-alpine
        ports:
          - 6379:6379
        options: >-
          --health-cmd="redis-cli ping"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=3
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up JDK 17
      uses: actions/setup-java@v3
      with:
        java-version: '17'
        distribution: 'temurin'
    
    - name: Cache Maven packages
      uses: actions/cache@v3
      with:
        path: ~/.m2
        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
        restore-keys: ${{ runner.os }}-m2
    
    - name: Run tests
      run: ./mvnw clean test
      env:
        SPRING_DATASOURCE_URL: jdbc:mysql://localhost:3306/testdb
        SPRING_DATASOURCE_USERNAME: root
        SPRING_DATASOURCE_PASSWORD: test
        SPRING_REDIS_HOST: localhost
        SPRING_REDIS_PORT: 6379
    
    - name: Generate test report
      uses: dorny/test-reporter@v1
      if: success() || failure()
      with:
        name: Maven Tests
        path: target/surefire-reports/*.xml
        reporter: java-junit
    
    - name: Upload coverage to Codecov
      uses: codecov/codecov-action@v3
      with:
        file: target/site/jacoco/jacoco.xml

  build-and-push:
    needs: test
    runs-on: ubuntu-latest
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'
    
    permissions:
      contents: read
      packages: write
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up JDK 17
      uses: actions/setup-java@v3
      with:
        java-version: '17'
        distribution: 'temurin'
    
    - name: Build application
      run: ./mvnw clean package -DskipTests
    
    - name: Log in to Container Registry
      uses: docker/login-action@v2
      with:
        registry: ${{ env.REGISTRY }}
        username: ${{ github.actor }}
        password: ${{ secrets.GITHUB_TOKEN }}
    
    - name: Extract metadata
      id: meta
      uses: docker/metadata-action@v4
      with:
        images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}
        tags: |
          type=ref,event=branch
          type=ref,event=pr
          type=sha,prefix={{branch}}-
          type=raw,value=latest,enable={{is_default_branch}}
    
    - name: Build and push Docker image
      uses: docker/build-push-action@v4
      with:
        context: .
        push: true
        tags: ${{ steps.meta.outputs.tags }}
        labels: ${{ steps.meta.outputs.labels }}

  deploy:
    needs: build-and-push
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Deploy to Kubernetes
      uses: azure/k8s-deploy@v1
      with:
        manifests: |
          k8s/deployment.yaml
          k8s/service.yaml
          k8s/ingress.yaml
        images: |
          ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ github.sha }}
        kubectl-version: 'latest'
```

#### ç›‘æ§å’Œæ—¥å¿—é…ç½®

```yaml
# prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'springboot-app'
    static_configs:
      - targets: ['app:8080']
    metrics_path: '/actuator/prometheus'
    scrape_interval: 5s

---
# grafana-dashboard.json
{
  "dashboard": {
    "title": "SpringBoot Application Dashboard",
    "panels": [
      {
        "title": "HTTP Requests",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(http_server_requests_seconds_count[5m])",
            "legendFormat": "{{method}} {{uri}}"
          }
        ]
      },
      {
        "title": "JVM Memory Usage",
        "type": "graph",
        "targets": [
          {
            "expr": "jvm_memory_used_bytes",
            "legendFormat": "{{area}} {{id}}"
          }
        ]
      },
      {
        "title": "Database Connections",
        "type": "singlestat",
        "targets": [
          {
            "expr": "hikaricp_connections_active"
          }
        ]
      }
    ]
  }
}
```

#### è¿ç»´è„šæœ¬

```bash
#!/bin/bash
# deploy.sh - éƒ¨ç½²è„šæœ¬

set -e

APP_NAME="springboot-app"
VERSION=${1:-latest}
ENVIRONMENT=${2:-production}

echo "å¼€å§‹éƒ¨ç½² $APP_NAME:$VERSION åˆ° $ENVIRONMENT ç¯å¢ƒ"

# 1. æ‹‰å–æœ€æ–°é•œåƒ
echo "æ‹‰å–Dockeré•œåƒ..."
docker pull myregistry/$APP_NAME:$VERSION

# 2. åœæ­¢æ—§å®¹å™¨
echo "åœæ­¢æ—§å®¹å™¨..."
docker stop $APP_NAME || true
docker rm $APP_NAME || true

# 3. å¯åŠ¨æ–°å®¹å™¨
echo "å¯åŠ¨æ–°å®¹å™¨..."
docker run -d \
  --name $APP_NAME \
  --restart unless-stopped \
  -p 8080:8080 \
  -e SPRING_PROFILES_ACTIVE=$ENVIRONMENT \
  -e JAVA_OPTS="-Xms512m -Xmx1024m" \
  -v /opt/app/logs:/app/logs \
  -v /opt/app/config:/app/config \
  myregistry/$APP_NAME:$VERSION

# 4. å¥åº·æ£€æŸ¥
echo "ç­‰å¾…åº”ç”¨å¯åŠ¨..."
sleep 30

for i in {1..10}; do
  if curl -f http://localhost:8080/actuator/health; then
    echo "åº”ç”¨å¯åŠ¨æˆåŠŸï¼"
    exit 0
  fi
  echo "ç­‰å¾…åº”ç”¨å¯åŠ¨... ($i/10)"
  sleep 10
done

echo "åº”ç”¨å¯åŠ¨å¤±è´¥ï¼"
exit 1
```

```bash
#!/bin/bash
# backup.sh - æ•°æ®å¤‡ä»½è„šæœ¬

set -e

BACKUP_DIR="/opt/backups"
DATE=$(date +%Y%m%d_%H%M%S)
DB_NAME="myapp"

echo "å¼€å§‹æ•°æ®å¤‡ä»½: $DATE"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# æ•°æ®åº“å¤‡ä»½
echo "å¤‡ä»½æ•°æ®åº“..."
mysqldump -h mysql-server -u backup_user -p$MYSQL_PASSWORD \
  --single-transaction --routines --triggers \
  $DB_NAME > $BACKUP_DIR/db_backup_$DATE.sql

# å‹ç¼©å¤‡ä»½æ–‡ä»¶
echo "å‹ç¼©å¤‡ä»½æ–‡ä»¶..."
gzip $BACKUP_DIR/db_backup_$DATE.sql

# ä¸Šä¼ åˆ°äº‘å­˜å‚¨
echo "ä¸Šä¼ åˆ°äº‘å­˜å‚¨..."
aws s3 cp $BACKUP_DIR/db_backup_$DATE.sql.gz \
  s3://my-backup-bucket/database/

# æ¸…ç†æœ¬åœ°æ—§å¤‡ä»½ï¼ˆä¿ç•™7å¤©ï¼‰
echo "æ¸…ç†æœ¬åœ°æ—§å¤‡ä»½..."
find $BACKUP_DIR -name "db_backup_*.sql.gz" -mtime +7 -delete

echo "å¤‡ä»½å®Œæˆ: db_backup_$DATE.sql.gz"
```

## å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### é…ç½®é—®é¢˜

```java
/**
 * é…ç½®é—®é¢˜è§£å†³æ–¹æ¡ˆ
 */
public class ConfigurationTroubleshooting {
    
    /**
     * é—®é¢˜ï¼šé…ç½®å±æ€§ä¸ç”Ÿæ•ˆ
     * è§£å†³æ–¹æ¡ˆï¼š
     * 1. æ£€æŸ¥é…ç½®æ–‡ä»¶åç§°æ˜¯å¦æ­£ç¡®ï¼ˆapplication.yml/application.propertiesï¼‰
     * 2. æ£€æŸ¥é…ç½®æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆsrc/main/resourcesï¼‰
     * 3. æ£€æŸ¥é…ç½®å±æ€§åç§°æ˜¯å¦æ­£ç¡®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
     * 4. æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„æ³¨è§£ï¼ˆ@Value, @ConfigurationPropertiesï¼‰
     * 5. å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼ˆ--debugï¼‰æŸ¥çœ‹é…ç½®ç»‘å®šè¿‡ç¨‹
     */
    
    /**
     * é—®é¢˜ï¼šé…ç½®ä¼˜å…ˆçº§é—®é¢˜
     * è§£å†³æ–¹æ¡ˆï¼šäº†è§£é…ç½®ä¼˜å…ˆçº§é¡ºåºï¼ˆä»é«˜åˆ°ä½ï¼‰
     * 1. å‘½ä»¤è¡Œå‚æ•°
     * 2. Javaç³»ç»Ÿå±æ€§
     * 3. æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡
     * 4. application-{profile}.properties/yml
     * 5. application.properties/yml
     */
    
    /**
     * é—®é¢˜ï¼šé…ç½®æ–‡ä»¶ä¸­çš„æ•æ„Ÿä¿¡æ¯å®‰å…¨é—®é¢˜
     * è§£å†³æ–¹æ¡ˆï¼š
     * 1. ä½¿ç”¨ç¯å¢ƒå˜é‡
     * 2. ä½¿ç”¨å¤–éƒ¨é…ç½®æ–‡ä»¶
     * 3. ä½¿ç”¨åŠ å¯†å±æ€§ï¼ˆjasyptï¼‰
     * 4. ä½¿ç”¨é…ç½®æœåŠ¡å™¨ï¼ˆSpring Cloud Configï¼‰
     */
}
```

### ä¾èµ–é—®é¢˜

```java
/**
 * ä¾èµ–é—®é¢˜è§£å†³æ–¹æ¡ˆ
 */
public class DependencyTroubleshooting {
    
    /**
     * é—®é¢˜1ï¼šä¾èµ–å†²çªï¼ˆClassNotFoundException, NoSuchMethodErrorï¼‰
     * 
     * åŸå› ï¼š
     * - ä¸åŒç‰ˆæœ¬çš„åŒä¸€ä¸ªåº“å­˜åœ¨å†²çª
     * - ä¼ é€’ä¾èµ–ç‰ˆæœ¬ä¸å…¼å®¹
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solveDependencyConflicts() {
        // 1. æŸ¥çœ‹ä¾èµ–æ ‘
        // mvn dependency:tree
        // ./gradlew dependencies
        
        // 2. æ’é™¤å†²çªä¾èµ–
        /*
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
            <exclusions>
                <exclusion>
                    <groupId>org.springframework.boot</groupId>
                    <artifactId>spring-boot-starter-tomcat</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        */
        
        // 3. å¼ºåˆ¶æŒ‡å®šç‰ˆæœ¬
        /*
        <dependencyManagement>
            <dependencies>
                <dependency>
                    <groupId>com.fasterxml.jackson.core</groupId>
                    <artifactId>jackson-core</artifactId>
                    <version>2.13.4</version>
                </dependency>
            </dependencies>
        </dependencyManagement>
        */
    }
    
    /**
     * é—®é¢˜2ï¼šå¾ªç¯ä¾èµ–
     * 
     * åŸå› ï¼š
     * - Beanä¹‹é—´å­˜åœ¨å¾ªç¯å¼•ç”¨
     * - æ„é€ å™¨æ³¨å…¥å¯¼è‡´çš„å¾ªç¯ä¾èµ–
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solveCircularDependency() {
        // 1. ä½¿ç”¨@Lazyæ³¨è§£å»¶è¿Ÿåˆå§‹åŒ–
        /*
        @Service
        public class ServiceA {
            private final ServiceB serviceB;
            
            public ServiceA(@Lazy ServiceB serviceB) {
                this.serviceB = serviceB;
            }
        }
        */
        
        // 2. ä½¿ç”¨Setteræ³¨å…¥æ›¿ä»£æ„é€ å™¨æ³¨å…¥
        /*
        @Service
        public class ServiceA {
            @Autowired
            private ServiceB serviceB;
        }
        */
        
        // 3. é‡æ–°è®¾è®¡ç±»ç»“æ„ï¼Œæ¶ˆé™¤å¾ªç¯ä¾èµ–
        // 4. ä½¿ç”¨ApplicationContextæ‰‹åŠ¨è·å–Bean
        /*
        @Service
        public class ServiceA implements ApplicationContextAware {
            private ApplicationContext applicationContext;
            
            @PostConstruct
            public void init() {
                ServiceB serviceB = applicationContext.getBean(ServiceB.class);
            }
        }
        */
    }
    
    /**
     * é—®é¢˜3ï¼šBeanåˆ›å»ºå¤±è´¥
     * 
     * åŸå› ï¼š
     * - ç¼ºå°‘å¿…è¦çš„ä¾èµ–
     * - é…ç½®é”™è¯¯
     * - æ¡ä»¶æ³¨è§£ä¸æ»¡è¶³
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solveBeanCreationFailure() {
        // 1. æ£€æŸ¥ä¾èµ–æ˜¯å¦æ­£ç¡®æ·»åŠ 
        // 2. æ£€æŸ¥é…ç½®ç±»æ˜¯å¦æ­£ç¡®
        // 3. ä½¿ç”¨@ConditionalOnMissingBeanç­‰æ¡ä»¶æ³¨è§£
        // 4. å¯ç”¨è°ƒè¯•æ¨¡å¼æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
        // 5. æ£€æŸ¥Beançš„ä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸ
    }
}

/**
 * å¸¸è§ä¾èµ–å†²çªç¤ºä¾‹å’Œè§£å†³æ–¹æ¡ˆ
 */
public class CommonDependencyIssues {
    
    /**
     * Jacksonç‰ˆæœ¬å†²çª
     */
    public void jacksonVersionConflict() {
        // é—®é¢˜ï¼šä¸åŒçš„Jacksonç‰ˆæœ¬å¯¼è‡´åºåˆ—åŒ–/ååºåˆ—åŒ–å¤±è´¥
        
        // è§£å†³æ–¹æ¡ˆï¼šç»Ÿä¸€Jacksonç‰ˆæœ¬
        /*
        <properties>
            <jackson.version>2.13.4</jackson.version>
        </properties>
        
        <dependencyManagement>
            <dependencies>
                <dependency>
                    <groupId>com.fasterxml.jackson</groupId>
                    <artifactId>jackson-bom</artifactId>
                    <version>${jackson.version}</version>
                    <type>pom</type>
                    <scope>import</scope>
                </dependency>
            </dependencies>
        </dependencyManagement>
        */
    }
    
    /**
     * Servlet APIå†²çª
     */
    public void servletApiConflict() {
        // é—®é¢˜ï¼šå¤šä¸ªServlet APIç‰ˆæœ¬å†²çª
        
        // è§£å†³æ–¹æ¡ˆï¼šæ’é™¤å†²çªçš„Servlet API
        /*
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
            <exclusions>
                <exclusion>
                    <groupId>org.apache.tomcat.embed</groupId>
                    <artifactId>tomcat-embed-el</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        */
    }
    
    /**
     * æ—¥å¿—æ¡†æ¶å†²çª
     */
    public void loggingFrameworkConflict() {
        // é—®é¢˜ï¼šå¤šä¸ªæ—¥å¿—æ¡†æ¶å†²çªï¼ˆlogback, log4j, commons-loggingï¼‰
        
        // è§£å†³æ–¹æ¡ˆï¼šæ’é™¤å†²çªçš„æ—¥å¿—æ¡†æ¶
        /*
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter</artifactId>
            <exclusions>
                <exclusion>
                    <groupId>org.springframework.boot</groupId>
                    <artifactId>spring-boot-starter-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-log4j2</artifactId>
        </dependency>
        */
    }
}
```

### æ€§èƒ½é—®é¢˜

```java
/**
 * æ€§èƒ½é—®é¢˜è¯Šæ–­å’Œè§£å†³æ–¹æ¡ˆ
 */
public class PerformanceTroubleshooting {
    
    /**
     * é—®é¢˜1ï¼šåº”ç”¨å¯åŠ¨æ…¢
     * 
     * åŸå› ï¼š
     * - è‡ªåŠ¨é…ç½®æ‰«æèŒƒå›´è¿‡å¤§
     * - Beanåˆå§‹åŒ–è€—æ—¶
     * - æ•°æ®åº“è¿æ¥æ± åˆå§‹åŒ–æ…¢
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solveSlowStartup() {
        // 1. ç¼©å°ç»„ä»¶æ‰«æèŒƒå›´
        /*
        @SpringBootApplication(scanBasePackages = "com.example.specific.package")
        public class Application {
            // ...
        }
        */
        
        // 2. æ’é™¤ä¸éœ€è¦çš„è‡ªåŠ¨é…ç½®
        /*
        @SpringBootApplication(exclude = {
            DataSourceAutoConfiguration.class,
            RedisAutoConfiguration.class
        })
        */
        
        // 3. ä½¿ç”¨æ‡’åŠ è½½
        /*
        spring:
          main:
            lazy-initialization: true
        */
        
        // 4. ä¼˜åŒ–æ•°æ®åº“è¿æ¥æ± é…ç½®
        /*
        spring:
          datasource:
            hikari:
              minimum-idle: 1
              maximum-pool-size: 5
              connection-init-sql: SELECT 1
        */
        
        // 5. ä½¿ç”¨@Lazyæ³¨è§£å»¶è¿Ÿåˆå§‹åŒ–éå…³é”®Bean
        /*
        @Bean
        @Lazy
        public ExpensiveService expensiveService() {
            return new ExpensiveService();
        }
        */
    }
    
    /**
     * é—®é¢˜2ï¼šå†…å­˜æ³„æ¼
     * 
     * åŸå› ï¼š
     * - ç¼“å­˜æœªæ­£ç¡®æ¸…ç†
     * - çº¿ç¨‹æ± æœªæ­£ç¡®å…³é—­
     * - ç›‘å¬å™¨æœªæ­£ç¡®ç§»é™¤
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solveMemoryLeak() {
        // 1. æ­£ç¡®é…ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´
        /*
        @Cacheable(value = "users", key = "#id")
        @CacheEvict(value = "users", key = "#id", condition = "#result == null")
        public User getUserById(Long id) {
            return userRepository.findById(id).orElse(null);
        }
        */
        
        // 2. æ­£ç¡®å…³é—­çº¿ç¨‹æ± 
        /*
        @PreDestroy
        public void cleanup() {
            if (executorService != null && !executorService.isShutdown()) {
                executorService.shutdown();
                try {
                    if (!executorService.awaitTermination(60, TimeUnit.SECONDS)) {
                        executorService.shutdownNow();
                    }
                } catch (InterruptedException e) {
                    executorService.shutdownNow();
                    Thread.currentThread().interrupt();
                }
            }
        }
        */
        
        // 3. ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
        /*
        @PreDestroy
        public void removeListeners() {
            applicationEventPublisher.removeApplicationListener(this);
        }
        */
        
        // 4. ä½¿ç”¨WeakReferenceé¿å…å¼ºå¼•ç”¨
        /*
        private final Map<String, WeakReference<Object>> cache = new ConcurrentHashMap<>();
        */
    }
    
    /**
     * é—®é¢˜3ï¼šæ•°æ®åº“è¿æ¥æ± è€—å°½
     * 
     * åŸå› ï¼š
     * - è¿æ¥æœªæ­£ç¡®å…³é—­
     * - è¿æ¥æ± é…ç½®ä¸å½“
     * - é•¿æ—¶é—´è¿è¡Œçš„äº‹åŠ¡
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solveDatabaseConnectionIssues() {
        // 1. ä¼˜åŒ–è¿æ¥æ± é…ç½®
        /*
        spring:
          datasource:
            hikari:
              maximum-pool-size: 20
              minimum-idle: 5
              connection-timeout: 30000
              idle-timeout: 600000
              max-lifetime: 1800000
              leak-detection-threshold: 60000
        */
        
        // 2. ä½¿ç”¨try-with-resourcesç¡®ä¿è¿æ¥å…³é—­
        /*
        try (Connection connection = dataSource.getConnection();
             PreparedStatement statement = connection.prepareStatement(sql)) {
            // æ‰§è¡ŒSQL
        } catch (SQLException e) {
            // å¤„ç†å¼‚å¸¸
        }
        */
        
        // 3. é¿å…é•¿æ—¶é—´è¿è¡Œçš„äº‹åŠ¡
        /*
        @Transactional(timeout = 30) // 30ç§’è¶…æ—¶
        public void processLargeDataset() {
            // åˆ†æ‰¹å¤„ç†å¤§æ•°æ®é›†
            int batchSize = 1000;
            int offset = 0;
            
            List<Data> batch;
            do {
                batch = dataRepository.findBatch(offset, batchSize);
                processBatch(batch);
                offset += batchSize;
            } while (!batch.isEmpty());
        }
        */
        
        // 4. ç›‘æ§è¿æ¥æ± çŠ¶æ€
        /*
        @Component
        public class ConnectionPoolMonitor {
            
            @Autowired
            private HikariDataSource dataSource;
            
            @Scheduled(fixedRate = 60000) // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
            public void monitorConnectionPool() {
                HikariPoolMXBean poolBean = dataSource.getHikariPoolMXBean();
                
                log.info("Connection Pool Status: " +
                        "Active={}, Idle={}, Total={}, Waiting={}", 
                        poolBean.getActiveConnections(),
                        poolBean.getIdleConnections(),
                        poolBean.getTotalConnections(),
                        poolBean.getThreadsAwaitingConnection());
                
                if (poolBean.getActiveConnections() > poolBean.getMaximumPoolSize() * 0.8) {
                    log.warn("Connection pool usage is high: {}%", 
                            (poolBean.getActiveConnections() * 100.0 / poolBean.getMaximumPoolSize()));
                }
            }
        }
        */
    }
    
    /**
     * é—®é¢˜4ï¼šCPUä½¿ç”¨ç‡è¿‡é«˜
     * 
     * åŸå› ï¼š
     * - æ— é™å¾ªç¯æˆ–é€’å½’
     * - é¢‘ç¹çš„GC
     * - çº¿ç¨‹ç«äº‰
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solveCpuUsageIssues() {
        // 1. ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·
        // - JProfiler
        // - VisualVM
        // - Async Profiler
        
        // 2. ä¼˜åŒ–ç®—æ³•å’Œæ•°æ®ç»“æ„
        /*
        // é¿å…åœ¨å¾ªç¯ä¸­è¿›è¡Œå¤æ‚è®¡ç®—
        // ä½¿ç”¨åˆé€‚çš„æ•°æ®ç»“æ„ï¼ˆHashMap vs TreeMapï¼‰
        // ç¼“å­˜è®¡ç®—ç»“æœ
        */
        
        // 3. ä¼˜åŒ–GCé…ç½®
        /*
        # JVMå‚æ•°
        -XX:+UseG1GC
        -XX:MaxGCPauseMillis=200
        -XX:G1HeapRegionSize=16m
        -XX:+G1UseAdaptiveIHOP
        -XX:G1MixedGCCountTarget=8
        */
        
        // 4. å‡å°‘çº¿ç¨‹ç«äº‰
        /*
        // ä½¿ç”¨ConcurrentHashMapæ›¿ä»£synchronized HashMap
        // ä½¿ç”¨ThreadLocalé¿å…å…±äº«çŠ¶æ€
        // ä½¿ç”¨æ— é”æ•°æ®ç»“æ„
        */
    }
}

/**
 * æ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜å·¥å…·
 */
public class PerformanceMonitoring {
    
    /**
     * JVMç›‘æ§
     */
    public void jvmMonitoring() {
        // 1. å¯ç”¨JVMç›‘æ§
        /*
        # JVMå‚æ•°
        -XX:+PrintGC
        -XX:+PrintGCDetails
        -XX:+PrintGCTimeStamps
        -XX:+PrintGCApplicationStoppedTime
        -Xloggc:gc.log
        */
        
        // 2. ä½¿ç”¨Micrometerç›‘æ§JVMæŒ‡æ ‡
        /*
        management:
          metrics:
            export:
              prometheus:
                enabled: true
            tags:
              application: ${spring.application.name}
        */
    }
    
    /**
     * åº”ç”¨æ€§èƒ½ç›‘æ§
     */
    @Component
    public class ApplicationPerformanceMonitor {
        
        private final MeterRegistry meterRegistry;
        private final Timer requestTimer;
        private final Counter errorCounter;
        
        public ApplicationPerformanceMonitor(MeterRegistry meterRegistry) {
            this.meterRegistry = meterRegistry;
            this.requestTimer = Timer.builder("http.requests")
                    .description("HTTP request duration")
                    .register(meterRegistry);
            this.errorCounter = Counter.builder("http.errors")
                    .description("HTTP error count")
                    .register(meterRegistry);
        }
        
        @EventListener
        public void handleRequestEvent(RequestEvent event) {
            requestTimer.record(event.getDuration(), TimeUnit.MILLISECONDS);
            
            if (event.isError()) {
                errorCounter.increment(
                        Tags.of(
                                "method", event.getMethod(),
                                "uri", event.getUri(),
                                "status", String.valueOf(event.getStatus())
                        )
                );
            }
        }
    }
}
```

### å®‰å…¨é—®é¢˜

```java
/**
 * å®‰å…¨é—®é¢˜è§£å†³æ–¹æ¡ˆ
 */
public class SecurityTroubleshooting {
    
    /**
     * é—®é¢˜1ï¼šCSRFæ”»å‡»é˜²æŠ¤
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    @Configuration
    @EnableWebSecurity
    public class CsrfSecurityConfig {
        
        @Bean
        public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
            http
                .csrf(csrf -> csrf
                    .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())
                    .ignoringRequestMatchers("/api/public/**")
                )
                .sessionManagement(session -> session
                    .sessionCreationPolicy(SessionCreationPolicy.STATELESS)
                );
            
            return http.build();
        }
    }
    
    /**
     * é—®é¢˜2ï¼šSQLæ³¨å…¥é˜²æŠ¤
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    @Repository
    public class SecureUserRepository {
        
        @Autowired
        private JdbcTemplate jdbcTemplate;
        
        // æ­£ç¡®ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
        public List<User> findUsersByName(String name) {
            String sql = "SELECT * FROM users WHERE name = ?";
            return jdbcTemplate.query(sql, new Object[]{name}, new UserRowMapper());
        }
        
        // é”™è¯¯ï¼šç›´æ¥æ‹¼æ¥SQLï¼ˆå®¹æ˜“SQLæ³¨å…¥ï¼‰
        // public List<User> findUsersByNameUnsafe(String name) {
        //     String sql = "SELECT * FROM users WHERE name = '" + name + "'";
        //     return jdbcTemplate.query(sql, new UserRowMapper());
        // }
    }
    
    /**
     * é—®é¢˜3ï¼šXSSæ”»å‡»é˜²æŠ¤
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    @Component
    public class XssProtection {
        
        // 1. è¾“å…¥éªŒè¯å’Œæ¸…ç†
        public String sanitizeInput(String input) {
            if (input == null) {
                return null;
            }
            
            // ç§»é™¤æˆ–è½¬ä¹‰å±é™©å­—ç¬¦
            return input.replaceAll("<script[^>]*>.*?</script>", "")
                       .replaceAll("<", "&lt;")
                       .replaceAll(">", "&gt;")
                       .replaceAll("\"", "&quot;")
                       .replaceAll("'", "&#x27;");
        }
        
        // 2. ä½¿ç”¨OWASP Java HTML Sanitizer
        /*
        <dependency>
            <groupId>com.googlecode.owasp-java-html-sanitizer</groupId>
            <artifactId>owasp-java-html-sanitizer</artifactId>
            <version>20220608.1</version>
        </dependency>
        */
        
        public String sanitizeHtml(String html) {
            PolicyFactory policy = Sanitizers.FORMATTING.and(Sanitizers.LINKS);
            return policy.sanitize(html);
        }
    }
    
    /**
     * é—®é¢˜4ï¼šæ•æ„Ÿä¿¡æ¯æ³„éœ²
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    @Configuration
    public class SensitiveDataProtection {
        
        // 1. é…ç½®å±æ€§åŠ å¯†
        /*
        # ä½¿ç”¨jasyptåŠ å¯†æ•æ„Ÿé…ç½®
        spring:
          datasource:
            password: ENC(encrypted_password)
        
        jasypt:
          encryptor:
            password: ${JASYPT_ENCRYPTOR_PASSWORD}
            algorithm: PBEWithMD5AndDES
        */
        
        // 2. æ—¥å¿—è„±æ•
        @Bean
        public Logger sensitiveDataLogger() {
            LoggerContext context = (LoggerContext) LoggerFactory.getILoggerFactory();
            
            // é…ç½®è„±æ•è§„åˆ™
            PatternLayoutEncoder encoder = new PatternLayoutEncoder();
            encoder.setContext(context);
            encoder.setPattern("%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n");
            encoder.start();
            
            return context.getLogger("SENSITIVE_DATA");
        }
        
        // 3. APIå“åº”è„±æ•
        @JsonIgnore
        private String password;
        
        @JsonProperty(access = JsonProperty.Access.WRITE_ONLY)
        private String sensitiveField;
    }
    
    /**
     * é—®é¢˜5ï¼šä¼šè¯ç®¡ç†å®‰å…¨
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    @Configuration
    public class SessionSecurityConfig {
        
        @Bean
        public HttpSessionEventPublisher httpSessionEventPublisher() {
            return new HttpSessionEventPublisher();
        }
        
        @Bean
        public SessionRegistry sessionRegistry() {
            return new SessionRegistryImpl();
        }
        
        @Bean
        public SecurityFilterChain sessionSecurityFilterChain(HttpSecurity http) throws Exception {
            http
                .sessionManagement(session -> session
                    .sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED)
                    .maximumSessions(1)
                    .maxSessionsPreventsLogin(false)
                    .sessionRegistry(sessionRegistry())
                    .and()
                    .sessionFixation().migrateSession()
                    .invalidSessionUrl("/login?expired")
                )
                .rememberMe(remember -> remember
                    .key("uniqueAndSecret")
                    .tokenValiditySeconds(86400)
                    .userDetailsService(userDetailsService())
                );
            
            return http.build();
        }
    }
}
```

### éƒ¨ç½²é—®é¢˜

```java
/**
 * éƒ¨ç½²é—®é¢˜è§£å†³æ–¹æ¡ˆ
 */
public class DeploymentTroubleshooting {
    
    /**
     * é—®é¢˜1ï¼šç«¯å£å†²çª
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solvePortConflicts() {
        // 1. ä¿®æ”¹åº”ç”¨ç«¯å£
        /*
        server:
          port: 8081
        */
        
        // 2. ä½¿ç”¨éšæœºç«¯å£
        /*
        server:
          port: 0
        */
        
        // 3. æ£€æŸ¥ç«¯å£å ç”¨
        /*
        # Linux/Mac
        lsof -i :8080
        netstat -tulpn | grep 8080
        
        # Windows
        netstat -ano | findstr 8080
        */
        
        // 4. ä½¿ç”¨Dockerç«¯å£æ˜ å°„
        /*
        docker run -p 8081:8080 myapp
        */
    }
    
    /**
     * é—®é¢˜2ï¼šç¯å¢ƒå˜é‡é…ç½®
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solveEnvironmentVariables() {
        // 1. ä½¿ç”¨ç¯å¢ƒå˜é‡è¦†ç›–é…ç½®
        /*
        # è®¾ç½®ç¯å¢ƒå˜é‡
        export SPRING_DATASOURCE_URL=jdbc:mysql://prod-db:3306/mydb
        export SPRING_DATASOURCE_USERNAME=prod_user
        export SPRING_DATASOURCE_PASSWORD=prod_password
        */
        
        // 2. ä½¿ç”¨.envæ–‡ä»¶ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
        /*
        # .env
        SPRING_PROFILES_ACTIVE=dev
        DATABASE_URL=jdbc:mysql://localhost:3306/dev_db
        REDIS_URL=redis://localhost:6379
        */
        
        // 3. Dockerç¯å¢ƒå˜é‡
        /*
        # docker-compose.yml
        environment:
          - SPRING_PROFILES_ACTIVE=prod
          - SPRING_DATASOURCE_URL=jdbc:mysql://db:3306/mydb
        */
        
        // 4. Kubernetes ConfigMapå’ŒSecret
        /*
        # configmap.yaml
        apiVersion: v1
        kind: ConfigMap
        metadata:
          name: app-config
        data:
          SPRING_PROFILES_ACTIVE: "prod"
          
        # secret.yaml
        apiVersion: v1
        kind: Secret
        metadata:
          name: app-secret
        data:
          DATABASE_PASSWORD: <base64-encoded-password>
        */
    }
    
    /**
     * é—®é¢˜3ï¼šå¥åº·æ£€æŸ¥å¤±è´¥
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    @Component
    public class DeploymentHealthCheck {
        
        @Autowired
        private DataSource dataSource;
        
        @Autowired
        private RedisTemplate<String, Object> redisTemplate;
        
        // 1. è‡ªå®šä¹‰å¥åº·æ£€æŸ¥
        @Bean
        public HealthIndicator deploymentHealthIndicator() {
            return new AbstractHealthIndicator() {
                @Override
                protected void doHealthCheck(Health.Builder builder) throws Exception {
                    // æ£€æŸ¥æ•°æ®åº“è¿æ¥
                    try (Connection connection = dataSource.getConnection()) {
                        if (connection.isValid(1)) {
                            builder.withDetail("database", "UP");
                        } else {
                            builder.down().withDetail("database", "Connection invalid");
                            return;
                        }
                    }
                    
                    // æ£€æŸ¥Redisè¿æ¥
                    try {
                        String pong = redisTemplate.getConnectionFactory()
                                .getConnection().ping();
                        if ("PONG".equals(pong)) {
                            builder.withDetail("redis", "UP");
                        } else {
                            builder.down().withDetail("redis", "Ping failed");
                            return;
                        }
                    } catch (Exception e) {
                        builder.down().withDetail("redis", "Connection failed: " + e.getMessage());
                        return;
                    }
                    
                    builder.up();
                }
            };
        }
        
        // 2. é…ç½®å¥åº·æ£€æŸ¥ç«¯ç‚¹
        /*
        management:
          endpoint:
            health:
              show-details: always
              probes:
                enabled: true
          health:
            livenessstate:
              enabled: true
            readinessstate:
              enabled: true
        */
    }
    
    /**
     * é—®é¢˜4ï¼šèµ„æºé™åˆ¶
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    public void solveResourceLimits() {
        // 1. JVMå†…å­˜é…ç½®
        /*
        # è®¾ç½®å †å†…å­˜
        -Xms512m -Xmx1024m
        
        # è®¾ç½®å…ƒç©ºé—´
        -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=256m
        
        # è®¾ç½®ç›´æ¥å†…å­˜
        -XX:MaxDirectMemorySize=256m
        */
        
        // 2. Dockerèµ„æºé™åˆ¶
        /*
        # docker run
        docker run --memory=1g --cpus=1.0 myapp
        
        # docker-compose.yml
        services:
          app:
            deploy:
              resources:
                limits:
                  memory: 1G
                  cpus: '1.0'
                reservations:
                  memory: 512M
                  cpus: '0.5'
        */
        
        // 3. Kubernetesèµ„æºé™åˆ¶
        /*
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "500m"
        */
        
        // 4. ç›‘æ§èµ„æºä½¿ç”¨
        /*
        # æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
        docker stats
        
        # æŸ¥çœ‹Podèµ„æºä½¿ç”¨
        kubectl top pods
        
        # æŸ¥çœ‹èŠ‚ç‚¹èµ„æºä½¿ç”¨
        kubectl top nodes
        */
    }
    
    /**
     * é—®é¢˜5ï¼šæ—¥å¿—æ”¶é›†å’Œåˆ†æ
     * 
     * è§£å†³æ–¹æ¡ˆï¼š
     */
    @Configuration
    public class LoggingConfiguration {
        
        // 1. ç»“æ„åŒ–æ—¥å¿—é…ç½®
        /*
        # logback-spring.xml
        <configuration>
            <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
                <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder">
                    <providers>
                        <timestamp/>
                        <logLevel/>
                        <loggerName/>
                        <message/>
                        <mdc/>
                        <stackTrace/>
                    </providers>
                </encoder>
            </appender>
            
            <root level="INFO">
                <appender-ref ref="STDOUT"/>
            </root>
        </configuration>
        */
        
        // 2. æ·»åŠ è¿½è¸ªID
        @Component
        public class TraceIdFilter implements Filter {
            
            @Override
            public void doFilter(ServletRequest request, ServletResponse response, 
                               FilterChain chain) throws IOException, ServletException {
                
                String traceId = UUID.randomUUID().toString();
                MDC.put("traceId", traceId);
                
                try {
                    chain.doFilter(request, response);
                } finally {
                    MDC.clear();
                }
            }
        }
        
        // 3. ELK Stacké›†æˆ
        /*
        # docker-compose.yml
        services:
          elasticsearch:
            image: docker.elastic.co/elasticsearch/elasticsearch:7.15.0
            environment:
              - discovery.type=single-node
            ports:
              - "9200:9200"
          
          logstash:
            image: docker.elastic.co/logstash/logstash:7.15.0
            volumes:
              - ./logstash.conf:/usr/share/logstash/pipeline/logstash.conf
            ports:
              - "5000:5000"
          
          kibana:
            image: docker.elastic.co/kibana/kibana:7.15.0
            ports:
              - "5601:5601"
            environment:
              - ELASTICSEARCH_HOSTS=http://elasticsearch:9200
        */
    }
}
/*
 * ä¾èµ–é—®é¢˜è§£å†³æ–¹æ¡ˆ
 */
public class DependencyTroubleshooting {
    
    /**
     * é—®é¢˜ï¼šä¾èµ–å†²çª
     * è§£å†³æ–¹æ¡ˆï¼š
     * 1. æŸ¥çœ‹ä¾èµ–æ ‘ï¼šmvn dependency:tree
     * 2. æ’é™¤å†²çªä¾èµ–ï¼š<exclusions>
     * 3. å¼ºåˆ¶æŒ‡å®šç‰ˆæœ¬ï¼š<dependencyManagement>
     */
    
    /**
     * é—®é¢˜ï¼šè‡ªåŠ¨é…ç½®ä¸ç”Ÿæ•ˆ
     * è§£å†³æ–¹æ¡ˆï¼š
     * 1. æ£€æŸ¥æ˜¯å¦å¼•å…¥äº†æ­£ç¡®çš„starterä¾èµ–
     * 2. æŸ¥çœ‹è‡ªåŠ¨é…ç½®æŠ¥å‘Šï¼š--debug
     * 3. æ£€æŸ¥æ¡ä»¶æ³¨è§£æ˜¯å¦æ»¡è¶³
     */
    
    /**
     * é—®é¢˜ï¼šç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜
     * è§£å†³æ–¹æ¡ˆï¼š
     * 1. ä½¿ç”¨å…¼å®¹çš„ç‰ˆæœ¬ç»„åˆ
     * 2. å‚è€ƒå®˜æ–¹æ–‡æ¡£ä¸­çš„ç‰ˆæœ¬å…¼å®¹æ€§çŸ©é˜µ
     * 3. ä½¿ç”¨Spring Bootä¾èµ–ç®¡ç†
     */
}
```

### æ€§èƒ½é—®é¢˜

```java
/**
 * æ€§èƒ½é—®é¢˜è§£å†³æ–¹æ¡ˆ
 */
public class PerformanceTroubleshooting {
    
    /**
     * é—®é¢˜ï¼šåº”ç”¨å¯åŠ¨æ…¢
     * è§£å†³æ–¹æ¡ˆï¼š
     * 1. ä½¿ç”¨æ‡’åŠ è½½ï¼šspring.main.lazy-initialization=true
     * 2. å‡å°‘ç»„ä»¶æ‰«æèŒƒå›´
     * 3. ä¼˜åŒ–æ•°æ®åº“åˆå§‹åŒ–
     * 4. ä½¿ç”¨å¼‚æ­¥åˆå§‹åŒ–
     */
    
    /**
     * é—®é¢˜ï¼šå“åº”æ—¶é—´é•¿
     * è§£å†³æ–¹æ¡ˆï¼š
     * 1. ä½¿ç”¨å¼‚æ­¥å¤„ç†
     * 2. ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
     * 3. æ·»åŠ ç¼“å­˜
     * 4. ä½¿ç”¨è¿æ¥æ± 
     * 5. è°ƒæ•´çº¿ç¨‹æ± å‚æ•°
     */
    
    /**
     * é—®é¢˜ï¼šå†…å­˜å ç”¨é«˜
     * è§£å†³æ–¹æ¡ˆï¼š
     * 1. è°ƒæ•´JVMå‚æ•°
     * 2. æ£€æŸ¥å†…å­˜æ³„æ¼
     * 3. ä¼˜åŒ–å¯¹è±¡åˆ›å»ºå’Œé”€æ¯
     * 4. ä½¿ç”¨åˆ†é¡µæŸ¥è¯¢
     */
}
```

## å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£

| èµ„æº | é“¾æ¥ | è¯´æ˜ |
|------|------|------|
| SpringBootå®˜æ–¹æ–‡æ¡£ | https://spring.io/projects/spring-boot | æœ€æƒå¨çš„å®˜æ–¹æ–‡æ¡£ |
| SpringBootå‚è€ƒæŒ‡å— | https://docs.spring.io/spring-boot/docs/current/reference/html/ | è¯¦ç»†çš„å‚è€ƒæ‰‹å†Œ |
| SpringBoot APIæ–‡æ¡£ | https://docs.spring.io/spring-boot/docs/current/api/ | APIæ¥å£æ–‡æ¡£ |
| Spring Initializr | https://start.spring.io/ | é¡¹ç›®å¿«é€Ÿç”Ÿæˆå·¥å…· |
| SpringBoot Starters | https://docs.spring.io/spring-boot/docs/current/reference/html/using.html#using.build-systems.starters | å®˜æ–¹Starteråˆ—è¡¨ |
| SpringBoot Actuator | https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html | ç›‘æ§å’Œç®¡ç†æ–‡æ¡£ |

### ç¤¾åŒºèµ„æº

| èµ„æº | é“¾æ¥ | è¯´æ˜ |
|------|------|------|
| SpringBoot GitHub | https://github.com/spring-projects/spring-boot | æºç ä»“åº“ |
| Springå®˜æ–¹åšå®¢ | https://spring.io/blog | æœ€æ–°åŠ¨æ€å’ŒæŠ€æœ¯æ–‡ç«  |
| Baeldung SpringBoot | https://www.baeldung.com/spring-boot | é«˜è´¨é‡æ•™ç¨‹ç½‘ç«™ |
| SpringBootä¸­æ–‡ç¤¾åŒº | https://springboot.io/ | ä¸­æ–‡å­¦ä¹ èµ„æº |
| Stack Overflow | https://stackoverflow.com/questions/tagged/spring-boot | é—®é¢˜è§£ç­”ç¤¾åŒº |
| SpringBoot Awesome | https://github.com/stunstunstun/awesome-spring-boot | ä¼˜ç§€èµ„æºæ±‡æ€» |

### ä¹¦ç±æ¨è

#### å…¥é—¨çº§ä¹¦ç±

| ä¹¦å | ä½œè€… | æ¨èæŒ‡æ•° | è¯´æ˜ |
|------|------|----------|------|
| ã€ŠSpringBootå®æˆ˜ã€‹ | Craig Walls | â­â­â­â­â­ | ç»å…¸å…¥é—¨ä¹¦ç±ï¼Œé€‚åˆåˆå­¦è€… |
| ã€ŠSpringBootæ­ç§˜ã€‹ | ç‹ç¦å¼º | â­â­â­â­ | æ·±å…¥æµ…å‡ºï¼Œä¸­æ–‡åŸåˆ› |
| ã€ŠSpringBootç¼–ç¨‹æ€æƒ³ã€‹ | å°é©¬å“¥ | â­â­â­â­â­ | æ·±åº¦è§£æSpringBootæ ¸å¿ƒæœºåˆ¶ |

#### è¿›é˜¶çº§ä¹¦ç±

| ä¹¦å | ä½œè€… | æ¨èæŒ‡æ•° | è¯´æ˜ |
|------|------|----------|------|
| ã€ŠSpringå¾®æœåŠ¡å®æˆ˜ã€‹ | John Carnell | â­â­â­â­ | å¾®æœåŠ¡æ¶æ„å®è·µ |
| ã€ŠSpringBoot+Vueå…¨æ ˆå¼€å‘å®æˆ˜ã€‹ | ç‹æ¾ | â­â­â­ | å…¨æ ˆå¼€å‘å®è·µ |
| ã€ŠSpringCloudå¾®æœåŠ¡å®æˆ˜ã€‹ | ç¿Ÿæ°¸è¶… | â­â­â­â­ | SpringCloudç”Ÿæ€å®è·µ |

#### æºç åˆ†æä¹¦ç±

| ä¹¦å | ä½œè€… | æ¨èæŒ‡æ•° | è¯´æ˜ |
|------|------|----------|------|
| ã€ŠSpringBootæºç æ·±åº¦è§£æã€‹ | éƒ‘å¤©æ°‘ | â­â­â­â­ | æºç çº§åˆ«çš„æ·±åº¦åˆ†æ |
| ã€ŠSpringæŠ€æœ¯å†…å¹•ã€‹ | è®¡æ–‡æŸ¯ | â­â­â­â­â­ | Springæ¡†æ¶åº•å±‚åŸç† |

### å­¦ä¹ è·¯å¾„å»ºè®®

```mermaid
graph TD
    A[SpringBootå­¦ä¹ è·¯å¾„] --> B[åŸºç¡€é˜¶æ®µ]
    A --> C[è¿›é˜¶é˜¶æ®µ]
    A --> D[é«˜çº§é˜¶æ®µ]
    A --> E[ä¸“å®¶é˜¶æ®µ]
    
    B --> B1[JavaåŸºç¡€]
    B --> B2[Spring Framework]
    B --> B3[SpringBootå…¥é—¨]
    B --> B4[Webå¼€å‘åŸºç¡€]
    
    C --> C1[æ•°æ®è®¿é—®]
    C --> C2[å®‰å…¨æ¡†æ¶]
    C --> C3[æµ‹è¯•æ¡†æ¶]
    C --> C4[é…ç½®ç®¡ç†]
    
    D --> D1[å¾®æœåŠ¡æ¶æ„]
    D --> D2[ç›‘æ§è¿ç»´]
    D --> D3[æ€§èƒ½ä¼˜åŒ–]
    D --> D4[æºç åˆ†æ]
    
    E --> E1[æ¶æ„è®¾è®¡]
    E --> E2[æŠ€æœ¯é€‰å‹]
    E --> E3[å›¢é˜Ÿç®¡ç†]
    E --> E4[æŠ€æœ¯åˆ†äº«]
```

### å®è·µé¡¹ç›®æ¨è

#### åˆçº§é¡¹ç›®

1. **ä¸ªäººåšå®¢ç³»ç»Ÿ**
   - æŠ€æœ¯æ ˆï¼šSpringBoot + Thymeleaf + MySQL
   - åŠŸèƒ½ï¼šæ–‡ç« ç®¡ç†ã€ç”¨æˆ·è®¤è¯ã€è¯„è®ºç³»ç»Ÿ
   - å­¦ä¹ é‡ç‚¹ï¼šWebå¼€å‘ã€æ•°æ®è®¿é—®ã€æ¨¡æ¿å¼•æ“

2. **åœ¨çº¿ä¹¦åº—**
   - æŠ€æœ¯æ ˆï¼šSpringBoot + Vue + MySQL + Redis
   - åŠŸèƒ½ï¼šå•†å“ç®¡ç†ã€è´­ç‰©è½¦ã€è®¢å•ç³»ç»Ÿ
   - å­¦ä¹ é‡ç‚¹ï¼šå‰åç«¯åˆ†ç¦»ã€ç¼“å­˜åº”ç”¨ã€äº‹åŠ¡ç®¡ç†

#### ä¸­çº§é¡¹ç›®

3. **ä¼ä¸šçº§CRMç³»ç»Ÿ**
   - æŠ€æœ¯æ ˆï¼šSpringBoot + Spring Security + JPA + PostgreSQL
   - åŠŸèƒ½ï¼šå®¢æˆ·ç®¡ç†ã€é”€å”®æµç¨‹ã€æƒé™æ§åˆ¶
   - å­¦ä¹ é‡ç‚¹ï¼šå®‰å…¨æ¡†æ¶ã€å¤æ‚ä¸šåŠ¡é€»è¾‘ã€æ•°æ®å»ºæ¨¡

4. **å¾®æœåŠ¡ç”µå•†å¹³å°**
   - æŠ€æœ¯æ ˆï¼šSpringBoot + SpringCloud + Docker + Kubernetes
   - åŠŸèƒ½ï¼šç”¨æˆ·æœåŠ¡ã€å•†å“æœåŠ¡ã€è®¢å•æœåŠ¡ã€æ”¯ä»˜æœåŠ¡
   - å­¦ä¹ é‡ç‚¹ï¼šå¾®æœåŠ¡æ¶æ„ã€æœåŠ¡æ²»ç†ã€å®¹å™¨åŒ–éƒ¨ç½²

#### é«˜çº§é¡¹ç›®

5. **åˆ†å¸ƒå¼ç›‘æ§ç³»ç»Ÿ**
   - æŠ€æœ¯æ ˆï¼šSpringBoot + Micrometer + Prometheus + Grafana
   - åŠŸèƒ½ï¼šæŒ‡æ ‡æ”¶é›†ã€å‘Šè­¦é€šçŸ¥ã€å¯è§†åŒ–å±•ç¤º
   - å­¦ä¹ é‡ç‚¹ï¼šç›‘æ§ä½“ç³»ã€åˆ†å¸ƒå¼ç³»ç»Ÿã€è¿ç»´è‡ªåŠ¨åŒ–

6. **å¤§æ•°æ®å¤„ç†å¹³å°**
   - æŠ€æœ¯æ ˆï¼šSpringBoot + Apache Kafka + Apache Spark + Elasticsearch
   - åŠŸèƒ½ï¼šæ•°æ®é‡‡é›†ã€å®æ—¶å¤„ç†ã€æœç´¢åˆ†æ
   - å­¦ä¹ é‡ç‚¹ï¼šå¤§æ•°æ®æŠ€æœ¯ã€æµå¼å¤„ç†ã€æœç´¢å¼•æ“

### è®¤è¯è€ƒè¯•

| è®¤è¯ | æœºæ„ | éš¾åº¦ | è¯´æ˜ |
|------|------|------|------|
| Spring Professional | VMware | â­â­â­ | Springå®˜æ–¹è®¤è¯ |
| Oracle Java SE | Oracle | â­â­â­â­ | JavaåŸºç¡€è®¤è¯ |
| AWS Certified Developer | Amazon | â­â­â­â­ | äº‘å¹³å°å¼€å‘è®¤è¯ |

### æŠ€æœ¯ç¤¾åŒº

| ç¤¾åŒº | ç±»å‹ | æ´»è·ƒåº¦ | è¯´æ˜ |
|------|------|--------|------|
| æ˜é‡‘ | æŠ€æœ¯åšå®¢ | â­â­â­â­â­ | ä¸­æ–‡æŠ€æœ¯ç¤¾åŒº |
| CSDN | æŠ€æœ¯åšå®¢ | â­â­â­â­ | è€ç‰ŒæŠ€æœ¯ç¤¾åŒº |
| åšå®¢å›­ | æŠ€æœ¯åšå®¢ | â­â­â­ | .NETå’ŒJavaç¤¾åŒº |
| GitHub | ä»£ç æ‰˜ç®¡ | â­â­â­â­â­ | å…¨çƒæœ€å¤§ä»£ç æ‰˜ç®¡å¹³å° |
| Stack Overflow | é—®ç­”ç¤¾åŒº | â­â­â­â­â­ | æŠ€æœ¯é—®ç­”é¦–é€‰ |

### æŒç»­å­¦ä¹ å»ºè®®

1. **å…³æ³¨æŠ€æœ¯åŠ¨æ€**
   - è®¢é˜…Springå®˜æ–¹åšå®¢
   - å…³æ³¨æŠ€æœ¯å¤§ä¼šï¼ˆSpringOneã€QConç­‰ï¼‰
   - å‚ä¸å¼€æºé¡¹ç›®è´¡çŒ®

2. **å®è·µé©±åŠ¨å­¦ä¹ **
   - ä»å°é¡¹ç›®å¼€å§‹å®è·µ
   - é€æ­¥å¢åŠ é¡¹ç›®å¤æ‚åº¦
   - æ€»ç»“ç»éªŒæ•™è®­

3. **çŸ¥è¯†ä½“ç³»æ„å»º**
   - å»ºç«‹å®Œæ•´çš„çŸ¥è¯†å›¾è°±
   - å®šæœŸå›é¡¾å’Œæ›´æ–°
   - åˆ†äº«äº¤æµç»éªŒ

4. **æ·±åº¦ä¸å¹¿åº¦å¹¶é‡**
   - æ·±å…¥ç†è§£æ ¸å¿ƒåŸç†
   - æ‰©å±•ç›¸å…³æŠ€æœ¯æ ˆ
   - å…³æ³¨è¡Œä¸šå‘å±•è¶‹åŠ¿

---

## æ–‡æ¡£æ€»ç»“

æœ¬SpringBootæ ¸å¿ƒçŸ¥è¯†ä½“ç³»æ–‡æ¡£æ¶µç›–äº†ä»¥ä¸‹ä¸»è¦å†…å®¹ï¼š

### ğŸ“š çŸ¥è¯†è¦†ç›–èŒƒå›´

- **åŸºç¡€æ¦‚å¿µ**ï¼šSpringBootç®€ä»‹ã€æ ¸å¿ƒç‰¹æ€§ã€ç‰ˆæœ¬æ¼”è¿›
- **å¿«é€Ÿå…¥é—¨**ï¼šç¯å¢ƒæ­å»ºã€é¡¹ç›®åˆ›å»ºã€é…ç½®ç®¡ç†
- **æ ¸å¿ƒæœºåˆ¶**ï¼šè‡ªåŠ¨é…ç½®åŸç†ã€å¯åŠ¨æµç¨‹ã€æ³¨è§£ä½“ç³»
- **å¼€å‘å®è·µ**ï¼šWebå¼€å‘ã€æ•°æ®è®¿é—®ã€å®‰å…¨æ¡†æ¶ã€å¾®æœåŠ¡
- **æµ‹è¯•æ¡†æ¶**ï¼šå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€åˆ‡ç‰‡æµ‹è¯•
- **é«˜çº§ç‰¹æ€§**ï¼šç¼“å­˜æœºåˆ¶ã€å¼‚æ­¥å¤„ç†ã€äº‹ä»¶æœºåˆ¶ã€ç›‘æ§ç®¡ç†
- **éƒ¨ç½²è¿ç»´**ï¼šDockerå®¹å™¨åŒ–ã€Kuberneteséƒ¨ç½²ã€CI/CDæµç¨‹
- **é—®é¢˜è§£å†³**ï¼šå¸¸è§é—®é¢˜è¯Šæ–­ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨é˜²æŠ¤

### ğŸ¯ æ–‡æ¡£ç‰¹è‰²

1. **ç»“æ„æ¸…æ™°**ï¼šé‡‡ç”¨å±‚æ¬¡åŒ–ç›®å½•ç»“æ„ï¼Œä¾¿äºæŸ¥æ‰¾å’Œå­¦ä¹ 
2. **å†…å®¹å…¨é¢**ï¼šä»å…¥é—¨åˆ°é«˜çº§ï¼Œè¦†ç›–SpringBootå…¨ç”Ÿå‘½å‘¨æœŸ
3. **å®ä¾‹ä¸°å¯Œ**ï¼šæä¾›å¤§é‡ä»£ç ç¤ºä¾‹å’Œé…ç½®æ¨¡æ¿
4. **å›¾è¡¨ç›´è§‚**ï¼šä½¿ç”¨Mermaidæµç¨‹å›¾å’Œè¡¨æ ¼å¢å¼ºç†è§£
5. **é¢è¯•å¯¼å‘**ï¼šé‡ç‚¹å…³æ³¨é«˜é¢‘é¢è¯•é¢˜å’Œè§£é¢˜æ€è·¯
6. **å®æˆ˜ç»éªŒ**ï¼šåŒ…å«ä¸šåŠ¡ä½¿ç”¨ç»éªŒå’Œé—®é¢˜æ’æŸ¥æ–¹æ³•

### ğŸš€ ä½¿ç”¨å»ºè®®

- **åˆå­¦è€…**ï¼šæŒ‰é¡ºåºå­¦ä¹ åŸºç¡€æ¦‚å¿µå’Œå¿«é€Ÿå…¥é—¨éƒ¨åˆ†
- **æœ‰ç»éªŒè€…**ï¼šé‡ç‚¹å…³æ³¨é«˜çº§ç‰¹æ€§å’Œé—®é¢˜è§£å†³æ–¹æ¡ˆ
- **é¢è¯•å‡†å¤‡**ï¼šé‡ç‚¹å¤ä¹ å¸¸è§é¢è¯•é¢˜éƒ¨åˆ†
- **é¡¹ç›®å®è·µ**ï¼šå‚è€ƒæœ€ä½³å®è·µå’Œéƒ¨ç½²è¿ç»´ç« èŠ‚

### ğŸ“ˆ æŒç»­æ›´æ–°

æœ¬æ–‡æ¡£å°†æ ¹æ®SpringBootç‰ˆæœ¬æ›´æ–°å’ŒæŠ€æœ¯å‘å±•æŒç»­å®Œå–„ï¼Œå»ºè®®ï¼š

- å®šæœŸæŸ¥çœ‹å®˜æ–¹æ–‡æ¡£è·å–æœ€æ–°ä¿¡æ¯
- å…³æ³¨ç¤¾åŒºåŠ¨æ€å’Œæœ€ä½³å®è·µ
- ç»“åˆå®é™…é¡¹ç›®ç»éªŒä¸æ–­æ·±åŒ–ç†è§£
- ç§¯æå‚ä¸æŠ€æœ¯äº¤æµå’Œåˆ†äº«

å¸Œæœ›è¿™ä»½æ–‡æ¡£èƒ½å¤Ÿå¸®åŠ©ä½ å…¨é¢æŒæ¡SpringBootæŠ€æœ¯æ ˆï¼Œåœ¨å®é™…é¡¹ç›®ä¸­æ¸¸åˆƒæœ‰ä½™ï¼
