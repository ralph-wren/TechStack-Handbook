# Python 知识文档

## 目录
- [Python 知识文档](#python-知识文档)
  - [目录](#目录)
  - [Python 基础](#python-基础)
    - [数据类型](#数据类型)
    - [控制流](#控制流)
    - [函数](#函数)
    - [模块与包](#模块与包)
    - [异常处理](#异常处理)
  - [Python 高级特性](#python-高级特性)
    - [装饰器](#装饰器)
    - [生成器与迭代器](#生成器与迭代器)
    - [上下文管理器](#上下文管理器)
    - [元类](#元类)
    - [协程与异步编程](#协程与异步编程)
  - [数据处理与分析](#数据处理与分析)
    - [NumPy 基础](#numpy-基础)
    - [Pandas 基础](#pandas-基础)
    - [数据可视化](#数据可视化)
    - [数据处理实战](#数据处理实战)
  - [Web开发](#web开发)
    - [Flask 框架](#flask-框架)
    - [Django 框架](#django-框架)
    - [FastAPI 框架](#fastapi-框架)
    - [RESTful API设计](#restful-api设计)
  - [测试与调试](#测试与调试)
    - [单元测试](#单元测试)
    - [调试技巧](#调试技巧)
    - [性能优化](#性能优化)
  - [环境与工具](#环境与工具)
    - [搭建环境](#搭建环境)
    - [包管理工具](#包管理工具)
    - [虚拟环境](#虚拟环境)
    - [常用开发工具](#常用开发工具)
  - [设计模式](#设计模式)
    - [创建型模式](#创建型模式)
    - [结构型模式](#结构型模式)
    - [行为型模式](#行为型模式)
  - [面试题精选](#面试题精选)
    - [Python基础面试题](#python基础面试题)
    - [高级特性面试题](#高级特性面试题)
    - [算法与数据结构面试题](#算法与数据结构面试题)
    - [Web开发面试题](#web开发面试题)

## Python 基础

### 数据类型

**基本数据类型**
- 数值类型：int, float, complex
- 字符串：str
- 布尔值：bool
- 空值：None

**容器类型**
- 列表(list)：有序可变序列
- 元组(tuple)：有序不可变序列
- 字典(dict)：键值对映射
- 集合(set)：无序不重复元素集合
- frozenset：不可变集合

**示例**
```python
# 数值类型
a = 10       # int
b = 3.14     # float
c = 1 + 2j   # complex

# 字符串
s1 = 'Hello'
s2 = "World"
s3 = '''多行
字符串'''

# 列表
my_list = [1, 2, 3, 'a', 'b']
my_list.append(4)  # 添加元素

# 元组
my_tuple = (1, 2, 3, 'a', 'b')

# 字典
my_dict = {'name': 'Python', 'version': 3.9}
print(my_dict['name'])  # 访问元素

# 集合
my_set = {1, 2, 3, 3}  # 自动去重
print(my_set)  # {1, 2, 3}
```

### 控制流

**条件语句**
```python
x = 10
if x > 0:
    print("正数")
elif x < 0:
    print("负数")
else:
    print("零")
```

**循环语句**
```python
# for循环
for i in range(5):
    print(i)

# while循环
count = 0
while count < 5:
    print(count)
    count += 1

# 循环控制
for i in range(10):
    if i == 3:
        continue  # 跳过当前迭代
    if i == 8:
        break     # 退出循环
    print(i)
```

### 函数

**函数定义与调用**
```python
def greet(name, greeting="Hello"):
    """函数文档字符串：返回问候语"""
    return f"{greeting}, {name}!"

# 调用函数
message = greet("Python")
print(message)  # Hello, Python!

# 关键字参数
message = greet(greeting="Hi", name="Python")
print(message)  # Hi, Python!
```

**参数类型**
- 位置参数
- 默认参数
- 可变参数
- 关键字参数

```python
def func(pos, default="默认值", *args, **kwargs):
    print(f"位置参数: {pos}")
    print(f"默认参数: {default}")
    print(f"可变参数: {args}")
    print(f"关键字参数: {kwargs}")

func(1, 2, 3, 4, key1="value1", key2="value2")
```

**匿名函数(lambda)**
```python
square = lambda x: x ** 2
print(square(5))  # 25
```

### 模块与包

**导入模块**
```python
# 导入整个模块
import math
print(math.pi)

# 导入特定函数
from math import sqrt
print(sqrt(16))

# 导入并重命名
import numpy as np
```

**创建模块**
```python
# mymodule.py
def say_hello(name):
    return f"Hello, {name}!"

# 使用模块
import mymodule
print(mymodule.say_hello("World"))
```

**包结构**
```
mypackage/
    __init__.py
    module1.py
    module2.py
    subpackage/
        __init__.py
        module3.py
```

### 异常处理

**基本异常处理**
```python
try:
    x = 1 / 0
except ZeroDivisionError:
    print("除以零错误")
except Exception as e:
    print(f"其他错误: {e}")
else:
    print("没有异常发生")
finally:
    print("无论是否有异常都执行")
```

**自定义异常**
```python
class MyError(Exception):
    def __init__(self, message):
        self.message = message
        super().__init__(self.message)

try:
    raise MyError("自定义错误")
except MyError as e:
    print(e)
```

## Python 高级特性

### 装饰器

**基本装饰器**
```python
def timer(func):
    import time
    def wrapper(*args, **kwargs):
        start = time.time()
        result = func(*args, **kwargs)
        end = time.time()
        print(f"{func.__name__} 运行时间: {end - start}秒")
        return result
    return wrapper

@timer
def slow_function():
    import time
    time.sleep(1)
    return "完成"

print(slow_function())
```

**带参数的装饰器**
```python
def repeat(n):
    def decorator(func):
        def wrapper(*args, **kwargs):
            for _ in range(n):
                result = func(*args, **kwargs)
            return result
        return wrapper
    return decorator

@repeat(3)
def say_hello():
    print("Hello!")

say_hello()  # 打印3次 "Hello!"
```

### 生成器与迭代器

**生成器**
```python
def count_up_to(n):
    i = 0
    while i < n:
        yield i
        i += 1

# 使用生成器
for i in count_up_to(5):
    print(i)

# 生成器表达式
squares = (x**2 for x in range(10))
```

**迭代器**
```python
class MyRange:
    def __init__(self, n):
        self.n = n
        self.i = 0
    
    def __iter__(self):
        return self
    
    def __next__(self):
        if self.i < self.n:
            result = self.i
            self.i += 1
            return result
        else:
            raise StopIteration

# 使用迭代器
for i in MyRange(5):
    print(i)
```

### 上下文管理器

**with语句**
```python
# 文件操作
with open('file.txt', 'w') as f:
    f.write('Hello, World!')

# 自定义上下文管理器
class MyContext:
    def __enter__(self):
        print("进入上下文")
        return self
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        print("退出上下文")
        return False  # 不抑制异常

with MyContext() as ctx:
    print("在上下文中")
```

**contextlib模块**
```python
from contextlib import contextmanager

@contextmanager
def my_context():
    print("进入上下文")
    try:
        yield "上下文值"
    finally:
        print("退出上下文")

with my_context() as value:
    print(f"在上下文中: {value}")
```

## 环境与工具

### 搭建环境

**创建venv虚拟环境**
```bash
python3 -m venv venv && source venv/bin/activate && pip install -r requirements.txt
```

**查看pip位置**
```bash
conda run which pip   
```

**终端配置代理**
```bash
# 设置代理
export http_proxy=http://127.0.0.1:10809  
export https_proxy=http://127.0.0.1:10809 
export ALL_PROXY=socks5://127.0.0.1:10808

# 或者
export http_proxy="http://127.0.0.1:7890"
export https_proxy="http://127.0.0.1:7890"

# 取消代理
unset http_proxy
unset https_proxy
unset all_proxy
```

### 包管理工具

**pip 使用**
```bash
# 安装包
pip install package_name

# 指定镜像源安装
pip install flask -i https://pypi.tuna.tsinghua.edu.cn/simple

# 安装特定版本
pip install package_name==1.0.0

# 从requirements.txt安装
pip install -r requirements.txt

# 升级包
pip install --upgrade package_name

# 卸载包
pip uninstall package_name
```

**conda 使用**
```bash
# 添加频道
conda config --add channels conda-forge
conda config --set channel_priority strict

# 安装包
conda install osmium

# 创建环境
conda create -n osm-env python=3.10

# 激活环境
conda activate osm-env

# 安装多个包
conda install -c conda-forge pyosmium pandas
```

### 虚拟环境

**venv**
```bash
# 创建虚拟环境
python -m venv myenv

# 激活虚拟环境(Windows)
myenv\Scripts\activate

# 激活虚拟环境(Linux/Mac)
source myenv/bin/activate

# 退出虚拟环境
deactivate
```

**conda环境**
```bash
# 创建环境
conda create -n myenv python=3.9

# 激活环境
conda activate myenv

# 退出环境
conda deactivate

# 列出所有环境
conda env list
```

### 常用开发工具

**检测当前可用字体**
```python
import matplotlib.font_manager as fm
for font in fm.findSystemFonts(fontpaths=None, fontext='ttf'):
    print(fm.FontProperties(fname=font).get_name())
```

**IDE与编辑器**
- PyCharm: 功能全面的Python IDE
- VS Code: 轻量级编辑器，配合Python扩展使用
- Jupyter Notebook: 交互式开发环境，适合数据分析
- Spyder: 科学计算导向的IDE

## 数据处理与分析

### NumPy 基础

**创建数组**
```python
import numpy as np

# 从列表创建
arr1 = np.array([1, 2, 3, 4, 5])

# 创建特殊数组
zeros = np.zeros((3, 3))  # 全0数组
ones = np.ones((2, 4))    # 全1数组
rand = np.random.random((2, 2))  # 随机数组
arange = np.arange(10)    # 0到9的数组
linspace = np.linspace(0, 1, 5)  # 均匀分布的5个点
```

**数组操作**
```python
# 重塑数组
arr = np.arange(12)
arr_reshaped = arr.reshape(3, 4)

# 数组切片
slice1 = arr_reshaped[0:2, 1:3]

# 数组运算
arr1 = np.array([1, 2, 3])
arr2 = np.array([4, 5, 6])
sum_arr = arr1 + arr2
product = arr1 * arr2
dot_product = np.dot(arr1, arr2)
```

### Pandas 基础

**创建数据结构**
```python
import pandas as pd

# 创建Series
s = pd.Series([1, 3, 5, np.nan, 6, 8])

# 创建DataFrame
df = pd.DataFrame({
    'A': [1, 2, 3, 4],
    'B': pd.date_range('20230101', periods=4),
    'C': pd.Series(1, index=list(range(4))),
    'D': np.random.randn(4)
})
```

**数据操作**
```python
# 查看数据
print(df.head())
print(df.describe())

# 选择数据
print(df['A'])  # 选择列
print(df.loc[0])  # 通过标签选择行
print(df.iloc[1:3, 0:2])  # 通过位置选择

# 过滤数据
filtered = df[df.A > 2]

# 分组操作
grouped = df.groupby('A').sum()
```

## 面试题精选

### Python基础面试题

1. **Python中的可变对象和不可变对象有哪些？**
   - 可变对象：列表(list)、字典(dict)、集合(set)
   - 不可变对象：整数(int)、浮点数(float)、字符串(str)、元组(tuple)、frozenset

2. **Python中的深拷贝和浅拷贝的区别？**
   ```python
   import copy
   
   # 浅拷贝
   list1 = [1, [2, 3]]
   list2 = copy.copy(list1)
   
   # 深拷贝
   list3 = copy.deepcopy(list1)
   
   # 修改嵌套列表
   list1[1][0] = 'X'
   print(list2)  # [1, ['X', 3]] - 浅拷贝受影响
   print(list3)  # [1, [2, 3]] - 深拷贝不受影响
   ```

3. **GIL是什么？它对Python多线程有什么影响？**
   
   GIL(Global Interpreter Lock)是Python解释器中的全局解释器锁。它确保同一时刻只有一个线程在执行Python字节码，这意味着Python多线程在CPU密集型任务上并不能真正实现并行执行，只有在I/O密集型任务上才能获得性能提升。

4. **Python中的装饰器是什么？如何创建一个装饰器？**
   
   装饰器是一个函数，它接受另一个函数作为参数，并返回一个新的函数，通常用于在不修改原函数代码的情况下增加额外功能。
   
   ```python
   def my_decorator(func):
       def wrapper(*args, **kwargs):
           print("函数执行前")
           result = func(*args, **kwargs)
           print("函数执行后")
           return result
       return wrapper
   
   @my_decorator
   def say_hello():
       print("Hello!")
   
   say_hello()
   ```